/**!
 * Sortable 1.15.0
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function bk(g,p){var b=Object.keys(g);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(g);p&&(y=y.filter(function(k){return Object.getOwnPropertyDescriptor(g,k).enumerable})),b.push.apply(b,y)}return b}function Us(g){for(var p=1;p<arguments.length;p++){var b=arguments[p]!=null?arguments[p]:{};p%2?bk(Object(b),!0).forEach(function(y){G4(g,y,b[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(g,Object.getOwnPropertyDescriptors(b)):bk(Object(b)).forEach(function(y){Object.defineProperty(g,y,Object.getOwnPropertyDescriptor(b,y))})}return g}function wu(g){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wu=function(p){return typeof p}:wu=function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},wu(g)}function G4(g,p,b){return p in g?Object.defineProperty(g,p,{value:b,enumerable:!0,configurable:!0,writable:!0}):g[p]=b,g}function no(){return no=Object.assign||function(g){for(var p=1;p<arguments.length;p++){var b=arguments[p];for(var y in b)Object.prototype.hasOwnProperty.call(b,y)&&(g[y]=b[y])}return g},no.apply(this,arguments)}function Y4(g,p){if(g==null)return{};var b={},y=Object.keys(g),k,B;for(B=0;B<y.length;B++)k=y[B],!(p.indexOf(k)>=0)&&(b[k]=g[k]);return b}function X4(g,p){if(g==null)return{};var b=Y4(g,p),y,k;if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(g);for(k=0;k<B.length;k++)y=B[k],!(p.indexOf(y)>=0)&&Object.prototype.propertyIsEnumerable.call(g,y)&&(b[y]=g[y])}return b}var Z4="1.15.0";function to(g){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(g)}var so=to(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),el=to(/Edge/i),vk=to(/firefox/i),Yi=to(/safari/i)&&!to(/chrome/i)&&!to(/android/i),Nk=to(/iP(ad|od|hone)/i),Ak=to(/chrome/i)&&to(/android/i),Tk={capture:!1,passive:!1};function nt(g,p,b){g.addEventListener(p,b,!so&&Tk)}function Ze(g,p,b){g.removeEventListener(p,b,!so&&Tk)}function Au(g,p){if(p){if(p[0]===">"&&(p=p.substring(1)),g)try{if(g.matches)return g.matches(p);if(g.msMatchesSelector)return g.msMatchesSelector(p);if(g.webkitMatchesSelector)return g.webkitMatchesSelector(p)}catch{return!1}return!1}}function Q4(g){return g.host&&g!==document&&g.host.nodeType?g.host:g.parentNode}function $s(g,p,b,y){if(g){b=b||document;do{if(p!=null&&(p[0]===">"?g.parentNode===b&&Au(g,p):Au(g,p))||y&&g===b)return g;if(g===b)break}while(g=Q4(g))}return null}var yk=/\s+/g;function jn(g,p,b){if(g&&p)if(g.classList)g.classList[b?"add":"remove"](p);else{var y=(" "+g.className+" ").replace(yk," ").replace(" "+p+" "," ");g.className=(y+(b?" "+p:"")).replace(yk," ")}}function Te(g,p,b){var y=g&&g.style;if(y){if(b===void 0)return document.defaultView&&document.defaultView.getComputedStyle?b=document.defaultView.getComputedStyle(g,""):g.currentStyle&&(b=g.currentStyle),p===void 0?b:b[p];!(p in y)&&p.indexOf("webkit")===-1&&(p="-webkit-"+p),y[p]=b+(typeof b=="string"?"":"px")}}function Ca(g,p){var b="";if(typeof g=="string")b=g;else do{var y=Te(g,"transform");y&&y!=="none"&&(b=y+" "+b)}while(!p&&(g=g.parentNode));var k=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return k&&new k(b)}function Dk(g,p,b){if(g){var y=g.getElementsByTagName(p),k=0,B=y.length;if(b)for(;k<B;k++)b(y[k],k);return y}return[]}function Ms(){var g=document.scrollingElement;return g||document.documentElement}function jt(g,p,b,y,k){if(!(!g.getBoundingClientRect&&g!==window)){var B,L,j,X,Z,ue,ie;if(g!==window&&g.parentNode&&g!==Ms()?(B=g.getBoundingClientRect(),L=B.top,j=B.left,X=B.bottom,Z=B.right,ue=B.height,ie=B.width):(L=0,j=0,X=window.innerHeight,Z=window.innerWidth,ue=window.innerHeight,ie=window.innerWidth),(p||b)&&g!==window&&(k=k||g.parentNode,!so))do if(k&&k.getBoundingClientRect&&(Te(k,"transform")!=="none"||b&&Te(k,"position")!=="static")){var Ce=k.getBoundingClientRect();L-=Ce.top+parseInt(Te(k,"border-top-width")),j-=Ce.left+parseInt(Te(k,"border-left-width")),X=L+B.height,Z=j+B.width;break}while(k=k.parentNode);if(y&&g!==window){var Oe=Ca(k||g),Pe=Oe&&Oe.a,$e=Oe&&Oe.d;Oe&&(L/=$e,j/=Pe,ie/=Pe,ue/=$e,X=L+ue,Z=j+ie)}return{top:L,left:j,bottom:X,right:Z,width:ie,height:ue}}}function Ck(g,p,b){for(var y=Ro(g,!0),k=jt(g)[p];y;){var B=jt(y)[b],L=void 0;if(b==="top"||b==="left"?L=k>=B:L=k<=B,!L)return y;if(y===Ms())break;y=Ro(y,!1)}return!1}function Ea(g,p,b,y){for(var k=0,B=0,L=g.children;B<L.length;){if(L[B].style.display!=="none"&&L[B]!==De.ghost&&(y||L[B]!==De.dragged)&&$s(L[B],b.draggable,g,!1)){if(k===p)return L[B];k++}B++}return null}function bg(g,p){for(var b=g.lastElementChild;b&&(b===De.ghost||Te(b,"display")==="none"||p&&!Au(b,p));)b=b.previousElementSibling;return b||null}function ns(g,p){var b=0;if(!g||!g.parentNode)return-1;for(;g=g.previousElementSibling;)g.nodeName.toUpperCase()!=="TEMPLATE"&&g!==De.clone&&(!p||Au(g,p))&&b++;return b}function Ek(g){var p=0,b=0,y=Ms();if(g)do{var k=Ca(g),B=k.a,L=k.d;p+=g.scrollLeft*B,b+=g.scrollTop*L}while(g!==y&&(g=g.parentNode));return[p,b]}function J4(g,p){for(var b in g)if(g.hasOwnProperty(b)){for(var y in p)if(p.hasOwnProperty(y)&&p[y]===g[b][y])return Number(b)}return-1}function Ro(g,p){if(!g||!g.getBoundingClientRect)return Ms();var b=g,y=!1;do if(b.clientWidth<b.scrollWidth||b.clientHeight<b.scrollHeight){var k=Te(b);if(b.clientWidth<b.scrollWidth&&(k.overflowX=="auto"||k.overflowX=="scroll")||b.clientHeight<b.scrollHeight&&(k.overflowY=="auto"||k.overflowY=="scroll")){if(!b.getBoundingClientRect||b===document.body)return Ms();if(y||p)return b;y=!0}}while(b=b.parentNode);return Ms()}function e7(g,p){if(g&&p)for(var b in p)p.hasOwnProperty(b)&&(g[b]=p[b]);return g}function sg(g,p){return Math.round(g.top)===Math.round(p.top)&&Math.round(g.left)===Math.round(p.left)&&Math.round(g.height)===Math.round(p.height)&&Math.round(g.width)===Math.round(p.width)}var Xi;function Rk(g,p){return function(){if(!Xi){var b=arguments,y=this;b.length===1?g.call(y,b[0]):g.apply(y,b),Xi=setTimeout(function(){Xi=void 0},p)}}}function t7(){clearTimeout(Xi),Xi=void 0}function Pk(g,p,b){g.scrollLeft+=p,g.scrollTop+=b}function Ok(g){var p=window.Polymer,b=window.jQuery||window.Zepto;return p&&p.dom?p.dom(g).cloneNode(!0):b?b(g).clone(!0)[0]:g.cloneNode(!0)}var Gn="Sortable"+new Date().getTime();function n7(){var g=[],p;return{captureAnimationState:function(){if(g=[],!!this.options.animation){var y=[].slice.call(this.el.children);y.forEach(function(k){if(!(Te(k,"display")==="none"||k===De.ghost)){g.push({target:k,rect:jt(k)});var B=Us({},g[g.length-1].rect);if(k.thisAnimationDuration){var L=Ca(k,!0);L&&(B.top-=L.f,B.left-=L.e)}k.fromRect=B}})}},addAnimationState:function(y){g.push(y)},removeAnimationState:function(y){g.splice(J4(g,{target:y}),1)},animateAll:function(y){var k=this;if(!this.options.animation){clearTimeout(p),typeof y=="function"&&y();return}var B=!1,L=0;g.forEach(function(j){var X=0,Z=j.target,ue=Z.fromRect,ie=jt(Z),Ce=Z.prevFromRect,Oe=Z.prevToRect,Pe=j.rect,$e=Ca(Z,!0);$e&&(ie.top-=$e.f,ie.left-=$e.e),Z.toRect=ie,Z.thisAnimationDuration&&sg(Ce,ie)&&!sg(ue,ie)&&(Pe.top-ie.top)/(Pe.left-ie.left)===(ue.top-ie.top)/(ue.left-ie.left)&&(X=o7(Pe,Ce,Oe,k.options)),sg(ie,ue)||(Z.prevFromRect=ue,Z.prevToRect=ie,X||(X=k.options.animation),k.animate(Z,Pe,ie,X)),X&&(B=!0,L=Math.max(L,X),clearTimeout(Z.animationResetTimer),Z.animationResetTimer=setTimeout(function(){Z.animationTime=0,Z.prevFromRect=null,Z.fromRect=null,Z.prevToRect=null,Z.thisAnimationDuration=null},X),Z.thisAnimationDuration=X)}),clearTimeout(p),B?p=setTimeout(function(){typeof y=="function"&&y()},L):typeof y=="function"&&y(),g=[]},animate:function(y,k,B,L){if(L){Te(y,"transition",""),Te(y,"transform","");var j=Ca(this.el),X=j&&j.a,Z=j&&j.d,ue=(k.left-B.left)/(X||1),ie=(k.top-B.top)/(Z||1);y.animatingX=!!ue,y.animatingY=!!ie,Te(y,"transform","translate3d("+ue+"px,"+ie+"px,0)"),this.forRepaintDummy=s7(y),Te(y,"transition","transform "+L+"ms"+(this.options.easing?" "+this.options.easing:"")),Te(y,"transform","translate3d(0,0,0)"),typeof y.animated=="number"&&clearTimeout(y.animated),y.animated=setTimeout(function(){Te(y,"transition",""),Te(y,"transform",""),y.animated=!1,y.animatingX=!1,y.animatingY=!1},L)}}}}function s7(g){return g.offsetWidth}function o7(g,p,b,y){return Math.sqrt(Math.pow(p.top-g.top,2)+Math.pow(p.left-g.left,2))/Math.sqrt(Math.pow(p.top-b.top,2)+Math.pow(p.left-b.left,2))*y.animation}var ha=[],og={initializeByDefault:!0},tl={mount:function(p){for(var b in og)og.hasOwnProperty(b)&&!(b in p)&&(p[b]=og[b]);ha.forEach(function(y){if(y.pluginName===p.pluginName)throw"Sortable: Cannot mount plugin ".concat(p.pluginName," more than once")}),ha.push(p)},pluginEvent:function(p,b,y){var k=this;this.eventCanceled=!1,y.cancel=function(){k.eventCanceled=!0};var B=p+"Global";ha.forEach(function(L){b[L.pluginName]&&(b[L.pluginName][B]&&b[L.pluginName][B](Us({sortable:b},y)),b.options[L.pluginName]&&b[L.pluginName][p]&&b[L.pluginName][p](Us({sortable:b},y)))})},initializePlugins:function(p,b,y,k){ha.forEach(function(j){var X=j.pluginName;if(!(!p.options[X]&&!j.initializeByDefault)){var Z=new j(p,b,p.options);Z.sortable=p,Z.options=p.options,p[X]=Z,no(y,Z.defaults)}});for(var B in p.options)if(p.options.hasOwnProperty(B)){var L=this.modifyOption(p,B,p.options[B]);typeof L<"u"&&(p.options[B]=L)}},getEventProperties:function(p,b){var y={};return ha.forEach(function(k){typeof k.eventProperties=="function"&&no(y,k.eventProperties.call(b[k.pluginName],p))}),y},modifyOption:function(p,b,y){var k;return ha.forEach(function(B){p[B.pluginName]&&B.optionListeners&&typeof B.optionListeners[b]=="function"&&(k=B.optionListeners[b].call(p[B.pluginName],y))}),k}};function r7(g){var p=g.sortable,b=g.rootEl,y=g.name,k=g.targetEl,B=g.cloneEl,L=g.toEl,j=g.fromEl,X=g.oldIndex,Z=g.newIndex,ue=g.oldDraggableIndex,ie=g.newDraggableIndex,Ce=g.originalEvent,Oe=g.putSortable,Pe=g.extraEventProperties;if(p=p||b&&b[Gn],!!p){var $e,gn=p.options,Yn="on"+y.charAt(0).toUpperCase()+y.substr(1);window.CustomEvent&&!so&&!el?$e=new CustomEvent(y,{bubbles:!0,cancelable:!0}):($e=document.createEvent("Event"),$e.initEvent(y,!0,!0)),$e.to=L||b,$e.from=j||b,$e.item=k||b,$e.clone=B,$e.oldIndex=X,$e.newIndex=Z,$e.oldDraggableIndex=ue,$e.newDraggableIndex=ie,$e.originalEvent=Ce,$e.pullMode=Oe?Oe.lastPutMode:void 0;var Bt=Us(Us({},Pe),tl.getEventProperties(y,p));for(var ce in Bt)$e[ce]=Bt[ce];b&&b.dispatchEvent($e),gn[Yn]&&gn[Yn].call(p,$e)}}var a7=["evt"],Tn=function(p,b){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},k=y.evt,B=X4(y,a7);tl.pluginEvent.bind(De)(p,b,Us({dragEl:fe,parentEl:At,ghostEl:Le,rootEl:Ct,nextEl:_r,lastDownEl:_u,cloneEl:wt,cloneHidden:Do,dragStarted:ji,putSortable:sn,activeSortable:De.active,originalEvent:k,oldIndex:ya,oldDraggableIndex:Zi,newIndex:Kn,newDraggableIndex:To,hideGhostForTarget:Lk,unhideGhostForTarget:$k,cloneNowHidden:function(){Do=!0},cloneNowShown:function(){Do=!1},dispatchSortableEvent:function(j){Cn({sortable:b,name:j,originalEvent:k})}},B))};function Cn(g){r7(Us({putSortable:sn,cloneEl:wt,targetEl:fe,rootEl:Ct,oldIndex:ya,oldDraggableIndex:Zi,newIndex:Kn,newDraggableIndex:To},g))}var fe,At,Le,Ct,_r,_u,wt,Do,ya,Kn,Zi,To,yu,sn,va=!1,Tu=!1,Du=[],Sr,bs,rg,ag,Sk,wk,ji,ba,Qi,Ji=!1,Cu=!1,xu,pn,ig=[],mg=!1,Ru=[],Ou=typeof document<"u",Eu=Nk,_k=el||so?"cssFloat":"float",i7=Ou&&!Ak&&!Nk&&"draggable"in document.createElement("div"),Bk=function(){if(Ou){if(so)return!1;var g=document.createElement("x");return g.style.cssText="pointer-events:auto",g.style.pointerEvents==="auto"}}(),Ik=function(p,b){var y=Te(p),k=parseInt(y.width)-parseInt(y.paddingLeft)-parseInt(y.paddingRight)-parseInt(y.borderLeftWidth)-parseInt(y.borderRightWidth),B=Ea(p,0,b),L=Ea(p,1,b),j=B&&Te(B),X=L&&Te(L),Z=j&&parseInt(j.marginLeft)+parseInt(j.marginRight)+jt(B).width,ue=X&&parseInt(X.marginLeft)+parseInt(X.marginRight)+jt(L).width;if(y.display==="flex")return y.flexDirection==="column"||y.flexDirection==="column-reverse"?"vertical":"horizontal";if(y.display==="grid")return y.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(B&&j.float&&j.float!=="none"){var ie=j.float==="left"?"left":"right";return L&&(X.clear==="both"||X.clear===ie)?"vertical":"horizontal"}return B&&(j.display==="block"||j.display==="flex"||j.display==="table"||j.display==="grid"||Z>=k&&y[_k]==="none"||L&&y[_k]==="none"&&Z+ue>k)?"vertical":"horizontal"},l7=function(p,b,y){var k=y?p.left:p.top,B=y?p.right:p.bottom,L=y?p.width:p.height,j=y?b.left:b.top,X=y?b.right:b.bottom,Z=y?b.width:b.height;return k===j||B===X||k+L/2===j+Z/2},c7=function(p,b){var y;return Du.some(function(k){var B=k[Gn].options.emptyInsertThreshold;if(!(!B||bg(k))){var L=jt(k),j=p>=L.left-B&&p<=L.right+B,X=b>=L.top-B&&b<=L.bottom+B;if(j&&X)return y=k}}),y},Fk=function(p){function b(B,L){return function(j,X,Z,ue){var ie=j.options.group.name&&X.options.group.name&&j.options.group.name===X.options.group.name;if(B==null&&(L||ie))return!0;if(B==null||B===!1)return!1;if(L&&B==="clone")return B;if(typeof B=="function")return b(B(j,X,Z,ue),L)(j,X,Z,ue);var Ce=(L?j:X).options.group.name;return B===!0||typeof B=="string"&&B===Ce||B.join&&B.indexOf(Ce)>-1}}var y={},k=p.group;(!k||wu(k)!="object")&&(k={name:k}),y.name=k.name,y.checkPull=b(k.pull,!0),y.checkPut=b(k.put),y.revertClone=k.revertClone,p.group=y},Lk=function(){!Bk&&Le&&Te(Le,"display","none")},$k=function(){!Bk&&Le&&Te(Le,"display","")};Ou&&!Ak&&document.addEventListener("click",function(g){if(Tu)return g.preventDefault(),g.stopPropagation&&g.stopPropagation(),g.stopImmediatePropagation&&g.stopImmediatePropagation(),Tu=!1,!1},!0);var wr=function(p){if(fe){p=p.touches?p.touches[0]:p;var b=c7(p.clientX,p.clientY);if(b){var y={};for(var k in p)p.hasOwnProperty(k)&&(y[k]=p[k]);y.target=y.rootEl=b,y.preventDefault=void 0,y.stopPropagation=void 0,b[Gn]._onDragOver(y)}}},u7=function(p){fe&&fe.parentNode[Gn]._isOutsideThisEl(p.target)};function De(g,p){if(!(g&&g.nodeType&&g.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(g));this.el=g,this.options=p=no({},p),g[Gn]=this;var b={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(g.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ik(g,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(L,j){L.setData("Text",j.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:De.supportPointer!==!1&&"PointerEvent"in window&&!Yi,emptyInsertThreshold:5};tl.initializePlugins(this,g,b);for(var y in b)!(y in p)&&(p[y]=b[y]);Fk(p);for(var k in this)k.charAt(0)==="_"&&typeof this[k]=="function"&&(this[k]=this[k].bind(this));this.nativeDraggable=p.forceFallback?!1:i7,this.nativeDraggable&&(this.options.touchStartThreshold=1),p.supportPointer?nt(g,"pointerdown",this._onTapStart):(nt(g,"mousedown",this._onTapStart),nt(g,"touchstart",this._onTapStart)),this.nativeDraggable&&(nt(g,"dragover",this),nt(g,"dragenter",this)),Du.push(this.el),p.store&&p.store.get&&this.sort(p.store.get(this)||[]),no(this,n7())}De.prototype={constructor:De,_isOutsideThisEl:function(p){!this.el.contains(p)&&p!==this.el&&(ba=null)},_getDirection:function(p,b){return typeof this.options.direction=="function"?this.options.direction.call(this,p,b,fe):this.options.direction},_onTapStart:function(p){if(p.cancelable){var b=this,y=this.el,k=this.options,B=k.preventOnFilter,L=p.type,j=p.touches&&p.touches[0]||p.pointerType&&p.pointerType==="touch"&&p,X=(j||p).target,Z=p.target.shadowRoot&&(p.path&&p.path[0]||p.composedPath&&p.composedPath()[0])||X,ue=k.filter;if(v7(y),!fe&&!(/mousedown|pointerdown/.test(L)&&p.button!==0||k.disabled)&&!Z.isContentEditable&&!(!this.nativeDraggable&&Yi&&X&&X.tagName.toUpperCase()==="SELECT")&&(X=$s(X,k.draggable,y,!1),!(X&&X.animated)&&_u!==X)){if(ya=ns(X),Zi=ns(X,k.draggable),typeof ue=="function"){if(ue.call(this,p,X,this)){Cn({sortable:b,rootEl:Z,name:"filter",targetEl:X,toEl:y,fromEl:y}),Tn("filter",b,{evt:p}),B&&p.cancelable&&p.preventDefault();return}}else if(ue&&(ue=ue.split(",").some(function(ie){if(ie=$s(Z,ie.trim(),y,!1),ie)return Cn({sortable:b,rootEl:ie,name:"filter",targetEl:X,fromEl:y,toEl:y}),Tn("filter",b,{evt:p}),!0}),ue)){B&&p.cancelable&&p.preventDefault();return}k.handle&&!$s(Z,k.handle,y,!1)||this._prepareDragStart(p,j,X)}}},_prepareDragStart:function(p,b,y){var k=this,B=k.el,L=k.options,j=B.ownerDocument,X;if(y&&!fe&&y.parentNode===B){var Z=jt(y);if(Ct=B,fe=y,At=fe.parentNode,_r=fe.nextSibling,_u=y,yu=L.group,De.dragged=fe,Sr={target:fe,clientX:(b||p).clientX,clientY:(b||p).clientY},Sk=Sr.clientX-Z.left,wk=Sr.clientY-Z.top,this._lastX=(b||p).clientX,this._lastY=(b||p).clientY,fe.style["will-change"]="all",X=function(){if(Tn("delayEnded",k,{evt:p}),De.eventCanceled){k._onDrop();return}k._disableDelayedDragEvents(),!vk&&k.nativeDraggable&&(fe.draggable=!0),k._triggerDragStart(p,b),Cn({sortable:k,name:"choose",originalEvent:p}),jn(fe,L.chosenClass,!0)},L.ignore.split(",").forEach(function(ue){Dk(fe,ue.trim(),lg)}),nt(j,"dragover",wr),nt(j,"mousemove",wr),nt(j,"touchmove",wr),nt(j,"mouseup",k._onDrop),nt(j,"touchend",k._onDrop),nt(j,"touchcancel",k._onDrop),vk&&this.nativeDraggable&&(this.options.touchStartThreshold=4,fe.draggable=!0),Tn("delayStart",this,{evt:p}),L.delay&&(!L.delayOnTouchOnly||b)&&(!this.nativeDraggable||!(el||so))){if(De.eventCanceled){this._onDrop();return}nt(j,"mouseup",k._disableDelayedDrag),nt(j,"touchend",k._disableDelayedDrag),nt(j,"touchcancel",k._disableDelayedDrag),nt(j,"mousemove",k._delayedDragTouchMoveHandler),nt(j,"touchmove",k._delayedDragTouchMoveHandler),L.supportPointer&&nt(j,"pointermove",k._delayedDragTouchMoveHandler),k._dragStartTimer=setTimeout(X,L.delay)}else X()}},_delayedDragTouchMoveHandler:function(p){var b=p.touches?p.touches[0]:p;Math.max(Math.abs(b.clientX-this._lastX),Math.abs(b.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){fe&&lg(fe),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var p=this.el.ownerDocument;Ze(p,"mouseup",this._disableDelayedDrag),Ze(p,"touchend",this._disableDelayedDrag),Ze(p,"touchcancel",this._disableDelayedDrag),Ze(p,"mousemove",this._delayedDragTouchMoveHandler),Ze(p,"touchmove",this._delayedDragTouchMoveHandler),Ze(p,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(p,b){b=b||p.pointerType=="touch"&&p,!this.nativeDraggable||b?this.options.supportPointer?nt(document,"pointermove",this._onTouchMove):b?nt(document,"touchmove",this._onTouchMove):nt(document,"mousemove",this._onTouchMove):(nt(fe,"dragend",this),nt(Ct,"dragstart",this._onDragStart));try{document.selection?ku(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(p,b){if(va=!1,Ct&&fe){Tn("dragStarted",this,{evt:b}),this.nativeDraggable&&nt(document,"dragover",u7);var y=this.options;!p&&jn(fe,y.dragClass,!1),jn(fe,y.ghostClass,!0),De.active=this,p&&this._appendGhost(),Cn({sortable:this,name:"start",originalEvent:b})}else this._nulling()},_emulateDragOver:function(){if(bs){this._lastX=bs.clientX,this._lastY=bs.clientY,Lk();for(var p=document.elementFromPoint(bs.clientX,bs.clientY),b=p;p&&p.shadowRoot&&(p=p.shadowRoot.elementFromPoint(bs.clientX,bs.clientY),p!==b);)b=p;if(fe.parentNode[Gn]._isOutsideThisEl(p),b)do{if(b[Gn]){var y=void 0;if(y=b[Gn]._onDragOver({clientX:bs.clientX,clientY:bs.clientY,target:p,rootEl:b}),y&&!this.options.dragoverBubble)break}p=b}while(b=b.parentNode);$k()}},_onTouchMove:function(p){if(Sr){var b=this.options,y=b.fallbackTolerance,k=b.fallbackOffset,B=p.touches?p.touches[0]:p,L=Le&&Ca(Le,!0),j=Le&&L&&L.a,X=Le&&L&&L.d,Z=Eu&&pn&&Ek(pn),ue=(B.clientX-Sr.clientX+k.x)/(j||1)+(Z?Z[0]-ig[0]:0)/(j||1),ie=(B.clientY-Sr.clientY+k.y)/(X||1)+(Z?Z[1]-ig[1]:0)/(X||1);if(!De.active&&!va){if(y&&Math.max(Math.abs(B.clientX-this._lastX),Math.abs(B.clientY-this._lastY))<y)return;this._onDragStart(p,!0)}if(Le){L?(L.e+=ue-(rg||0),L.f+=ie-(ag||0)):L={a:1,b:0,c:0,d:1,e:ue,f:ie};var Ce="matrix(".concat(L.a,",").concat(L.b,",").concat(L.c,",").concat(L.d,",").concat(L.e,",").concat(L.f,")");Te(Le,"webkitTransform",Ce),Te(Le,"mozTransform",Ce),Te(Le,"msTransform",Ce),Te(Le,"transform",Ce),rg=ue,ag=ie,bs=B}p.cancelable&&p.preventDefault()}},_appendGhost:function(){if(!Le){var p=this.options.fallbackOnBody?document.body:Ct,b=jt(fe,!0,Eu,!0,p),y=this.options;if(Eu){for(pn=p;Te(pn,"position")==="static"&&Te(pn,"transform")==="none"&&pn!==document;)pn=pn.parentNode;pn!==document.body&&pn!==document.documentElement?(pn===document&&(pn=Ms()),b.top+=pn.scrollTop,b.left+=pn.scrollLeft):pn=Ms(),ig=Ek(pn)}Le=fe.cloneNode(!0),jn(Le,y.ghostClass,!1),jn(Le,y.fallbackClass,!0),jn(Le,y.dragClass,!0),Te(Le,"transition",""),Te(Le,"transform",""),Te(Le,"box-sizing","border-box"),Te(Le,"margin",0),Te(Le,"top",b.top),Te(Le,"left",b.left),Te(Le,"width",b.width),Te(Le,"height",b.height),Te(Le,"opacity","0.8"),Te(Le,"position",Eu?"absolute":"fixed"),Te(Le,"zIndex","100000"),Te(Le,"pointerEvents","none"),De.ghost=Le,p.appendChild(Le),Te(Le,"transform-origin",Sk/parseInt(Le.style.width)*100+"% "+wk/parseInt(Le.style.height)*100+"%")}},_onDragStart:function(p,b){var y=this,k=p.dataTransfer,B=y.options;if(Tn("dragStart",this,{evt:p}),De.eventCanceled){this._onDrop();return}Tn("setupClone",this),De.eventCanceled||(wt=Ok(fe),wt.removeAttribute("id"),wt.draggable=!1,wt.style["will-change"]="",this._hideClone(),jn(wt,this.options.chosenClass,!1),De.clone=wt),y.cloneId=ku(function(){Tn("clone",y),!De.eventCanceled&&(y.options.removeCloneOnHide||Ct.insertBefore(wt,fe),y._hideClone(),Cn({sortable:y,name:"clone"}))}),!b&&jn(fe,B.dragClass,!0),b?(Tu=!0,y._loopId=setInterval(y._emulateDragOver,50)):(Ze(document,"mouseup",y._onDrop),Ze(document,"touchend",y._onDrop),Ze(document,"touchcancel",y._onDrop),k&&(k.effectAllowed="move",B.setData&&B.setData.call(y,k,fe)),nt(document,"drop",y),Te(fe,"transform","translateZ(0)")),va=!0,y._dragStartId=ku(y._dragStarted.bind(y,b,p)),nt(document,"selectstart",y),ji=!0,Yi&&Te(document.body,"user-select","none")},_onDragOver:function(p){var b=this.el,y=p.target,k,B,L,j=this.options,X=j.group,Z=De.active,ue=yu===X,ie=j.sort,Ce=sn||Z,Oe,Pe=this,$e=!1;if(mg)return;function gn(Y,Kt){Tn(Y,Pe,Us({evt:p,isOwner:ue,axis:Oe?"vertical":"horizontal",revert:L,dragRect:k,targetRect:B,canSort:ie,fromSortable:Ce,target:y,completed:Bt,onMove:function(ne,xr){return Su(Ct,b,fe,k,ne,jt(ne),p,xr)},changed:ce},Kt))}function Yn(){gn("dragOverAnimationCapture"),Pe.captureAnimationState(),Pe!==Ce&&Ce.captureAnimationState()}function Bt(Y){return gn("dragOverCompleted",{insertion:Y}),Y&&(ue?Z._hideClone():Z._showClone(Pe),Pe!==Ce&&(jn(fe,sn?sn.options.ghostClass:Z.options.ghostClass,!1),jn(fe,j.ghostClass,!0)),sn!==Pe&&Pe!==De.active?sn=Pe:Pe===De.active&&sn&&(sn=null),Ce===Pe&&(Pe._ignoreWhileAnimating=y),Pe.animateAll(function(){gn("dragOverAnimationComplete"),Pe._ignoreWhileAnimating=null}),Pe!==Ce&&(Ce.animateAll(),Ce._ignoreWhileAnimating=null)),(y===fe&&!fe.animated||y===b&&!y.animated)&&(ba=null),!j.dragoverBubble&&!p.rootEl&&y!==document&&(fe.parentNode[Gn]._isOutsideThisEl(p.target),!Y&&wr(p)),!j.dragoverBubble&&p.stopPropagation&&p.stopPropagation(),$e=!0}function ce(){Kn=ns(fe),To=ns(fe,j.draggable),Cn({sortable:Pe,name:"change",toEl:b,newIndex:Kn,newDraggableIndex:To,originalEvent:p})}if(p.preventDefault!==void 0&&p.cancelable&&p.preventDefault(),y=$s(y,j.draggable,b,!0),gn("dragOver"),De.eventCanceled)return $e;if(fe.contains(p.target)||y.animated&&y.animatingX&&y.animatingY||Pe._ignoreWhileAnimating===y)return Bt(!1);if(Tu=!1,Z&&!j.disabled&&(ue?ie||(L=At!==Ct):sn===this||(this.lastPutMode=yu.checkPull(this,Z,fe,p))&&X.checkPut(this,Z,fe,p))){if(Oe=this._getDirection(p,y)==="vertical",k=jt(fe),gn("dragOverValid"),De.eventCanceled)return $e;if(L)return At=Ct,Yn(),this._hideClone(),gn("revert"),De.eventCanceled||(_r?Ct.insertBefore(fe,_r):Ct.appendChild(fe)),Bt(!0);var Qe=bg(b,j.draggable);if(!Qe||p7(p,Oe,this)&&!Qe.animated){if(Qe===fe)return Bt(!1);if(Qe&&b===p.target&&(y=Qe),y&&(B=jt(y)),Su(Ct,b,fe,k,y,B,p,!!y)!==!1)return Yn(),Qe&&Qe.nextSibling?b.insertBefore(fe,Qe.nextSibling):b.appendChild(fe),At=b,ce(),Bt(!0)}else if(Qe&&m7(p,Oe,this)){var vs=Ea(b,0,j,!0);if(vs===fe)return Bt(!1);if(y=vs,B=jt(y),Su(Ct,b,fe,k,y,B,p,!1)!==!1)return Yn(),b.insertBefore(fe,vs),At=b,ce(),Bt(!0)}else if(y.parentNode===b){B=jt(y);var Ge=0,Et,Dn=fe.parentNode!==b,Ye=!l7(fe.animated&&fe.toRect||k,y.animated&&y.toRect||B,Oe),rt=Oe?"top":"left",G=Ck(y,"top","top")||Ck(fe,"top","top"),Be=G?G.scrollTop:void 0;ba!==y&&(Et=B[rt],Ji=!1,Cu=!Ye&&j.invertSwap||Dn),Ge=g7(p,y,B,Oe,Ye?1:j.swapThreshold,j.invertedSwapThreshold==null?j.swapThreshold:j.invertedSwapThreshold,Cu,ba===y);var Tt;if(Ge!==0){var En=ns(fe);do En-=Ge,Tt=At.children[En];while(Tt&&(Te(Tt,"display")==="none"||Tt===Le))}if(Ge===0||Tt===y)return Bt(!1);ba=y,Qi=Ge;var Ee=y.nextElementSibling,on=!1;on=Ge===1;var Po=Su(Ct,b,fe,k,y,B,p,on);if(Po!==!1)return(Po===1||Po===-1)&&(on=Po===1),mg=!0,setTimeout(d7,30),Yn(),on&&!Ee?b.appendChild(fe):y.parentNode.insertBefore(fe,on?Ee:y),G&&Pk(G,0,Be-G.scrollTop),At=fe.parentNode,Et!==void 0&&!Cu&&(xu=Math.abs(Et-jt(y)[rt])),ce(),Bt(!0)}if(b.contains(fe))return Bt(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){Ze(document,"mousemove",this._onTouchMove),Ze(document,"touchmove",this._onTouchMove),Ze(document,"pointermove",this._onTouchMove),Ze(document,"dragover",wr),Ze(document,"mousemove",wr),Ze(document,"touchmove",wr)},_offUpEvents:function(){var p=this.el.ownerDocument;Ze(p,"mouseup",this._onDrop),Ze(p,"touchend",this._onDrop),Ze(p,"pointerup",this._onDrop),Ze(p,"touchcancel",this._onDrop),Ze(document,"selectstart",this)},_onDrop:function(p){var b=this.el,y=this.options;if(Kn=ns(fe),To=ns(fe,y.draggable),Tn("drop",this,{evt:p}),At=fe&&fe.parentNode,Kn=ns(fe),To=ns(fe,y.draggable),De.eventCanceled){this._nulling();return}va=!1,Cu=!1,Ji=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),pg(this.cloneId),pg(this._dragStartId),this.nativeDraggable&&(Ze(document,"drop",this),Ze(b,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Yi&&Te(document.body,"user-select",""),Te(fe,"transform",""),p&&(ji&&(p.cancelable&&p.preventDefault(),!y.dropBubble&&p.stopPropagation()),Le&&Le.parentNode&&Le.parentNode.removeChild(Le),(Ct===At||sn&&sn.lastPutMode!=="clone")&&wt&&wt.parentNode&&wt.parentNode.removeChild(wt),fe&&(this.nativeDraggable&&Ze(fe,"dragend",this),lg(fe),fe.style["will-change"]="",ji&&!va&&jn(fe,sn?sn.options.ghostClass:this.options.ghostClass,!1),jn(fe,this.options.chosenClass,!1),Cn({sortable:this,name:"unchoose",toEl:At,newIndex:null,newDraggableIndex:null,originalEvent:p}),Ct!==At?(Kn>=0&&(Cn({rootEl:At,name:"add",toEl:At,fromEl:Ct,originalEvent:p}),Cn({sortable:this,name:"remove",toEl:At,originalEvent:p}),Cn({rootEl:At,name:"sort",toEl:At,fromEl:Ct,originalEvent:p}),Cn({sortable:this,name:"sort",toEl:At,originalEvent:p})),sn&&sn.save()):Kn!==ya&&Kn>=0&&(Cn({sortable:this,name:"update",toEl:At,originalEvent:p}),Cn({sortable:this,name:"sort",toEl:At,originalEvent:p})),De.active&&((Kn==null||Kn===-1)&&(Kn=ya,To=Zi),Cn({sortable:this,name:"end",toEl:At,originalEvent:p}),this.save()))),this._nulling()},_nulling:function(){Tn("nulling",this),Ct=fe=At=Le=_r=wt=_u=Do=Sr=bs=ji=Kn=To=ya=Zi=ba=Qi=sn=yu=De.dragged=De.ghost=De.clone=De.active=null,Ru.forEach(function(p){p.checked=!0}),Ru.length=rg=ag=0},handleEvent:function(p){switch(p.type){case"drop":case"dragend":this._onDrop(p);break;case"dragenter":case"dragover":fe&&(this._onDragOver(p),f7(p));break;case"selectstart":p.preventDefault();break}},toArray:function(){for(var p=[],b,y=this.el.children,k=0,B=y.length,L=this.options;k<B;k++)b=y[k],$s(b,L.draggable,this.el,!1)&&p.push(b.getAttribute(L.dataIdAttr)||b7(b));return p},sort:function(p,b){var y={},k=this.el;this.toArray().forEach(function(B,L){var j=k.children[L];$s(j,this.options.draggable,k,!1)&&(y[B]=j)},this),b&&this.captureAnimationState(),p.forEach(function(B){y[B]&&(k.removeChild(y[B]),k.appendChild(y[B]))}),b&&this.animateAll()},save:function(){var p=this.options.store;p&&p.set&&p.set(this)},closest:function(p,b){return $s(p,b||this.options.draggable,this.el,!1)},option:function(p,b){var y=this.options;if(b===void 0)return y[p];var k=tl.modifyOption(this,p,b);typeof k<"u"?y[p]=k:y[p]=b,p==="group"&&Fk(y)},destroy:function(){Tn("destroy",this);var p=this.el;p[Gn]=null,Ze(p,"mousedown",this._onTapStart),Ze(p,"touchstart",this._onTapStart),Ze(p,"pointerdown",this._onTapStart),this.nativeDraggable&&(Ze(p,"dragover",this),Ze(p,"dragenter",this)),Array.prototype.forEach.call(p.querySelectorAll("[draggable]"),function(b){b.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),Du.splice(Du.indexOf(this.el),1),this.el=p=null},_hideClone:function(){if(!Do){if(Tn("hideClone",this),De.eventCanceled)return;Te(wt,"display","none"),this.options.removeCloneOnHide&&wt.parentNode&&wt.parentNode.removeChild(wt),Do=!0}},_showClone:function(p){if(p.lastPutMode!=="clone"){this._hideClone();return}if(Do){if(Tn("showClone",this),De.eventCanceled)return;fe.parentNode==Ct&&!this.options.group.revertClone?Ct.insertBefore(wt,fe):_r?Ct.insertBefore(wt,_r):Ct.appendChild(wt),this.options.group.revertClone&&this.animate(fe,wt),Te(wt,"display",""),Do=!1}}};function f7(g){g.dataTransfer&&(g.dataTransfer.dropEffect="move"),g.cancelable&&g.preventDefault()}function Su(g,p,b,y,k,B,L,j){var X,Z=g[Gn],ue=Z.options.onMove,ie;return window.CustomEvent&&!so&&!el?X=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(X=document.createEvent("Event"),X.initEvent("move",!0,!0)),X.to=p,X.from=g,X.dragged=b,X.draggedRect=y,X.related=k||p,X.relatedRect=B||jt(p),X.willInsertAfter=j,X.originalEvent=L,g.dispatchEvent(X),ue&&(ie=ue.call(Z,X,L)),ie}function lg(g){g.draggable=!1}function d7(){mg=!1}function m7(g,p,b){var y=jt(Ea(b.el,0,b.options,!0)),k=10;return p?g.clientX<y.left-k||g.clientY<y.top&&g.clientX<y.right:g.clientY<y.top-k||g.clientY<y.bottom&&g.clientX<y.left}function p7(g,p,b){var y=jt(bg(b.el,b.options.draggable)),k=10;return p?g.clientX>y.right+k||g.clientX<=y.right&&g.clientY>y.bottom&&g.clientX>=y.left:g.clientX>y.right&&g.clientY>y.top||g.clientX<=y.right&&g.clientY>y.bottom+k}function g7(g,p,b,y,k,B,L,j){var X=y?g.clientY:g.clientX,Z=y?b.height:b.width,ue=y?b.top:b.left,ie=y?b.bottom:b.right,Ce=!1;if(!L){if(j&&xu<Z*k){if(!Ji&&(Qi===1?X>ue+Z*B/2:X<ie-Z*B/2)&&(Ji=!0),Ji)Ce=!0;else if(Qi===1?X<ue+xu:X>ie-xu)return-Qi}else if(X>ue+Z*(1-k)/2&&X<ie-Z*(1-k)/2)return h7(p)}return Ce=Ce||L,Ce&&(X<ue+Z*B/2||X>ie-Z*B/2)?X>ue+Z/2?1:-1:0}function h7(g){return ns(fe)<ns(g)?1:-1}function b7(g){for(var p=g.tagName+g.className+g.src+g.href+g.textContent,b=p.length,y=0;b--;)y+=p.charCodeAt(b);return y.toString(36)}function v7(g){Ru.length=0;for(var p=g.getElementsByTagName("input"),b=p.length;b--;){var y=p[b];y.checked&&Ru.push(y)}}function ku(g){return setTimeout(g,0)}function pg(g){return clearTimeout(g)}Ou&&nt(document,"touchmove",function(g){(De.active||va)&&g.cancelable&&g.preventDefault()});De.utils={on:nt,off:Ze,css:Te,find:Dk,is:function(p,b){return!!$s(p,b,p,!1)},extend:e7,throttle:Rk,closest:$s,toggleClass:jn,clone:Ok,index:ns,nextTick:ku,cancelNextTick:pg,detectDirection:Ik,getChild:Ea};De.get=function(g){return g[Gn]};De.mount=function(){for(var g=arguments.length,p=new Array(g),b=0;b<g;b++)p[b]=arguments[b];p[0].constructor===Array&&(p=p[0]),p.forEach(function(y){if(!y.prototype||!y.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(y));y.utils&&(De.utils=Us(Us({},De.utils),y.utils)),tl.mount(y)})};De.create=function(g,p){return new De(g,p)};De.version=Z4;var Mt=[],Ki,gg,hg=!1,cg,ug,Pu,Gi;function y7(){function g(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var p in this)p.charAt(0)==="_"&&typeof this[p]=="function"&&(this[p]=this[p].bind(this))}return g.prototype={dragStarted:function(b){var y=b.originalEvent;this.sortable.nativeDraggable?nt(document,"dragover",this._handleAutoScroll):this.options.supportPointer?nt(document,"pointermove",this._handleFallbackAutoScroll):y.touches?nt(document,"touchmove",this._handleFallbackAutoScroll):nt(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(b){var y=b.originalEvent;!this.options.dragOverBubble&&!y.rootEl&&this._handleAutoScroll(y)},drop:function(){this.sortable.nativeDraggable?Ze(document,"dragover",this._handleAutoScroll):(Ze(document,"pointermove",this._handleFallbackAutoScroll),Ze(document,"touchmove",this._handleFallbackAutoScroll),Ze(document,"mousemove",this._handleFallbackAutoScroll)),xk(),Nu(),t7()},nulling:function(){Pu=gg=Ki=hg=Gi=cg=ug=null,Mt.length=0},_handleFallbackAutoScroll:function(b){this._handleAutoScroll(b,!0)},_handleAutoScroll:function(b,y){var k=this,B=(b.touches?b.touches[0]:b).clientX,L=(b.touches?b.touches[0]:b).clientY,j=document.elementFromPoint(B,L);if(Pu=b,y||this.options.forceAutoScrollFallback||el||so||Yi){fg(b,this.options,j,y);var X=Ro(j,!0);hg&&(!Gi||B!==cg||L!==ug)&&(Gi&&xk(),Gi=setInterval(function(){var Z=Ro(document.elementFromPoint(B,L),!0);Z!==X&&(X=Z,Nu()),fg(b,k.options,Z,y)},10),cg=B,ug=L)}else{if(!this.options.bubbleScroll||Ro(j,!0)===Ms()){Nu();return}fg(b,this.options,Ro(j,!1),!1)}}},no(g,{pluginName:"scroll",initializeByDefault:!0})}function Nu(){Mt.forEach(function(g){clearInterval(g.pid)}),Mt=[]}function xk(){clearInterval(Gi)}var fg=Rk(function(g,p,b,y){if(p.scroll){var k=(g.touches?g.touches[0]:g).clientX,B=(g.touches?g.touches[0]:g).clientY,L=p.scrollSensitivity,j=p.scrollSpeed,X=Ms(),Z=!1,ue;gg!==b&&(gg=b,Nu(),Ki=p.scroll,ue=p.scrollFn,Ki===!0&&(Ki=Ro(b,!0)));var ie=0,Ce=Ki;do{var Oe=Ce,Pe=jt(Oe),$e=Pe.top,gn=Pe.bottom,Yn=Pe.left,Bt=Pe.right,ce=Pe.width,Qe=Pe.height,vs=void 0,Ge=void 0,Et=Oe.scrollWidth,Dn=Oe.scrollHeight,Ye=Te(Oe),rt=Oe.scrollLeft,G=Oe.scrollTop;Oe===X?(vs=ce<Et&&(Ye.overflowX==="auto"||Ye.overflowX==="scroll"||Ye.overflowX==="visible"),Ge=Qe<Dn&&(Ye.overflowY==="auto"||Ye.overflowY==="scroll"||Ye.overflowY==="visible")):(vs=ce<Et&&(Ye.overflowX==="auto"||Ye.overflowX==="scroll"),Ge=Qe<Dn&&(Ye.overflowY==="auto"||Ye.overflowY==="scroll"));var Be=vs&&(Math.abs(Bt-k)<=L&&rt+ce<Et)-(Math.abs(Yn-k)<=L&&!!rt),Tt=Ge&&(Math.abs(gn-B)<=L&&G+Qe<Dn)-(Math.abs($e-B)<=L&&!!G);if(!Mt[ie])for(var En=0;En<=ie;En++)Mt[En]||(Mt[En]={});(Mt[ie].vx!=Be||Mt[ie].vy!=Tt||Mt[ie].el!==Oe)&&(Mt[ie].el=Oe,Mt[ie].vx=Be,Mt[ie].vy=Tt,clearInterval(Mt[ie].pid),(Be!=0||Tt!=0)&&(Z=!0,Mt[ie].pid=setInterval((function(){y&&this.layer===0&&De.active._onTouchMove(Pu);var Ee=Mt[this.layer].vy?Mt[this.layer].vy*j:0,on=Mt[this.layer].vx?Mt[this.layer].vx*j:0;typeof ue=="function"&&ue.call(De.dragged.parentNode[Gn],on,Ee,g,Pu,Mt[this.layer].el)!=="continue"||Pk(Mt[this.layer].el,on,Ee)}).bind({layer:ie}),24))),ie++}while(p.bubbleScroll&&Ce!==X&&(Ce=Ro(Ce,!1)));hg=Z}},30),Mk=function(p){var b=p.originalEvent,y=p.putSortable,k=p.dragEl,B=p.activeSortable,L=p.dispatchSortableEvent,j=p.hideGhostForTarget,X=p.unhideGhostForTarget;if(b){var Z=y||B;j();var ue=b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:b,ie=document.elementFromPoint(ue.clientX,ue.clientY);X(),Z&&!Z.el.contains(ie)&&(L("spill"),this.onSpill({dragEl:k,putSortable:y}))}};function vg(){}vg.prototype={startIndex:null,dragStart:function(p){var b=p.oldDraggableIndex;this.startIndex=b},onSpill:function(p){var b=p.dragEl,y=p.putSortable;this.sortable.captureAnimationState(),y&&y.captureAnimationState();var k=Ea(this.sortable.el,this.startIndex,this.options);k?this.sortable.el.insertBefore(b,k):this.sortable.el.appendChild(b),this.sortable.animateAll(),y&&y.animateAll()},drop:Mk};no(vg,{pluginName:"revertOnSpill"});function yg(){}yg.prototype={onSpill:function(p){var b=p.dragEl,y=p.putSortable,k=y||this.sortable;k.captureAnimationState(),b.parentNode&&b.parentNode.removeChild(b),k.animateAll()},drop:Mk};no(yg,{pluginName:"removeOnSpill"});De.mount(new y7);De.mount(yg,vg);function C7(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var Uk={exports:{}};(function(g){(function(){var p=function(e){if(e===null)return"null";if(e===void 0)return"undefined";var t=typeof e;return t==="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":t},b=function(e){return["undefined","boolean","number","string","function","xml","null"].indexOf(e)!==-1},y=function(e,t){var n=Array.prototype.slice.call(e);return n.sort(t)},k=function(e,t){return B(function(n,s){return e.eq(t(n),t(s))})},B=function(e){return{eq:e}},L=B(function(e,t){return e===t}),j=L,X=function(e){return B(function(t,n){if(t.length!==n.length)return!1;for(var s=t.length,o=0;o<s;o++)if(!e.eq(t[o],n[o]))return!1;return!0})},Z=function(e,t){return k(X(e),function(n){return y(n,t)})},ue=function(e){return B(function(t,n){var s=Object.keys(t),o=Object.keys(n);if(!Z(j).eq(s,o))return!1;for(var r=s.length,a=0;a<r;a++){var i=s[a];if(!e.eq(t[i],n[i]))return!1}return!0})},ie=B(function(e,t){if(e===t)return!0;var n=p(e),s=p(t);return n!==s?!1:b(n)?e===t:n==="array"?X(ie).eq(e,t):n==="object"?ue(ie).eq(e,t):!1});const Ce=Object.getPrototypeOf,Oe=(e,t,n)=>{var s;return n(e,t.prototype)?!0:((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},Pe=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&Oe(e,String,(n,s)=>s.isPrototypeOf(n))?"string":t},$e=e=>t=>Pe(t)===e,gn=e=>t=>typeof t===e,Yn=e=>t=>e===t,Bt=(e,t)=>Qe(e)&&Oe(e,t,(n,s)=>Ce(n)===s),ce=$e("string"),Qe=$e("object"),vs=e=>Bt(e,Object),Ge=$e("array"),Et=Yn(null),Dn=gn("boolean"),Ye=Yn(void 0),rt=e=>e==null,G=e=>!rt(e),Be=gn("function"),Tt=gn("number"),En=(e,t)=>{if(Ge(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1},Ee=()=>{},on=(e,t)=>(...n)=>e(t.apply(null,n)),Po=(e,t)=>n=>e(t(n)),Y=e=>()=>e,Kt=e=>e,Eg=(e,t)=>e===t;function ne(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const xr=e=>t=>!e(t),Sg=e=>()=>{throw new Error(e)},Bu=e=>e(),Sa=e=>{e()},lt=Y(!1),St=Y(!0);class m{constructor(t,n){this.tag=t,this.value=n}static some(t){return new m(!0,t)}static none(){return m.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?m.some(t(this.value)):m.none()}bind(t){return this.tag?t(this.value):m.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:m.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return G(t)?m.some(t):m.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}m.singletonNone=new m(!1);const Iu=Array.prototype.slice,Wk=Array.prototype.indexOf,Vk=Array.prototype.push,wg=(e,t)=>Wk.call(e,t),qk=(e,t)=>{const n=wg(e,t);return n===-1?m.none():m.some(n)},Ve=(e,t)=>wg(e,t)>-1,ht=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return!0}return!1},Ue=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const r=e[o];s[o]=t(r,o)}return s},M=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},_g=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e[n];t(s,n)}},wa=(e,t)=>{const n=[],s=[];for(let o=0,r=e.length;o<r;o++){const a=e[o];(t(a,o)?n:s).push(a)}return{pass:n,fail:s}},ve=(e,t)=>{const n=[];for(let s=0,o=e.length;s<o;s++){const r=e[s];t(r,s)&&n.push(r)}return n},_a=(e,t,n)=>(_g(e,(s,o)=>{n=t(n,s,o)}),n),Sn=(e,t,n)=>(M(e,(s,o)=>{n=t(n,s,o)}),n),xg=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++){const r=e[s];if(t(r,s))return m.some(r);if(n(r,s))break}return m.none()},_t=(e,t)=>xg(e,t,lt),xa=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return m.some(n)}return m.none()},kg=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!Ge(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);Vk.apply(t,e[n])}return t},ys=(e,t)=>kg(Ue(e,t)),oo=(e,t)=>{for(let n=0,s=e.length;n<s;++n){const o=e[n];if(t(o,n)!==!0)return!1}return!0},ka=e=>{const t=Iu.call(e,0);return t.reverse(),t},sl=(e,t)=>ve(e,n=>!Ve(t,n)),Fu=(e,t)=>{const n={};for(let s=0,o=e.length;s<o;s++){const r=e[s];n[String(r)]=t(r,s)}return n},Oo=(e,t)=>{const n=Iu.call(e,0);return n.sort(t),n},ol=(e,t)=>t>=0&&t<e.length?m.some(e[t]):m.none(),hn=e=>ol(e,0),Bo=e=>ol(e,e.length-1),rn=Be(Array.from)?Array.from:e=>Iu.call(e),kr=(e,t)=>{for(let n=0;n<e.length;n++){const s=t(e[n],n);if(s.isSome())return s}return m.none()},jk=(e,t)=>{const n=[],s=Be(t)?o=>ht(n,r=>t(r,o)):o=>Ve(n,o);for(let o=0,r=e.length;o<r;o++){const a=e[o];s(a)||n.push(a)}return n},wn=Object.keys,Kk=Object.hasOwnProperty,Je=(e,t)=>{const n=wn(e);for(let s=0,o=n.length;s<o;s++){const r=n[s],a=e[r];t(a,r)}},rl=(e,t)=>Gk(e,(n,s)=>({k:s,v:t(n,s)})),Gk=(e,t)=>{const n={};return Je(e,(s,o)=>{const r=t(s,o);n[r.k]=r.v}),n},Lu=e=>(t,n)=>{e[n]=t},Ng=(e,t,n,s)=>{Je(e,(o,r)=>{(t(o,r)?n:s)(o,r)})},Yk=(e,t)=>{const n={},s={};return Ng(e,t,Lu(n),Lu(s)),{t:n,f:s}},Na=(e,t)=>{const n={};return Ng(e,t,Lu(n),Ee),n},$u=(e,t)=>{const n=[];return Je(e,(s,o)=>{n.push(t(s,o))}),n},Mu=e=>$u(e,Kt),st=(e,t)=>Se(e,t)?m.from(e[t]):m.none(),Se=(e,t)=>Kk.call(e,t),Nr=(e,t)=>Se(e,t)&&e[t]!==void 0&&e[t]!==null,Xk=(e,t,n=ie)=>ue(n).eq(e,t),Ag=e=>{const t={};return M(e,n=>{t[n]={}}),wn(t)},Tg=e=>e.length!==void 0,Uu=Array.isArray,Zk=e=>{if(Uu(e))return e;{const t=[];for(let n=0,s=e.length;n<s;n++)t[n]=e[n];return t}},al=(e,t,n)=>{if(!e)return!1;if(n=n||e,Tg(e)){for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e)===!1)return!1}else for(const s in e)if(Se(e,s)&&t.call(n,e[s],s,e)===!1)return!1;return!0},zu=(e,t)=>{const n=[];return al(e,(s,o)=>{n.push(t(s,o,e))}),n},Aa=(e,t)=>{const n=[];return al(e,(s,o)=>{(!t||t(s,o,e))&&n.push(s)}),n},Qk=(e,t)=>{if(e){for(let n=0,s=e.length;n<s;n++)if(e[n]===t)return n}return-1},il=(e,t,n,s)=>{let o=Ye(n)?e[0]:n;for(let r=0;r<e.length;r++)o=t.call(s,o,e[r],r);return o},Dg=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e))return s;return-1},Io=e=>e[e.length-1],Fo=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},Jk=(e,t,n,s)=>{const o=e.isiOS()&&/ipad/i.test(n)===!0,r=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),i=a||s("(pointer:coarse)"),l=o||!r&&a&&s("(min-device-width:768px)"),c=r||a&&!l,f=t.isSafari()&&e.isiOS()&&/safari/i.test(n)===!1,u=!c&&!l&&!f;return{isiPad:Y(o),isiPhone:Y(r),isTablet:Y(l),isPhone:Y(c),isTouch:Y(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:Y(f),isDesktop:Y(u)}},eN=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}},tN=(e,t)=>{const n=eN(e,t);if(!n)return{major:0,minor:0};const s=o=>Number(t.replace(n,"$"+o));return Hu(s(1),s(2))},nN=(e,t)=>{const n=String(t).toLowerCase();return e.length===0?Rg():tN(e,n)},Rg=()=>Hu(0,0),Hu=(e,t)=>({major:e,minor:t}),Ta={nu:Hu,detect:nN,unknown:Rg},sN=(e,t)=>kr(t.brands,n=>{const s=n.brand.toLowerCase();return _t(e,o=>{var r;return s===((r=o.brand)===null||r===void 0?void 0:r.toLowerCase())}).map(o=>({current:o.name,version:Ta.nu(parseInt(n.version,10),0)}))}),Pg=(e,t)=>{const n=String(t).toLowerCase();return _t(e,s=>s.search(n))},oN=(e,t)=>Pg(e,t).map(n=>{const s=Ta.detect(n.versionRegexes,t);return{current:n.name,version:s}}),rN=(e,t)=>Pg(e,t).map(n=>{const s=Ta.detect(n.versionRegexes,t);return{current:n.name,version:s}}),aN=(e,t)=>e.substring(t),Og=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,Bg=(e,t)=>Ut(e,t)?aN(e,t.length):e,Gt=(e,t,n=0,s)=>{const o=e.indexOf(t,n);return o!==-1?Ye(s)?!0:o+t.length<=s:!1},Ut=(e,t)=>Og(e,t,0),Wu=(e,t)=>Og(e,t,e.length-t.length),Vu=e=>t=>t.replace(e,""),Ar=Vu(/^\s+|\s+$/g),iN=Vu(/^\s+/g),Ig=Vu(/\s+$/g),Cs=e=>e.length>0,Da=e=>!Cs(e),lN=(e,t)=>t<=0?"":new Array(t+1).join(e),ll=(e,t=10)=>{const n=parseInt(e,t);return isNaN(n)?m.none():m.some(n)},qu=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,zs=e=>t=>Gt(t,e),cN=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>Gt(e,"edge/")&&Gt(e,"chrome")&&Gt(e,"safari")&&Gt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,qu],search:e=>Gt(e,"chrome")&&!Gt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>Gt(e,"msie")||Gt(e,"trident")},{name:"Opera",versionRegexes:[qu,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:zs("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:zs("firefox")},{name:"Safari",versionRegexes:[qu,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(Gt(e,"safari")||Gt(e,"mobile/"))&&Gt(e,"applewebkit")}],uN=[{name:"Windows",search:zs("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>Gt(e,"iphone")||Gt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:zs("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:zs("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:zs("linux"),versionRegexes:[]},{name:"Solaris",search:zs("sunos"),versionRegexes:[]},{name:"FreeBSD",search:zs("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:zs("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Fg={browsers:Y(cN),oses:Y(uN)},Lg="Edge",$g="Chromium",Mg="IE",Ug="Opera",zg="Firefox",Hg="Safari",fN=()=>Wg({current:void 0,version:Ta.unknown()}),Wg=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isEdge:s(Lg),isChromium:s($g),isIE:s(Mg),isOpera:s(Ug),isFirefox:s(zg),isSafari:s(Hg)}},Vg={unknown:fN,nu:Wg,edge:Y(Lg),chromium:Y($g),ie:Y(Mg),opera:Y(Ug),firefox:Y(zg),safari:Y(Hg)},qg="Windows",jg="iOS",Kg="Android",Gg="Linux",Yg="macOS",Xg="Solaris",Zg="FreeBSD",Qg="ChromeOS",dN=()=>Jg({current:void 0,version:Ta.unknown()}),Jg=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isWindows:s(qg),isiOS:s(jg),isAndroid:s(Kg),isMacOS:s(Yg),isLinux:s(Gg),isSolaris:s(Xg),isFreeBSD:s(Zg),isChromeOS:s(Qg)}},eh={unknown:dN,nu:Jg,windows:Y(qg),ios:Y(jg),android:Y(Kg),linux:Y(Gg),macos:Y(Yg),solaris:Y(Xg),freebsd:Y(Zg),chromeos:Y(Qg)},mN={detect:(e,t,n)=>{const s=Fg.browsers(),o=Fg.oses(),r=t.bind(l=>sN(s,l)).orThunk(()=>oN(s,e)).fold(Vg.unknown,Vg.nu),a=rN(o,e).fold(eh.unknown,eh.nu),i=Jk(a,r,e,n);return{browser:r,os:a,deviceType:i}}},pN=e=>window.matchMedia(e).matches;let gN=Fo(()=>mN.detect(navigator.userAgent,m.from(navigator.userAgentData),pN));const Es=()=>gN(),hN=navigator.userAgent,ju=Es(),Ss=ju.browser,ws=ju.os,Lo=ju.deviceType,bN=hN.indexOf("Windows Phone")!==-1,Fe={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:Ss.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!Ss.isIE(),windowsPhone:bN,browser:{current:Ss.current,version:Ss.version,isChromium:Ss.isChromium,isEdge:Ss.isEdge,isFirefox:Ss.isFirefox,isIE:Ss.isIE,isOpera:Ss.isOpera,isSafari:Ss.isSafari},os:{current:ws.current,version:ws.version,isAndroid:ws.isAndroid,isChromeOS:ws.isChromeOS,isFreeBSD:ws.isFreeBSD,isiOS:ws.isiOS,isLinux:ws.isLinux,isMacOS:ws.isMacOS,isSolaris:ws.isSolaris,isWindows:ws.isWindows},deviceType:{isDesktop:Lo.isDesktop,isiPad:Lo.isiPad,isiPhone:Lo.isiPhone,isPhone:Lo.isPhone,isTablet:Lo.isTablet,isTouch:Lo.isTouch,isWebView:Lo.isWebView}},vN=/^\s*|\s*$/g,th=e=>rt(e)?"":(""+e).replace(vN,""),yN=(e,t)=>t?t==="array"&&Uu(e)?!0:typeof e===t:e!==void 0,CN=(e,t,n={})=>{const s=ce(e)?e.split(t||","):e||[];let o=s.length;for(;o--;)n[s[o]]={};return n},EN=Se,SN=(e,...t)=>{for(let n=0;n<t.length;n++){const s=t[n];for(const o in s)if(Se(s,o)){const r=s[o];r!==void 0&&(e[o]=r)}}return e},nh=function(e,t,n,s){s=s||this,e&&(n&&(e=e[n]),al(e,(o,r)=>t.call(s,o,r,n)===!1?!1:(nh(o,t,n,s),!0)))},V={trim:th,isArray:Uu,is:yN,toArray:Zk,makeMap:CN,each:al,map:zu,grep:Aa,inArray:Qk,hasOwn:EN,extend:SN,walk:nh,resolve:(e,t=window)=>{const n=e.split(".");for(let s=0,o=n.length;s<o&&(t=t[n[s]],!!t);s++);return t},explode:(e,t)=>Ge(e)?e:e===""?[]:zu(e.split(t||","),th),_addCacheSuffix:e=>{const t=Fe.cacheSuffix;return t&&(e+=(e.indexOf("?")===-1?"?":"&")+t),e}},Tr=(e,t,n=Eg)=>e.exists(s=>n(s,t)),wN=e=>{const t=[],n=s=>{t.push(s)};for(let s=0;s<e.length;s++)e[s].each(n);return t},an=(e,t,n)=>e.isSome()&&t.isSome()?m.some(n(e.getOrDie(),t.getOrDie())):m.none(),_N=(e,t,n,s)=>e.isSome()&&t.isSome()&&n.isSome()?m.some(s(e.getOrDie(),t.getOrDie(),n.getOrDie())):m.none(),Dr=(e,t)=>e?m.some(t):m.none(),xN=typeof window<"u"?window:Function("return this;")(),kN=(e,t)=>{let n=t??xN;for(let s=0;s<e.length&&n!==void 0&&n!==null;++s)n=n[e[s]];return n},sh=(e,t)=>{const n=e.split(".");return kN(n,t)},NN=(e,t)=>sh(e,t),AN=(e,t)=>{const n=NN(e,t);if(n==null)throw new Error(e+" not available on this browser");return n},TN=Object.getPrototypeOf,DN=e=>AN("HTMLElement",e),RN=e=>{const t=sh("ownerDocument.defaultView",e);return Qe(e)&&(DN(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(TN(e).constructor.name))},oh=8,rh=9,ah=11,Ra=1,ih=3,et=e=>e.dom.nodeName.toLowerCase(),lh=e=>e.dom.nodeType,cl=e=>t=>lh(t)===e,PN=e=>lh(e)===oh||et(e)==="#comment",Ku=e=>bn(e)&&RN(e.dom),bn=cl(Ra),Rn=cl(ih),ON=cl(rh),BN=cl(ah),Gu=e=>t=>bn(t)&&et(t)===e,ch=(e,t,n)=>{if(ce(n)||Dn(n)||Tt(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},It=(e,t,n)=>{ch(e.dom,t,n)},ro=(e,t)=>{const n=e.dom;Je(t,(s,o)=>{ch(n,o,s)})},Pn=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},Hs=(e,t)=>m.from(Pn(e,t)),ul=(e,t)=>{const n=e.dom;return n&&n.hasAttribute?n.hasAttribute(t):!1},zt=(e,t)=>{e.dom.removeAttribute(t)},IN=e=>{const t=e.dom.attributes;return t==null||t.length===0},uh=e=>Sn(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),Yu=(e,t)=>{const n=Pn(e,t);return n===void 0||n===""?[]:n.split(" ")},FN=(e,t,n)=>{const o=Yu(e,t).concat([n]);return It(e,t,o.join(" ")),!0},LN=(e,t,n)=>{const s=ve(Yu(e,t),o=>o!==n);return s.length>0?It(e,t,s.join(" ")):zt(e,t),!1},Pa=e=>e.dom.classList!==void 0,fh=e=>Yu(e,"class"),dh=(e,t)=>FN(e,"class",t),mh=(e,t)=>LN(e,"class",t),$N=(e,t)=>Ve(fh(e),t)?mh(e,t):dh(e,t),Rr=(e,t)=>{Pa(e)?e.dom.classList.add(t):dh(e,t)},ph=e=>{(Pa(e)?e.dom.classList:fh(e)).length===0&&zt(e,"class")},Pr=(e,t)=>{Pa(e)?e.dom.classList.remove(t):mh(e,t),ph(e)},MN=(e,t)=>{const n=Pa(e)?e.dom.classList.toggle(t):$N(e,t);return ph(e),n},Xu=(e,t)=>Pa(e)&&e.dom.classList.contains(t),UN=(e,t)=>{const s=(t||document).createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const o="HTML does not have a single root node";throw console.error(o,e),new Error(o)}return Oa(s.childNodes[0])},zN=(e,t)=>{const s=(t||document).createElement(e);return Oa(s)},HN=(e,t)=>{const s=(t||document).createTextNode(e);return Oa(s)},Oa=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},S={fromHtml:UN,fromTag:zN,fromText:HN,fromDom:Oa,fromPoint:(e,t,n)=>m.from(e.dom.elementFromPoint(t,n)).map(Oa)},gh=(e,t)=>{const n=[],s=r=>(n.push(r),t(r));let o=t(e);do o=o.bind(s);while(o.isSome());return n},ss=(e,t)=>{const n=e.dom;if(n.nodeType!==Ra)return!1;{const s=n;if(s.matches!==void 0)return s.matches(t);if(s.msMatchesSelector!==void 0)return s.msMatchesSelector(t);if(s.webkitMatchesSelector!==void 0)return s.webkitMatchesSelector(t);if(s.mozMatchesSelector!==void 0)return s.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},hh=e=>e.nodeType!==Ra&&e.nodeType!==rh&&e.nodeType!==ah||e.childElementCount===0,WN=(e,t)=>{const n=t===void 0?document:t.dom;return hh(n)?[]:Ue(n.querySelectorAll(e),S.fromDom)},VN=(e,t)=>{const n=t===void 0?document:t.dom;return hh(n)?m.none():m.from(n.querySelector(e)).map(S.fromDom)},ze=(e,t)=>e.dom===t.dom,Ws=(e,t)=>{const n=e.dom,s=t.dom;return n===s?!1:n.contains(s)},bh=e=>S.fromDom(e.dom.ownerDocument),Vs=e=>ON(e)?e:bh(e),qN=e=>S.fromDom(Vs(e).dom.documentElement),Ba=e=>S.fromDom(Vs(e).dom.defaultView),Xn=e=>m.from(e.dom.parentNode).map(S.fromDom),Zu=e=>m.from(e.dom.parentElement).map(S.fromDom),vh=(e,t)=>{const n=Be(t)?t:lt;let s=e.dom;const o=[];for(;s.parentNode!==null&&s.parentNode!==void 0;){const r=s.parentNode,a=S.fromDom(r);if(o.push(a),n(a)===!0)break;s=r}return o},jN=e=>{const t=n=>ve(n,s=>!ze(e,s));return Xn(e).map(Ht).map(t).getOr([])},$o=e=>m.from(e.dom.previousSibling).map(S.fromDom),Ia=e=>m.from(e.dom.nextSibling).map(S.fromDom),yh=e=>ka(gh(e,$o)),Ch=e=>gh(e,Ia),Ht=e=>Ue(e.dom.childNodes,S.fromDom),Or=(e,t)=>{const n=e.dom.childNodes;return m.from(n[t]).map(S.fromDom)},Qu=e=>Or(e,0),Ju=e=>Or(e,e.dom.childNodes.length-1),ef=e=>e.dom.childNodes.length,KN=e=>e.dom.hasChildNodes(),GN=e=>{const t=e.dom.head;if(t==null)throw new Error("Head is not available yet");return S.fromDom(t)},tf=e=>BN(e)&&G(e.dom.host),Eh=Be(Element.prototype.attachShadow)&&Be(Node.prototype.getRootNode),YN=Y(Eh),ao=Eh?e=>S.fromDom(e.dom.getRootNode()):Vs,nf=e=>tf(e)?e:GN(Vs(e)),XN=e=>tf(e)?e:S.fromDom(Vs(e).dom.body),ZN=e=>{const t=ao(e);return tf(t)?m.some(t):m.none()},QN=e=>S.fromDom(e.dom.host),Sh=e=>{if(YN()&&G(e.target)){const t=S.fromDom(e.target);if(bn(t)&&JN(t)&&e.composed&&e.composedPath){const n=e.composedPath();if(n)return hn(n)}}return m.from(e.target)},JN=e=>G(e.dom.shadowRoot),Br=e=>{const t=Rn(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return ZN(S.fromDom(t)).fold(()=>n.body.contains(t),Po(Br,QN))};var wh=(e,t,n,s,o)=>e(n,s)?m.some(n):Be(o)&&o(n)?m.none():t(n,s,o);const qs=(e,t,n)=>{let s=e.dom;const o=Be(n)?n:lt;for(;s.parentNode;){s=s.parentNode;const r=S.fromDom(s);if(t(r))return m.some(r);if(o(r))break}return m.none()},Mo=(e,t,n)=>wh((o,r)=>r(o),qs,e,t,n),eA=(e,t)=>{const n=e.dom;return n.parentNode?tA(S.fromDom(n.parentNode),s=>!ze(e,s)&&t(s)):m.none()},tA=(e,t)=>{const n=o=>t(S.fromDom(o));return _t(e.dom.childNodes,n).map(S.fromDom)},nA=(e,t)=>{const n=s=>{for(let o=0;o<s.childNodes.length;o++){const r=S.fromDom(s.childNodes[o]);if(t(r))return m.some(r);const a=n(s.childNodes[o]);if(a.isSome())return a}return m.none()};return n(e.dom)},Fa=(e,t,n)=>qs(e,s=>ss(s,t),n),La=(e,t)=>VN(t,e),Uo=(e,t,n)=>wh((o,r)=>ss(o,r),Fa,e,t,n),sA=e=>Uo(e,"[contenteditable]"),Ir=(e,t=!1)=>Br(e)?e.dom.isContentEditable:sA(e).fold(Y(t),n=>oA(n)==="true"),oA=e=>e.dom.contentEditable,$a=e=>e.style!==void 0&&Be(e.style.getPropertyValue),_h=(e,t,n)=>{if(!ce(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);$a(e)&&e.style.setProperty(t,n)},rA=(e,t)=>{$a(e)&&e.style.removeProperty(t)},xh=(e,t,n)=>{const s=e.dom;_h(s,t,n)},fl=(e,t)=>{const n=e.dom;Je(t,(s,o)=>{_h(n,o,s)})},_s=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return o===""&&!Br(e)?kh(n,t):o},kh=(e,t)=>$a(e)?e.style.getPropertyValue(t):"",dl=(e,t)=>{const n=e.dom,s=kh(n,t);return m.from(s).filter(o=>o.length>0)},Nh=e=>{const t={},n=e.dom;if($a(n))for(let s=0;s<n.style.length;s++){const o=n.style.item(s);t[o]=n.style[o]}return t},Ah=(e,t)=>{const n=e.dom;rA(n,t),Tr(Hs(e,"style").map(Ar),"")&&zt(e,"style")},aA=e=>e.dom.offsetWidth,_n=(e,t)=>{Xn(e).each(s=>{s.dom.insertBefore(t.dom,e.dom)})},io=(e,t)=>{Ia(e).fold(()=>{Xn(e).each(o=>{bt(o,t)})},s=>{_n(s,t)})},Th=(e,t)=>{Qu(e).fold(()=>{bt(e,t)},s=>{e.dom.insertBefore(t.dom,s.dom)})},bt=(e,t)=>{e.dom.appendChild(t.dom)},Dh=(e,t)=>{_n(e,t),bt(t,e)},iA=(e,t)=>{M(t,(n,s)=>{const o=s===0?e:t[s-1];io(o,n)})},zo=(e,t)=>{M(t,n=>{bt(e,n)})},Fr=e=>{e.dom.textContent="",M(Ht(e),t=>{at(t)})},at=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},js=e=>{const t=Ht(e);t.length>0&&iA(e,t),at(e)},lA=(e,t)=>{const s=(t||document).createElement("div");return s.innerHTML=e,Ht(S.fromDom(s))},sf=e=>Ue(e,S.fromDom),Rh=e=>e.dom.innerHTML,ml=(e,t)=>{const s=bh(e).dom,o=S.fromDom(s.createDocumentFragment()),r=lA(t,s);zo(o,r),Fr(e),bt(e,o)},cA=e=>{const t=S.fromTag("div"),n=S.fromDom(e.dom.cloneNode(!0));return bt(t,n),Rh(t)},uA=(e,t,n,s,o,r,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:r,raw:a}),fA=e=>{const t=S.fromDom(Sh(e).getOr(e.target)),n=()=>e.stopPropagation(),s=()=>e.preventDefault(),o=on(s,n);return uA(t,e.clientX,e.clientY,n,s,o,e)},dA=(e,t)=>n=>{e(n)&&t(fA(n))},mA=(e,t,n,s,o)=>{const r=dA(n,s);return e.dom.addEventListener(t,r,o),{unbind:ne(gA,e,t,r,o)}},pA=(e,t,n,s)=>mA(e,t,n,s,!1),gA=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},Ph=(e,t)=>({left:e,top:t,translate:(s,o)=>Ph(e+s,t+o)}),Lr=Ph,hA=e=>{const t=e.getBoundingClientRect();return Lr(t.left,t.top)},pl=(e,t)=>e!==void 0?e:t!==void 0?t:0,bA=e=>{const t=e.dom.ownerDocument,n=t.body,s=t.defaultView,o=t.documentElement;if(n===e.dom)return Lr(n.offsetLeft,n.offsetTop);const r=pl(s==null?void 0:s.pageYOffset,o.scrollTop),a=pl(s==null?void 0:s.pageXOffset,o.scrollLeft),i=pl(o.clientTop,n.clientTop),l=pl(o.clientLeft,n.clientLeft);return of(e).translate(a-l,r-i)},of=e=>{const t=e.dom,s=t.ownerDocument.body;return s===t?Lr(s.offsetLeft,s.offsetTop):Br(e)?hA(t):Lr(0,0)},rf=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return Lr(n,s)},Oh=(e,t)=>{Es().browser.isSafari()&&Be(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},vA=e=>{const t=e===void 0?window:e;return Es().browser.isFirefox()?m.none():m.from(t.visualViewport)},Bh=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),Ih=e=>{const t=e===void 0?window:e,n=t.document,s=rf(S.fromDom(n));return vA(t).fold(()=>{const o=t.document.documentElement,r=o.clientWidth,a=o.clientHeight;return Bh(s.left,s.top,r,a)},o=>Bh(Math.max(o.pageLeft,s.left),Math.max(o.pageTop,s.top),o.width,o.height))},yA=(e,t)=>ve(Ht(e),t),Fh=(e,t)=>{let n=[];return M(Ht(e),s=>{t(s)&&(n=n.concat([s])),n=n.concat(Fh(s,t))}),n},Yt=(e,t)=>WN(t,e),Lh=(e,t,n)=>Fa(e,t,n).isSome();class xt{constructor(t,n){this.node=t,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,n,s,o){if(t){if(!o&&t[n])return t[n];if(t!==this.rootNode){let r=t[s];if(r)return r;for(let a=t.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(r=a[s],r)return r}}}findPreviousNode(t,n){if(t){const s=t.previousSibling;if(this.rootNode&&s===this.rootNode)return;if(s){if(!n){for(let r=s.lastChild;r;r=r.lastChild)if(!r.lastChild)return r}return s}const o=t.parentNode;if(o&&o!==this.rootNode)return o}}}const Ho=e=>t=>!!t&&t.nodeType===e,gl=e=>!!e&&!Object.getPrototypeOf(e),Q=Ho(1),Ma=e=>{const t=e.toLowerCase();return n=>G(n)&&n.nodeName.toLowerCase()===t},os=e=>{const t=e.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const s=n.nodeName.toLowerCase();return Ve(t,s)}return!1}},hl=(e,t)=>{const n=t.toLowerCase().split(" ");return s=>{if(Q(s)){const o=s.ownerDocument.defaultView;if(o)for(let r=0;r<n.length;r++){const a=o.getComputedStyle(s,null);if((a?a.getPropertyValue(e):null)===n[r])return!0}}return!1}},$h=e=>t=>Q(t)&&t.hasAttribute(e),CA=(e,t)=>n=>Q(n)&&n.getAttribute(e)===t,Wo=e=>Q(e)&&e.hasAttribute("data-mce-bogus"),EA=e=>Q(e)&&e.getAttribute("data-mce-bogus")==="all",Ks=e=>Q(e)&&e.tagName==="TABLE",Mh=e=>t=>!!(Q(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),af=os(["textarea","input"]),z=Ho(3),SA=Ho(4),wA=Ho(7),lo=Ho(8),Ua=Ho(9),lf=Ho(11),dt=Ma("br"),Uh=Ma("img"),rs=Mh("true"),tt=Mh("false"),bl=os(["td","th"]),_A=os(["td","th","caption"]),xs=os(["video","audio","object","embed"]),xA=Ma("li"),zh=Ma("details"),kA=Ma("summary"),$r="\uFEFF",Dt="",cf=e=>e===$r,NA=e=>e.replace(/\uFEFF/g,""),uf=((e,t)=>{const n=r=>{if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return s(r).getOr("")},s=r=>e(r)?m.from(r.dom.nodeValue):m.none();return{get:n,getOption:s,set:(r,a)=>{if(!e(r))throw new Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=a}}})(Rn,"text"),vl=e=>uf.get(e),Hh=e=>uf.getOption(e),AA=(e,t)=>uf.set(e,t),TA=["article","aside","details","div","dt","figcaption","footer","form","fieldset","header","hgroup","html","main","nav","section","summary","body","p","dl","multicol","dd","figure","address","center","blockquote","h1","h2","h3","h4","h5","h6","listing","xmp","pre","plaintext","menu","dir","ul","ol","li","hr","table","tbody","thead","tfoot","th","tr","td","caption"],DA=["td","th"],RA=["thead","tbody","tfoot"],PA=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],OA=["h1","h2","h3","h4","h5","h6"],BA=["li","dd","dt"],IA=["ul","ol","dl"],FA=["pre","script","textarea","style"],LA=["pre"].concat(OA),co=e=>{let t;return n=>(t=t||Fu(e,St),Se(t,et(n)))},On=co(TA),$A=e=>et(e)==="table",yl=e=>bn(e)&&!On(e),Vo=e=>bn(e)&&et(e)==="br",Wh=co(PA),ff=co(IA),za=co(BA),MA=co(RA),Ha=co(DA),Cl=co(FA),UA=co(LA),zA=e=>UA(e)||yl(e),HA=e=>{const t=[];let n=e.dom;for(;n;)t.push(S.fromDom(n)),n=n.lastChild;return t},WA=e=>{const t=Yt(e,"br"),n=ve(HA(e).slice(-1),Vo);t.length===n.length&&M(n,at)},El=()=>{const e=S.fromTag("br");return It(e,"data-mce-bogus","1"),e},uo=e=>{Fr(e),bt(e,El())},VA=e=>{Ju(e).each(t=>{$o(t).each(n=>{On(e)&&Vo(t)&&On(n)&&at(t)})})},Wt=$r,Sl=cf,Gs=NA,qA=Q,Mr=z,Ur=e=>(Mr(e)&&(e=e.parentNode),qA(e)&&e.hasAttribute("data-mce-caret")),fo=e=>Mr(e)&&Sl(e.data),Bn=e=>Ur(e)||fo(e),Vh=e=>e.firstChild!==e.lastChild||!dt(e.firstChild),jA=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(Wt),r=e.parentNode;if(t){const a=e.previousSibling;if(Mr(a)){if(Bn(a))return a;if(_l(a))return a.splitText(a.data.length-1)}r==null||r.insertBefore(o,e)}else{const a=e.nextSibling;if(Mr(a)){if(Bn(a))return a;if(wl(a))return a.splitText(1),a}e.nextSibling?r==null||r.insertBefore(o,e.nextSibling):r==null||r.appendChild(o)}return o},df=e=>{const t=e.container();return z(t)?t.data.charAt(e.offset())===Wt||e.isAtStart()&&fo(t.previousSibling):!1},mf=e=>{const t=e.container();return z(t)?t.data.charAt(e.offset()-1)===Wt||e.isAtEnd()&&fo(t.nextSibling):!1},KA=(e,t,n)=>{var s;const r=((s=t.ownerDocument)!==null&&s!==void 0?s:document).createElement(e);r.setAttribute("data-mce-caret",n?"before":"after"),r.setAttribute("data-mce-bogus","all"),r.appendChild(El().dom);const a=t.parentNode;return n?a==null||a.insertBefore(r,t):t.nextSibling?a==null||a.insertBefore(r,t.nextSibling):a==null||a.appendChild(r),r},wl=e=>Mr(e)&&e.data[0]===Wt,_l=e=>Mr(e)&&e.data[e.data.length-1]===Wt,GA=e=>{var t;const n=e.getElementsByTagName("br"),s=n[n.length-1];Wo(s)&&((t=s.parentNode)===null||t===void 0||t.removeChild(s))},pf=e=>e&&e.hasAttribute("data-mce-caret")?(GA(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,qh=e=>Ur(e.startContainer),jh=rs,YA=tt,XA=dt,ZA=z,QA=os(["script","style","textarea"]),Kh=os(["img","input","textarea","hr","iframe","video","audio","object","embed"]),JA=os(["table"]),eT=Bn,Zn=e=>eT(e)?!1:ZA(e)?!QA(e.parentNode):Kh(e)||XA(e)||JA(e)||gf(e),tT=e=>Q(e)&&e.getAttribute("unselectable")==="true",gf=e=>!tT(e)&&YA(e),nT=(e,t)=>{for(let n=e.parentNode;n&&n!==t;n=n.parentNode){if(gf(n))return!1;if(jh(n))return!0}return!0},sT=e=>gf(e)?!Sn(rn(e.getElementsByTagName("*")),(t,n)=>t||jh(n),!1):!1,oT=e=>Kh(e)||sT(e),Gh=(e,t)=>Zn(e)&&nT(e,t),rT=/^[ \t\r\n]*$/,qo=e=>rT.test(e),aT=e=>{for(const t of e)if(!cf(t))return!1;return!0},iT=e=>" \f	\v".indexOf(e)!==-1,Yh=e=>e===`
`||e==="\r",lT=(e,t)=>t<e.length&&t>=0?Yh(e[t]):!1,Xh=(e,t=4,n=!0,s=!0)=>{const o=lN(" ",t),r=e.replace(/\t/g,o);return Sn(r,(i,l)=>iT(l)||l===Dt?i.pcIsSpace||i.str===""&&n||i.str.length===r.length-1&&s||lT(r,i.str.length+1)?{pcIsSpace:!1,str:i.str+Dt}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:Yh(l),str:i.str+l},{pcIsSpace:!1,str:""}).str},cT=(e,t)=>{const n=S.fromDom(t),s=S.fromDom(e);return Lh(s,"pre,code",ne(ze,n))},uT=(e,t)=>z(e)&&qo(e.data)&&!cT(e,t),fT=e=>Q(e)&&e.nodeName==="A"&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),xl=(e,t)=>Zn(e)&&!uT(e,t)||fT(e)||dT(e),dT=$h("data-mce-bookmark"),mT=$h("data-mce-bogus"),pT=CA("data-mce-bogus","all"),gT=(e,t)=>{let n=0;if(xl(e,e))return!1;{let s=e.firstChild;if(!s)return!0;const o=new xt(s,e);do{if(t){if(pT(s)){s=o.next(!0);continue}if(mT(s)){s=o.next();continue}}if(dt(s)){n++,s=o.next();continue}if(xl(s,e))return!1;s=o.next()}while(s);return n<=1}},vt=(e,t=!0)=>gT(e.dom,t),Wa="data-mce-block",hT=e=>ve(wn(e),t=>!/[A-Z]/.test(t)),hf=e=>hT(e).join(","),Zh=(e,t)=>G(t.querySelector(e))?(t.setAttribute(Wa,"true"),t.getAttribute("data-mce-selected")==="inline-boundary"&&t.removeAttribute("data-mce-selected"),!0):(t.removeAttribute(Wa),!1),Qh=(e,t)=>{const n=hf(e.getTransparentElements()),s=hf(e.getBlockElements());return ve(t.querySelectorAll(n),o=>Zh(s,o))},Jh=(e,t)=>{var n;const s=t?"lastChild":"firstChild";for(let o=e[s];o;o=o[s])if(vt(S.fromDom(o))){(n=o.parentNode)===null||n===void 0||n.removeChild(o);return}},bT=(e,t)=>{const n=document.createRange(),s=e.parentNode;if(s){n.setStartBefore(e),n.setEndBefore(t);const o=n.extractContents();Jh(o,!0),n.setStartAfter(t),n.setEndAfter(e);const r=n.extractContents();Jh(r,!1),vt(S.fromDom(o))||s.insertBefore(o,e),vt(S.fromDom(t))||s.insertBefore(t,e),vt(S.fromDom(r))||s.insertBefore(r,e),s.removeChild(e)}},vT=(e,t,n)=>{const s=e.getBlockElements(),o=S.fromDom(t),r=i=>et(i)in s,a=i=>ze(i,o);M(sf(n),i=>{qs(i,r,a).each(l=>{const c=yA(i,f=>r(f)&&!e.isValidChild(et(l),et(f)));if(c.length>0){const f=Zu(l);M(c,u=>{qs(u,r,a).each(d=>{bT(d.dom,u.dom)})}),f.each(u=>Qh(e,u.dom))}})})},yT=(e,t,n)=>{M([...n,...jo(e,t)?[t]:[]],s=>M(Yt(S.fromDom(s),s.nodeName.toLowerCase()),o=>{ST(e,o.dom)&&js(o)}))},bf=(e,t)=>{const n=Qh(e,t);vT(e,t,n),yT(e,t,n)},CT=(e,t)=>{if(yf(e,t)){const n=hf(e.getBlockElements());Zh(n,t)}},ET=(e,t,n)=>{const s=r=>ze(r,S.fromDom(t)),o=vh(S.fromDom(n),s);ol(o,o.length-2).filter(bn).fold(()=>bf(e,t),r=>bf(e,r.dom))},vf=e=>e.hasAttribute(Wa),kl=(e,t)=>Se(e.getTransparentElements(),t),yf=(e,t)=>Q(t)&&kl(e,t.nodeName),jo=(e,t)=>yf(e,t)&&vf(t),ST=(e,t)=>yf(e,t)&&!vf(t),eb=(e,t)=>t.type===1&&kl(e,t.name)&&ce(t.attr(Wa)),wT=(e,t)=>t.type===1&&kl(e,t.name)&&Ye(t.attr(Wa)),_T=Es().browser,tb=e=>_t(e,bn),xT=e=>_T.isFirefox()&&et(e)==="table"?tb(Ht(e)).filter(t=>et(t)==="caption").bind(t=>tb(Ch(t)).map(n=>{const s=n.dom.offsetTop,o=t.dom.offsetTop,r=t.dom.offsetHeight;return s<=o?-r:0})).getOr(0):0,nb=(e,t)=>e.children&&Ve(e.children,t),kT=(e,t,n)=>{let s=0,o=0;const r=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&_s(S.fromDom(e),"position")==="static"){const i=t.getBoundingClientRect();return s=i.left+(r.documentElement.scrollLeft||e.scrollLeft)-r.documentElement.clientLeft,o=i.top+(r.documentElement.scrollTop||e.scrollTop)-r.documentElement.clientTop,{x:s,y:o}}let a=t;for(;a&&a!==n&&a.nodeType&&!nb(a,n);){const i=a;s+=i.offsetLeft||0,o+=i.offsetTop||0,a=i.offsetParent}for(a=t.parentNode;a&&a!==n&&a.nodeType&&!nb(a,n);)s-=a.scrollLeft||0,o-=a.scrollTop||0,a=a.parentNode;o+=xT(S.fromDom(t))}return{x:s,y:o}},sb=(e,t={})=>{let n=0;const s={},o=S.fromDom(e),r=Vs(o),a=h=>{t.referrerPolicy=h},i=h=>{t.contentCssCors=h},l=h=>{bt(nf(o),h)},c=h=>{const C=nf(o);La(C,"#"+h).each(at)},f=h=>st(s,h).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),u=h=>new Promise((C,w)=>{let _;const x=V._addCacheSuffix(h),N=f(x);s[x]=N,N.count++;const I=(O,q)=>{M(O,Sa),N.status=q,N.passed=[],N.failed=[],_&&(_.onload=null,_.onerror=null,_=null)},oe=()=>I(N.passed,2),F=()=>I(N.failed,3);if(C&&N.passed.push(C),w&&N.failed.push(w),N.status===1)return;if(N.status===2){oe();return}if(N.status===3){F();return}N.status=1;const D=S.fromTag("link",r.dom);ro(D,{rel:"stylesheet",type:"text/css",id:N.id}),t.contentCssCors&&It(D,"crossOrigin","anonymous"),t.referrerPolicy&&It(D,"referrerpolicy",t.referrerPolicy),_=D.dom,_.onload=oe,_.onerror=F,l(D),It(D,"href",x)}),d=h=>Promise.allSettled(Ue(h,w=>u(w).then(Y(w)))).then(w=>{const _=wa(w,x=>x.status==="fulfilled");return _.fail.length>0?Promise.reject(Ue(_.fail,x=>x.reason)):Ue(_.pass,x=>x.value)}),v=h=>{const C=V._addCacheSuffix(h);st(s,C).each(w=>{--w.count===0&&(delete s[C],c(w.id))})};return{load:u,loadAll:d,unload:v,unloadAll:h=>{M(h,C=>{v(C)})},_setReferrerPolicy:a,_setContentCssCors:i}},ob=(()=>{const e=new WeakMap;return{forElement:(n,s)=>{const r=ao(n).dom;return m.from(e.get(r)).getOrThunk(()=>{const a=sb(r,s);return e.set(r,a),a})}}})(),NT=e=>e.nodeName.toLowerCase()==="span",rb=(e,t)=>G(e)&&(xl(e,t)||yl(S.fromDom(e))),AT=(e,t)=>{const n=new xt(e,t).prev(!1),s=new xt(e,t).next(!1),o=Ye(n)||rb(n,t),r=Ye(s)||rb(s,t);return o&&r},ab=e=>NT(e)&&e.getAttribute("data-mce-type")==="bookmark",TT=(e,t)=>z(e)&&e.data.length>0&&AT(e,t),DT=e=>Q(e)?e.childNodes.length>0:!1,RT=e=>lf(e)||Ua(e),Cf=(e,t,n)=>{var s;const o=n||t;if(Q(t)&&ab(t))return t;const r=t.childNodes;for(let a=r.length-1;a>=0;a--)Cf(e,r[a],o);if(Q(t)){const a=t.childNodes;a.length===1&&ab(a[0])&&((s=t.parentNode)===null||s===void 0||s.insertBefore(a[0],t))}return!RT(t)&&!xl(t,o)&&!DT(t)&&!TT(t,o)&&e.remove(t),t},PT=V.makeMap,Nl=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Al=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,OT=/[<>&\"\']/g,BT=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,IT={128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""},Ko={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},FT={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},LT=e=>{const t=S.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},ib=(e,t)=>{const n={};if(e){const s=e.split(",");t=t||10;for(let o=0;o<s.length;o+=2){const r=String.fromCharCode(parseInt(s[o],t));if(!Ko[r]){const a="&"+s[o+1]+";";n[r]=a,n[a]=r}}return n}else return},Ef=ib("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),lb=(e,t)=>e.replace(t?Nl:Al,n=>Ko[n]||n),$T=e=>(""+e).replace(OT,t=>Ko[t]||t),cb=(e,t)=>e.replace(t?Nl:Al,n=>n.length>1?"&#"+((n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320)+65536)+";":Ko[n]||"&#"+n.charCodeAt(0)+";"),Sf=(e,t,n)=>{const s=n||Ef;return e.replace(t?Nl:Al,o=>Ko[o]||s[o]||o)},mo={encodeRaw:lb,encodeAllRaw:$T,encodeNumeric:cb,encodeNamed:Sf,getEncodeFunc:(e,t)=>{const n=ib(t)||Ef,s=(a,i)=>a.replace(i?Nl:Al,l=>Ko[l]!==void 0?Ko[l]:n[l]!==void 0?n[l]:l.length>1?"&#"+((l.charCodeAt(0)-55296)*1024+(l.charCodeAt(1)-56320)+65536)+";":"&#"+l.charCodeAt(0)+";"),o=(a,i)=>Sf(a,i,n),r=PT(e.replace(/\+/g,","));return r.named&&r.numeric?s:r.named?t?o:Sf:r.numeric?cb:lb},decode:e=>e.replace(BT,(t,n)=>n?(n.charAt(0).toLowerCase()==="x"?n=parseInt(n.substr(1),16):n=parseInt(n,10),n>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(n&1023))):IT[n]||String.fromCharCode(n)):FT[t]||Ef[t]||LT(t))},Tl={},Dl={},MT={},zr=V.makeMap,Xt=V.each,wf=V.extend,ub=V.explode,UT=V.inArray,Vt=(e,t)=>(e=V.trim(e),e?e.split(t||" "):[]),fb=(e,t={})=>{const n=zr(e," ",zr(e.toUpperCase()," "));return wf(n,t)},db=e=>fb("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),zT=e=>{const t={};let n,s,o,r;const a=(l,c="",f="")=>{const u=Vt(f),d=Vt(l);let v=d.length;for(;v--;){const E=Vt([n,c].join(" "));t[d[v]]={attributes:Fu(E,()=>({})),attributesOrder:E,children:Fu(u,Y(MT))}}},i=(l,c)=>{const f=Vt(l),u=Vt(c);let d=f.length;for(;d--;){const v=t[f[d]];for(let E=0,h=u.length;E<h;E++)v.attributes[u[E]]={},v.attributesOrder.push(u[E])}};if(Tl[e])return Tl[e];if(n="id accesskey class dir lang style tabindex title role",s="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",o="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",e!=="html4"){const l="a ins del canvas map";n+=" contenteditable contextmenu draggable dropzone hidden spellcheck translate",s+=" article aside details dialog figure main header footer hgroup section nav "+l,o+=" audio canvas command datalist mark meter output picture progress time wbr video ruby bdi keygen"}if(e!=="html5-strict"){n+=" xml:lang";const l="acronym applet basefont big font strike tt";o=[o,l].join(" "),Xt(Vt(l),f=>{a(f,"",o)});const c="center dir isindex noframes";s=[s,c].join(" "),r=[s,o].join(" "),Xt(Vt(c),f=>{a(f,"",r)})}return r=r||[s,o].join(" "),a("html","manifest","head body"),a("head","","base command link meta noscript script style title"),a("title hr noscript br"),a("base","href target"),a("link","href rel media hreflang type sizes hreflang"),a("meta","name http-equiv content charset"),a("style","media type scoped"),a("script","src async defer type charset"),a("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",r),a("dd div","",r),a("address dt caption","",e==="html4"?o:r),a("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",o),a("blockquote","cite",r),a("ol","reversed start type","li"),a("ul","","li"),a("li","value",r),a("dl","","dt dd"),a("a","href target rel media hreflang type",e==="html4"?o:r),a("q","cite",o),a("ins del","cite datetime",r),a("img","src sizes srcset alt usemap ismap width height"),a("iframe","src name width height",r),a("embed","src type width height"),a("object","data type typemustmatch name usemap form width height",[r,"param"].join(" ")),a("param","name value"),a("map","name",[r,"area"].join(" ")),a("area","alt coords shape href target rel media hreflang type"),a("table","border","caption colgroup thead tfoot tbody tr"+(e==="html4"?" col":"")),a("colgroup","span","col"),a("col","span"),a("tbody thead tfoot","","tr"),a("tr","","td th"),a("td","colspan rowspan headers",r),a("th","colspan rowspan headers scope abbr",r),a("form","accept-charset action autocomplete enctype method name novalidate target",r),a("fieldset","disabled form name",[r,"legend"].join(" ")),a("label","form for",o),a("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),a("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",e==="html4"?r:o),a("select","disabled form multiple name required size","option optgroup"),a("optgroup","disabled label","option"),a("option","disabled label selected value"),a("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),a("menu","type label",[r,"li"].join(" ")),a("noscript","",r),e!=="html4"&&(a("wbr"),a("ruby","",[o,"rt rp"].join(" ")),a("figcaption","",r),a("mark rt rp summary bdi","",o),a("canvas","width height",r),a("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[r,"track source"].join(" ")),a("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[r,"track source"].join(" ")),a("picture","","img source"),a("source","src srcset type media sizes"),a("track","kind src srclang label default"),a("datalist","",[o,"option"].join(" ")),a("article section nav aside main header footer","",r),a("hgroup","","h1 h2 h3 h4 h5 h6"),a("figure","",[r,"figcaption"].join(" ")),a("time","datetime",o),a("dialog","open",r),a("command","type label icon disabled checked radiogroup command"),a("output","for form name",o),a("progress","value max",o),a("meter","value min max low high optimum",o),a("details","open",[r,"summary"].join(" ")),a("keygen","autofocus challenge disabled form keytype name")),e!=="html5-strict"&&(i("script","language xml:space"),i("style","xml:space"),i("object","declare classid code codebase codetype archive standby align border hspace vspace"),i("embed","align name hspace vspace"),i("param","valuetype type"),i("a","charset name rev shape coords"),i("br","clear"),i("applet","codebase archive code object alt name width height align hspace vspace"),i("img","name longdesc align border hspace vspace"),i("iframe","longdesc frameborder marginwidth marginheight scrolling align"),i("font basefont","size color face"),i("input","usemap align"),i("select"),i("textarea"),i("h1 h2 h3 h4 h5 h6 div p legend caption","align"),i("ul","type compact"),i("li","type"),i("ol dl menu dir","compact"),i("pre","width xml:space"),i("hr","align noshade size width"),i("isindex","prompt"),i("table","summary width frame rules cellspacing cellpadding align bgcolor"),i("col","width align char charoff valign"),i("colgroup","width align char charoff valign"),i("thead","align char charoff valign"),i("tr","align char charoff valign bgcolor"),i("th","axis align char charoff valign nowrap bgcolor width height"),i("form","accept"),i("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),i("tfoot","align char charoff valign"),i("tbody","align char charoff valign"),i("area","nohref"),i("body","background bgcolor text link vlink alink")),e!=="html4"&&(i("input button select textarea","autofocus"),i("input textarea","placeholder"),i("a","download"),i("link script img","crossorigin"),i("img","loading"),i("iframe","sandbox seamless allow allowfullscreen loading")),e!=="html4"&&M([t.video,t.audio],l=>{delete l.children.audio,delete l.children.video}),Xt(Vt("a form meter progress dfn"),l=>{t[l]&&delete t[l].children[l]}),delete t.caption.children.table,delete t.script,Tl[e]=t,t},_f=(e,t)=>{if(e){const n={};return ce(e)&&(e={"*":e}),Xt(e,(s,o)=>{n[o]=n[o.toUpperCase()]=t==="map"?zr(s,/[, ]/):ub(s,/[, ]/)}),n}else return},po=(e={})=>{var t;const n={},s={};let o=[];const r={},a={},i=(he,Re,ft)=>{const We=e[he];if(We)return zr(We,/[, ]/,zr(We.toUpperCase(),/[, ]/));{let ot=Dl[he];return ot||(ot=fb(Re,ft),Dl[he]=ot),ot}},l=(t=e.schema)!==null&&t!==void 0?t:"html5",c=zT(l);e.verify_html===!1&&(e.valid_elements="*[*]");const f=_f(e.valid_styles),u=_f(e.invalid_styles,"map"),d=_f(e.valid_classes,"map"),v=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),E=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),h=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),C=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),w="td th iframe video audio object script code",_=i("non_empty_elements",w+" pre",h),x=i("move_caret_before_on_enter_elements",w+" table",h),N=i("text_block_elements","h1 h2 h3 h4 h5 h6 p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),I=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary",N),oe=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),F=i("transparent_elements","a ins del canvas map");Xt("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),he=>{a[he]=new RegExp("</"+he+"[^>]*>","gi")});const D=he=>new RegExp("^"+he.replace(/([?+*])/g,".$1")+"$"),O=he=>{const Re=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/,ft=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,We=/[*?+]/;if(he){const ot=Vt(he,",");let ct,Xe;n["@"]&&(ct=n["@"].attributes,Xe=n["@"].attributesOrder);for(let mt=0,Hn=ot.length;mt<Hn;mt++){let $t=Re.exec(ot[mt]);if($t){const ms=$t[1],Nn=$t[2],Cr=$t[3],Er=$t[5],ps={},es=[],gt={attributes:ps,attributesOrder:es};if(ms==="#"&&(gt.paddEmpty=!0),ms==="-"&&(gt.removeEmpty=!0),$t[4]==="!"&&(gt.removeEmptyAttrs=!0),ct&&(Je(ct,(Wn,gs)=>{ps[gs]=Wn}),Xe&&es.push(...Xe)),Er){const Wn=Vt(Er,"|");for(let gs=0,Vn=Wn.length;gs<Vn;gs++)if($t=ft.exec(Wn[gs]),$t){const qn={},Fs=$t[1],qt=$t[2].replace(/[\\:]:/g,":"),eo=$t[3],Ls=$t[4];if(Fs==="!"&&(gt.attributesRequired=gt.attributesRequired||[],gt.attributesRequired.push(qt),qn.required=!0),Fs==="-"){delete ps[qt],es.splice(UT(es,qt),1);continue}if(eo&&(eo==="="&&(gt.attributesDefault=gt.attributesDefault||[],gt.attributesDefault.push({name:qt,value:Ls}),qn.defaultValue=Ls),eo==="~"&&(gt.attributesForced=gt.attributesForced||[],gt.attributesForced.push({name:qt,value:Ls}),qn.forcedValue=Ls),eo==="<"&&(qn.validValues=zr(Ls,"?"))),We.test(qt)){const ts=qn;gt.attributePatterns=gt.attributePatterns||[],ts.pattern=D(qt),gt.attributePatterns.push(ts)}else ps[qt]||es.push(qt),ps[qt]=qn}}if(!ct&&Nn==="@"&&(ct=ps,Xe=es),Cr&&(gt.outputName=Nn,n[Cr]=gt),We.test(Nn)){const Wn=gt;Wn.pattern=D(Nn),o.push(Wn)}else n[Nn]=gt}}}},q=he=>{o=[],M(wn(n),Re=>{delete n[Re]}),O(he),Xt(c,(Re,ft)=>{s[ft]=Re.children})},K=he=>{const Re=/^(~)?(.+)$/;he&&(delete Dl.text_block_elements,delete Dl.block_elements,Xt(Vt(he,","),ft=>{const We=Re.exec(ft);if(We){const ot=We[1]==="~",ct=ot?"span":"div",Xe=We[2];if(s[Xe]=s[ct],r[Xe]=ct,_[Xe.toUpperCase()]={},_[Xe]={},ot||(I[Xe.toUpperCase()]={},I[Xe]={}),!n[Xe]){let mt=n[ct];mt=wf({},mt),delete mt.removeEmptyAttrs,delete mt.removeEmpty,n[Xe]=mt}Xt(s,(mt,Hn)=>{mt[ct]&&(s[Hn]=mt=wf({},s[Hn]),mt[Xe]=mt[ct])})}}))},ee=he=>{const Re=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;delete Tl[l],he&&Xt(Vt(he,","),ft=>{const We=Re.exec(ft);if(We){const ot=We[1];let ct;ot?ct=s[We[2]]:ct=s[We[2]]={"#comment":{}},ct=s[We[2]],Xt(Vt(We[3],"|"),Xe=>{ot==="-"?delete ct[Xe]:ct[Xe]={}})}})},ge=he=>{const Re=n[he];if(Re)return Re;let ft=o.length;for(;ft--;){const We=o[ft];if(We.pattern.test(he))return We}};e.valid_elements?q(e.valid_elements):(Xt(c,(he,Re)=>{n[Re]={attributes:he.attributes,attributesOrder:he.attributesOrder},s[Re]=he.children}),Xt(Vt("strong/b em/i"),he=>{const Re=Vt(he,"/");n[Re[1]].outputName=Re[0]}),Xt(oe,(he,Re)=>{n[Re]&&(e.padd_empty_block_inline_children&&(n[Re].paddInEmptyBlock=!0),n[Re].removeEmpty=!0)}),Xt(Vt("ol ul blockquote a table tbody"),he=>{n[he]&&(n[he].removeEmpty=!0)}),Xt(Vt("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),he=>{n[he]&&(n[he].paddEmpty=!0)}),Xt(Vt("span"),he=>{n[he].removeEmptyAttrs=!0})),K(e.custom_elements),ee(e.valid_children),O(e.extended_valid_elements),ee("+ol[ul|ol],+ul[ul|ol]"),Xt({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(he,Re)=>{n[Re]&&(n[Re].parentsRequired=Vt(he))}),e.invalid_elements&&Xt(ub(e.invalid_elements),he=>{n[he]&&delete n[he]}),ge("span")||O("span[!data-mce-type|*]");const me=Y(f),Ne=Y(u),Ie=Y(d),it=Y(C),Lt=Y(I),yt=Y(N),H=Y(oe),re=Y(Object.seal(h)),Ae=Y(E),xe=Y(_),ae=Y(x),le=Y(v),U=Y(F),pe=Y(Object.seal(a)),_e=(he,Re)=>{const ft=s[he.toLowerCase()];return!!(ft&&ft[Re.toLowerCase()])},Me=(he,Re)=>{const ft=ge(he);if(ft)if(Re){if(ft.attributes[Re])return!0;const We=ft.attributePatterns;if(We){let ot=We.length;for(;ot--;)if(We[ot].pattern.test(Re))return!0}}else return!0;return!1},je=Y(r);return{type:l,children:s,elements:n,getValidStyles:me,getValidClasses:Ie,getBlockElements:Lt,getInvalidStyles:Ne,getVoidElements:re,getTextBlockElements:yt,getTextInlineElements:H,getBoolAttrs:it,getElementRule:ge,getSelfClosingElements:Ae,getNonEmptyElements:xe,getMoveCaretBeforeOnEnterElements:ae,getWhitespaceElements:le,getTransparentElements:U,getSpecialElements:pe,isValidChild:_e,isValid:Me,getCustomElements:je,addValidElements:O,setValidElements:q,addCustomElements:K,addValidChildren:ee}},xf=(e={},t)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/,r={};let a,i;const l=$r;t&&(a=t.getValidStyles(),i=t.getInvalidStyles());const c=(`\\" \\' \\; \\: ; : `+l).split(" ");for(let u=0;u<c.length;u++)r[c[u]]=l+u,r[l+u]=c[u];const f={parse:u=>{const d={};let v=!1;const E=e.url_converter,h=e.url_converter_scope||f,C=(D,O,q)=>{const K=d[D+"-top"+O];if(!K)return;const ee=d[D+"-right"+O];if(!ee)return;const ge=d[D+"-bottom"+O];if(!ge)return;const me=d[D+"-left"+O];if(!me)return;const Ne=[K,ee,ge,me];let Ie=Ne.length-1;for(;Ie--&&Ne[Ie]===Ne[Ie+1];);Ie>-1&&q||(d[D+O]=Ie===-1?Ne[0]:Ne.join(" "),delete d[D+"-top"+O],delete d[D+"-right"+O],delete d[D+"-bottom"+O],delete d[D+"-left"+O])},w=D=>{const O=d[D];if(!O)return;const q=O.split(" ");let K=q.length;for(;K--;)if(q[K]!==q[0])return!1;return d[D]=q[0],!0},_=(D,O,q,K)=>{w(O)&&w(q)&&w(K)&&(d[D]=d[O]+" "+d[q]+" "+d[K],delete d[O],delete d[q],delete d[K])},x=D=>(v=!0,r[D]),N=(D,O)=>(v&&(D=D.replace(/\uFEFF[0-9]/g,q=>r[q])),O||(D=D.replace(/\\([\'\";:])/g,"$1")),D),I=D=>String.fromCharCode(parseInt(D.slice(1),16)),oe=D=>D.replace(/\\[0-9a-f]+/gi,I),F=(D,O,q,K,ee,ge)=>{if(ee=ee||ge,ee)return ee=N(ee),"'"+ee.replace(/\'/g,"\\'")+"'";if(O=N(O||q||K||""),!e.allow_script_urls){const me=O.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(me)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(me))return""}return E&&(O=E.call(h,O,"style")),"url('"+O.replace(/\'/g,"\\'")+"')"};if(u){u=u.replace(/[\u0000-\u001F]/g,""),u=u.replace(/\\[\"\';:\uFEFF]/g,x).replace(/\"[^\"]+\"|\'[^\']+\'/g,O=>O.replace(/[;:]/g,x));let D;for(;D=s.exec(u);){s.lastIndex=D.index+D[0].length;let O=D[1].replace(o,"").toLowerCase(),q=D[2].replace(o,"");if(O&&q){if(O=oe(O),q=oe(q),O.indexOf(l)!==-1||O.indexOf('"')!==-1||!e.allow_script_urls&&(O==="behavior"||/expression\s*\(|\/\*|\*\//.test(q)))continue;O==="font-weight"&&q==="700"?q="bold":(O==="color"||O==="background-color")&&(q=q.toLowerCase()),q=q.replace(n,F),d[O]=v?N(q,!0):q}}C("border","",!0),C("border","-width"),C("border","-color"),C("border","-style"),C("padding",""),C("margin",""),_("border","border-width","border-style","border-color"),d.border==="medium none"&&delete d.border,d["border-image"]==="none"&&delete d["border-image"]}return d},serialize:(u,d)=>{let v="";const E=(C,w)=>{const _=w[C];if(_)for(let x=0,N=_.length;x<N;x++){const I=_[x],oe=u[I];oe&&(v+=(v.length>0?" ":"")+I+": "+oe+";")}},h=(C,w)=>{if(!i||!w)return!0;let _=i["*"];return _&&_[C]?!1:(_=i[w],!(_&&_[C]))};return d&&a?(E("*",a),E(d,a)):Je(u,(C,w)=>{C&&h(w,d)&&(v+=(v.length>0?" ":"")+w+": "+C+";")}),v}};return f},HT={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},WT=e=>e instanceof Event||Be(e.initEvent),VT=e=>e.isDefaultPrevented===St||e.isDefaultPrevented===lt,qT=e=>rt(e.preventDefault)||WT(e),mb=(e,t)=>{const n=t??{};for(const s in e)Se(HT,s)||(n[s]=e[s]);return G(e.composedPath)&&(n.composedPath=()=>e.composedPath()),n},kf=(e,t,n,s)=>{var o;const r=mb(t,s);return r.type=e,rt(r.target)&&(r.target=(o=r.srcElement)!==null&&o!==void 0?o:n),qT(t)&&(r.preventDefault=()=>{r.defaultPrevented=!0,r.isDefaultPrevented=St,Be(t.preventDefault)&&t.preventDefault()},r.stopPropagation=()=>{r.cancelBubble=!0,r.isPropagationStopped=St,Be(t.stopPropagation)&&t.stopPropagation()},r.stopImmediatePropagation=()=>{r.isImmediatePropagationStopped=St,r.stopPropagation()},VT(r)||(r.isDefaultPrevented=r.defaultPrevented===!0?St:lt,r.isPropagationStopped=r.cancelBubble===!0?St:lt,r.isImmediatePropagationStopped=lt)),r},jT="mce-data-",KT=/^(?:mouse|contextmenu)|click/,Nf=(e,t,n,s)=>{e.addEventListener(t,n,s||!1)},Rl=(e,t,n,s)=>{e.removeEventListener(t,n,s||!1)},GT=e=>G(e)&&KT.test(e.type),Va=(e,t)=>{const n=kf(e.type,e,document,t);if(GT(e)&&Ye(e.pageX)&&!Ye(e.clientX)){const s=n.target.ownerDocument||document,o=s.documentElement,r=s.body,a=n;a.pageX=e.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),a.pageY=e.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)}return n},YT=(e,t,n)=>{const s=e.document,o={type:"ready"};if(n.domLoaded){t(o);return}const r=()=>s.readyState==="complete"||s.readyState==="interactive"&&s.body,a=()=>{Rl(e,"DOMContentLoaded",a),Rl(e,"load",a),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};r()?a():Nf(e,"DOMContentLoaded",a),n.domLoaded||Nf(e,"load",a)};class Go{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando=jT+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,n,s,o){const r=this;let a;const i=window,l=d=>{r.executeHandlers(Va(d||i.event),c)};if(!t||z(t)||lo(t))return s;let c;t[r.expando]?c=t[r.expando]:(c=r.count++,t[r.expando]=c,r.events[c]={}),o=o||t;const f=n.split(" ");let u=f.length;for(;u--;){let d=f[u],v=l,E=!1,h=!1;if(d==="DOMContentLoaded"&&(d="ready"),r.domLoaded&&d==="ready"&&t.readyState==="complete"){s.call(o,Va({type:d}));continue}!r.hasFocusIn&&(d==="focusin"||d==="focusout")&&(E=!0,h=d==="focusin"?"focus":"blur",v=C=>{const w=Va(C||i.event);w.type=w.type==="focus"?"focusin":"focusout",r.executeHandlers(w,c)}),a=r.events[c][d],a?d==="ready"&&r.domLoaded?s(Va({type:d})):a.push({func:s,scope:o}):(r.events[c][d]=a=[{func:s,scope:o}],a.fakeName=h,a.capture=E,a.nativeHandler=v,d==="ready"?YT(t,v,r):Nf(t,h||d,v,E))}return t=a=null,s}unbind(t,n,s){if(!t||z(t)||lo(t))return this;const o=t[this.expando];if(o){let r=this.events[o];if(n){const a=n.split(" ");let i=a.length;for(;i--;){const l=a[i],c=r[l];if(c){if(s){let f=c.length;for(;f--;)if(c[f].func===s){const u=c.nativeHandler,d=c.fakeName,v=c.capture,E=c.slice(0,f).concat(c.slice(f+1));E.nativeHandler=u,E.fakeName=d,E.capture=v,r[l]=E}}(!s||c.length===0)&&(delete r[l],Rl(t,c.fakeName||l,c.nativeHandler,c.capture))}}}else Je(r,(a,i)=>{Rl(t,a.fakeName||i,a.nativeHandler,a.capture)}),r={};for(const a in r)if(Se(r,a))return this;delete this.events[o];try{delete t[this.expando]}catch{t[this.expando]=null}}return this}fire(t,n,s){return this.dispatch(t,n,s)}dispatch(t,n,s){if(!t||z(t)||lo(t))return this;const o=Va({type:n,target:t},s);do{const r=t[this.expando];r&&this.executeHandlers(o,r),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!o.isPropagationStopped());return this}clean(t){if(!t||z(t)||lo(t))return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName){this.unbind(t);const n=t.getElementsByTagName("*");let s=n.length;for(;s--;)t=n[s],t[this.expando]&&this.unbind(t)}return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,n){const s=this.events[n],o=s&&s[t.type];if(o)for(let r=0,a=o.length;r<a;r++){const i=o[r];if(i&&i.func.call(i.scope,t)===!1&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}Go.Event=new Go;const Af=V.each,XT=V.grep,Tf="data-mce-style",ZT=V.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),qa=(e,t,n)=>{rt(n)||n===""?zt(e,t):It(e,t,n)},pb=e=>e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),Hr=(e,t)=>{let n=0;if(e)for(let s=e.nodeType,o=e.previousSibling;o;o=o.previousSibling){const r=o.nodeType;t&&z(o)&&(r===s||!o.data.length)||(n++,s=r)}return n},gb=(e,t)=>{const n=Pn(t,"style"),s=e.serialize(e.parse(n),et(t));qa(t,Tf,s)},QT=(e,t)=>Tt(e)?Se(ZT,t)?e+"":e+"px":e,hb=(e,t,n)=>{const s=pb(t);rt(n)||n===""?Ah(e,s):xh(e,s,QT(n,s))},JT=(e,t,n)=>{const s=t.keep_values,o={set:(a,i,l)=>{const c=S.fromDom(a);Be(t.url_converter)&&G(i)&&(i=t.url_converter.call(t.url_converter_scope||n(),String(i),l,a));const f="data-mce-"+l;qa(c,f,i),qa(c,l,i)},get:(a,i)=>{const l=S.fromDom(a);return Pn(l,"data-mce-"+i)||Pn(l,i)}},r={style:{set:(a,i)=>{const l=S.fromDom(a);s&&qa(l,Tf,i),zt(l,"style"),ce(i)&&fl(l,e.parse(i))},get:a=>{const i=S.fromDom(a),l=Pn(i,Tf)||Pn(i,"style");return e.serialize(e.parse(l),et(i))}}};return s&&(r.href=r.src=o),r},qe=(e,t={})=>{const n={},s=window,o={};let r=0;const a=!0,i=!0,l=ob.forElement(S.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),c=[],f=t.schema?t.schema:po({}),u=xf({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),d=t.ownEvents?new Go:Go.Event,v=f.getBlockElements(),E=A=>ce(A)?Se(v,A):Q(A)&&(Se(v,A.nodeName)||jo(f,A)),h=A=>A&&e&&ce(A)?e.getElementById(A):A,C=A=>{const T=h(A);return G(T)?S.fromDom(T):null},w=(A,T,W="")=>{let $;const de=C(A);if(G(de)&&bn(de)){const ke=ga[T];ke&&ke.get?$=ke.get(de.dom,T):$=Pn(de,T)}return G($)?$:W},_=A=>{const T=h(A);return rt(T)?[]:T.attributes},x=(A,T,W)=>{re(A,$=>{if(Q($)){const de=S.fromDom($),ke=W===""?null:W,Ke=Pn(de,T),Nt=ga[T];Nt&&Nt.set?Nt.set(de.dom,ke,T):qa(de,T,ke),Ke!==ke&&t.onSetAttrib&&t.onSetAttrib({attrElm:de.dom,attrName:T,attrValue:ke})}})},N=(A,T)=>A.cloneNode(T),I=()=>t.root_element||e.body,oe=A=>{const T=Ih(A);return{x:T.x,y:T.y,w:T.width,h:T.height}},F=(A,T)=>kT(e.body,h(A),T),D=(A,T,W)=>{re(A,$=>{const de=S.fromDom($);hb(de,T,W),t.update_styles&&gb(u,de)})},O=(A,T)=>{re(A,W=>{const $=S.fromDom(W);Je(T,(de,ke)=>{hb($,ke,de)}),t.update_styles&&gb(u,$)})},q=(A,T,W)=>{const $=h(A);if(!(rt($)||!Q($)))return W?_s(S.fromDom($),pb(T)):(T=T.replace(/-(\D)/g,(de,ke)=>ke.toUpperCase()),T==="float"&&(T="cssFloat"),$.style?$.style[T]:void 0)},K=A=>{const T=h(A);if(!T)return{w:0,h:0};let W=q(T,"width"),$=q(T,"height");return(!W||W.indexOf("px")===-1)&&(W="0"),(!$||$.indexOf("px")===-1)&&($="0"),{w:parseInt(W,10)||T.offsetWidth||T.clientWidth,h:parseInt($,10)||T.offsetHeight||T.clientHeight}},ee=A=>{const T=h(A),W=F(T),$=K(T);return{x:W.x,y:W.y,w:$.w,h:$.h}},ge=(A,T)=>{if(!A)return!1;const W=Ge(A)?A:[A];return ht(W,$=>ss(S.fromDom($),T))},me=(A,T,W,$)=>{const de=[];let ke=h(A);$=$===void 0;const Ke=W||(I().nodeName!=="BODY"?I().parentNode:null);if(ce(T))if(T==="*")T=Q;else{const Nt=T;T=Ot=>ge(Ot,Nt)}for(;ke&&!(ke===Ke||rt(ke.nodeType)||Ua(ke)||lf(ke));){if(!T||T(ke))if($)de.push(ke);else return[ke];ke=ke.parentNode}return $?de:null},Ne=(A,T,W)=>{const $=me(A,T,W,!1);return $&&$.length>0?$[0]:null},Ie=(A,T,W)=>{let $=T;if(A){ce(T)&&($=de=>ge(de,T));for(let de=A[W];de;de=de[W])if(Be($)&&$(de))return de}return null},it=(A,T)=>Ie(A,T,"nextSibling"),Lt=(A,T)=>Ie(A,T,"previousSibling"),yt=A=>Be(A.querySelectorAll),H=(A,T)=>{var W,$;const de=($=(W=h(T))!==null&&W!==void 0?W:t.root_element)!==null&&$!==void 0?$:e;return yt(de)?rn(de.querySelectorAll(A)):[]},re=function(A,T,W){const $=W??this;if(Ge(A)){const de=[];return Af(A,(ke,Ke)=>{const Nt=h(ke);Nt&&de.push(T.call($,Nt,Ke))}),de}else{const de=h(A);return de?T.call($,de):!1}},Ae=(A,T)=>{re(A,W=>{Je(T,($,de)=>{x(W,de,$)})})},xe=(A,T)=>{re(A,W=>{const $=S.fromDom(W);ml($,T)})},ae=(A,T,W,$,de)=>re(A,ke=>{const Ke=ce(T)?e.createElement(T):T;return G(W)&&Ae(Ke,W),$&&(!ce($)&&$.nodeType?Ke.appendChild($):ce($)&&xe(Ke,$)),de?Ke:ke.appendChild(Ke)}),le=(A,T,W)=>ae(e.createElement(A),A,T,W,!0),U=mo.decode,pe=mo.encodeAllRaw,_e=(A,T,W="")=>{let $="<"+A;for(const de in T)Nr(T,de)&&($+=" "+de+'="'+pe(T[de])+'"');return Da(W)&&Se(f.getVoidElements(),A)?$+" />":$+">"+W+"</"+A+">"},Me=A=>{const T=e.createElement("div"),W=e.createDocumentFragment();W.appendChild(T),A&&(T.innerHTML=A);let $;for(;$=T.firstChild;)W.appendChild($);return W.removeChild(T),W},je=(A,T)=>re(A,W=>{const $=S.fromDom(W);return T&&M(Ht($),de=>{Rn(de)&&de.dom.length===0?at(de):_n($,de)}),at($),$.dom}),he=A=>re(A,T=>{const W=T.attributes;for(let $=W.length-1;$>=0;$--)T.removeAttributeNode(W.item($))}),Re=A=>u.parse(A),ft=(A,T)=>u.serialize(A,T),We=A=>{if(hs!==qe.DOM&&e===document){if(n[A])return;n[A]=!0}let T=e.getElementById("mceDefaultStyles");if(!T){T=e.createElement("style"),T.id="mceDefaultStyles",T.type="text/css";const W=e.head;W.firstChild?W.insertBefore(T,W.firstChild):W.appendChild(T)}T.styleSheet?T.styleSheet.cssText+=A:T.appendChild(e.createTextNode(A))},ot=A=>{A||(A=""),M(A.split(","),T=>{o[T]=!0,l.load(T).catch(Ee)})},ct=(A,T,W)=>{re(A,$=>{if(Q($)){const de=S.fromDom($),ke=T.split(" ");M(ke,Ke=>{G(W)?(W?Rr:Pr)(de,Ke):MN(de,Ke)})}})},Xe=(A,T)=>{ct(A,T,!0)},mt=(A,T)=>{ct(A,T,!1)},Hn=(A,T)=>{const W=C(A),$=T.split(" ");return G(W)&&oo($,de=>Xu(W,de))},$t=A=>{re(A,T=>Ah(S.fromDom(T),"display"))},ms=A=>{re(A,T=>xh(S.fromDom(T),"display","none"))},Nn=A=>{const T=C(A);return G(T)&&Tr(dl(T,"display"),"none")},Cr=A=>(A||"mce_")+r++,Er=A=>{const T=C(A);return G(T)?Q(T.dom)?T.dom.outerHTML:cA(T):""},ps=(A,T)=>{re(A,W=>{Q(W)&&(W.outerHTML=T)})},es=(A,T)=>{const W=h(T);return re(A,$=>{const de=W==null?void 0:W.parentNode,ke=W==null?void 0:W.nextSibling;return de&&(ke?de.insertBefore($,ke):de.appendChild($)),$})},gt=(A,T,W)=>re(T,$=>{var de;const ke=Ge(T)?A.cloneNode(!0):A;return W&&Af(XT($.childNodes),Ke=>{ke.appendChild(Ke)}),(de=$.parentNode)===null||de===void 0||de.replaceChild(ke,$),$}),Wn=(A,T)=>{if(A.nodeName!==T.toUpperCase()){const W=le(T);return Af(_(A),$=>{x(W,$.nodeName,w(A,$.nodeName))}),gt(W,A,!0),W}else return A},gs=(A,T)=>{let W=A;for(;W;){let $=T;for(;$&&W!==$;)$=$.parentNode;if(W===$)break;W=W.parentNode}return!W&&A.ownerDocument?A.ownerDocument.documentElement:W},Vn=A=>{if(Q(A)){const T=A.nodeName.toLowerCase()==="a"&&!w(A,"href")&&w(A,"id");if(w(A,"name")||w(A,"data-mce-bookmark")||T)return!0}return!1},qn=(A,T,W)=>{let $=0;if(Vn(A))return!1;const de=A.firstChild;if(de){const ke=new xt(de,A),Ke=f?f.getWhitespaceElements():{},Nt=T||(f?f.getNonEmptyElements():null);let Ot=de;do{if(Q(Ot)){const Vi=Ot.getAttribute("data-mce-bogus");if(Vi){Ot=ke.next(Vi==="all");continue}const qi=Ot.nodeName.toLowerCase();if(Nt&&Nt[qi]){if(qi==="br"){$++,Ot=ke.next();continue}return!1}if(Vn(Ot))return!1}if(lo(Ot)||z(Ot)&&!qo(Ot.data)&&(!(W!=null&&W.includeZwsp)||!aT(Ot.data))||z(Ot)&&Ot.parentNode&&Ke[Ot.parentNode.nodeName]&&qo(Ot.data))return!1;Ot=ke.next()}while(Ot)}return $<=1},Fs=()=>e.createRange(),qt=(A,T,W)=>{let $=Fs(),de,ke;if(A&&T&&A.parentNode&&T.parentNode){const Ke=A.parentNode;return $.setStart(Ke,Hr(A)),$.setEnd(T.parentNode,Hr(T)),de=$.extractContents(),$=Fs(),$.setStart(T.parentNode,Hr(T)+1),$.setEnd(Ke,Hr(A)+1),ke=$.extractContents(),Ke.insertBefore(Cf(hs,de),A),W?Ke.insertBefore(W,A):Ke.insertBefore(T,A),Ke.insertBefore(Cf(hs,ke),A),je(A),W||T}else return},eo=(A,T,W,$)=>{if(Ge(A)){let de=A.length;const ke=[];for(;de--;)ke[de]=eo(A[de],T,W,$);return ke}else return t.collect&&(A===e||A===s)&&c.push([A,T,W,$]),d.bind(A,T,W,$||hs)},Ls=(A,T,W)=>{if(Ge(A)){let $=A.length;const de=[];for(;$--;)de[$]=Ls(A[$],T,W);return de}else{if(c.length>0&&(A===e||A===s)){let $=c.length;for(;$--;){const[de,ke,Ke]=c[$];A===de&&(!T||T===ke)&&(!W||W===Ke)&&d.unbind(de,ke,Ke)}}return d.unbind(A,T,W)}},ts=(A,T,W)=>d.dispatch(A,T,W),Ao=(A,T,W)=>d.dispatch(A,T,W),hu=A=>{if(A&&Q(A)){const T=A.getAttribute("data-mce-contenteditable");return T&&T!=="inherit"?T:A.contentEditable!=="inherit"?A.contentEditable:null}else return null},hs={doc:e,settings:t,win:s,files:o,stdMode:a,boxModel:i,styleSheetLoader:l,boundEvents:c,styles:u,schema:f,events:d,isBlock:E,root:null,clone:N,getRoot:I,getViewPort:oe,getRect:ee,getSize:K,getParent:Ne,getParents:me,get:h,getNext:it,getPrev:Lt,select:H,is:ge,add:ae,create:le,createHTML:_e,createFragment:Me,remove:je,setStyle:D,getStyle:q,setStyles:O,removeAllAttribs:he,setAttrib:x,setAttribs:Ae,getAttrib:w,getPos:F,parseStyle:Re,serializeStyle:ft,addStyle:We,loadCSS:ot,addClass:Xe,removeClass:mt,hasClass:Hn,toggleClass:ct,show:$t,hide:ms,isHidden:Nn,uniqueId:Cr,setHTML:xe,getOuterHTML:Er,setOuterHTML:ps,decode:U,encode:pe,insertAfter:es,replace:gt,rename:Wn,findCommonAncestor:gs,run:re,getAttribs:_,isEmpty:qn,createRng:Fs,nodeIndex:Hr,split:qt,bind:eo,unbind:Ls,fire:Ao,dispatch:ts,getContentEditable:hu,getContentEditableParent:A=>{const T=I();let W=null;for(let $=A;$&&$!==T&&(W=hu($),W===null);$=$.parentNode);return W},isEditable:A=>{if(G(A)){const T=Q(A)?A:A.parentElement;return G(T)&&Ir(S.fromDom(T))}else return!1},destroy:()=>{if(c.length>0){let A=c.length;for(;A--;){const[T,W,$]=c[A];d.unbind(T,W,$)}}Je(o,(A,T)=>{l.unload(T),delete o[T]})},isChildOf:(A,T)=>A===T||T.contains(A),dumpRng:A=>"startContainer: "+A.startContainer.nodeName+", startOffset: "+A.startOffset+", endContainer: "+A.endContainer.nodeName+", endOffset: "+A.endOffset},ga=JT(u,t,Y(hs));return hs};qe.DOM=qe(document),qe.nodeIndex=Hr;const eD=qe.DOM,tD=0,nD=1,Pl=2,bb=3;class Ys{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((n,s)=>{const o=eD;let r;const a=()=>{o.remove(c),r&&(r.onerror=r.onload=r=null)},i=()=>{a(),n()},l=()=>{a(),s("Failed to load script: "+t)},c=o.uniqueId();r=document.createElement("script"),r.id=c,r.type="text/javascript",r.src=V._addCacheSuffix(t),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=i,r.onerror=l,(document.getElementsByTagName("head")[0]||document.body).appendChild(r)})}isDone(t){return this.states[t]===Pl}markDone(t){this.states[t]=Pl}add(t){const n=this;return n.queue.push(t),n.states[t]===void 0&&(n.states[t]=tD),new Promise((o,r)=>{n.scriptLoadedCallbacks[t]||(n.scriptLoadedCallbacks[t]=[]),n.scriptLoadedCallbacks[t].push({resolve:o,reject:r})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){const t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){const n=this,s=(l,c)=>{st(n.scriptLoadedCallbacks,c).each(f=>{M(f,u=>u[l](c))}),delete n.scriptLoadedCallbacks[c]},o=l=>{const c=ve(l,f=>f.status==="rejected");return c.length>0?Promise.reject(ys(c,({reason:f})=>Ge(f)?f:[f])):Promise.resolve()},r=l=>Promise.allSettled(Ue(l,c=>n.states[c]===Pl?(s("resolve",c),Promise.resolve()):n.states[c]===bb?(s("reject",c),Promise.reject(c)):(n.states[c]=nD,n.loadScript(c).then(()=>{n.states[c]=Pl,s("resolve",c);const f=n.queue;return f.length>0?(n.queue=[],r(f).then(o)):Promise.resolve()},()=>(n.states[c]=bb,s("reject",c),Promise.reject(c)))))),a=l=>(n.loading=!0,r(l).then(c=>{n.loading=!1;const f=n.queueLoadedCallbacks.shift();return m.from(f).each(Sa),o(c)})),i=Ag(t);return n.loading?new Promise((l,c)=>{n.queueLoadedCallbacks.push(()=>{a(i).then(l,c)})}):a(i)}}Ys.ScriptLoader=new Ys;const Rt=e=>{let t=e;return{get:()=>t,set:o=>{t=o}}},sD=e=>Qe(e)&&Se(e,"raw"),oD=e=>Ge(e)&&e.length>1,ja={},Df=Rt("en"),vb=()=>st(ja,Df.get()),as={getData:()=>rl(ja,e=>({...e})),setCode:e=>{e&&Df.set(e)},getCode:()=>Df.get(),add:(e,t)=>{let n=ja[e];n||(ja[e]=n={}),Je(t,(s,o)=>{n[o.toLowerCase()]=s})},translate:e=>{const t=vb().getOr({}),n=a=>Be(a)?Object.prototype.toString.call(a):s(a)?"":""+a,s=a=>a===""||a===null||a===void 0,o=a=>{const i=n(a);return st(t,i.toLowerCase()).map(n).getOr(i)},r=a=>a.replace(/{context:\w+}$/,"");if(s(e))return"";if(sD(e))return n(e.raw);if(oD(e)){const a=e.slice(1),i=o(e[0]).replace(/\{([0-9]+)\}/g,(l,c)=>Se(a,c)?n(a[c]):l);return r(i)}return r(o(e))},isRtl:()=>vb().bind(e=>st(e,"_dir")).exists(e=>e==="rtl"),hasCode:e=>Se(ja,e)},Zt=()=>{const e=[],t={},n={},s=[],o=(h,C)=>{const w=ve(s,_=>_.name===h&&_.state===C);M(w,_=>_.resolve())},r=h=>Se(t,h),a=h=>Se(n,h),i=h=>{if(n[h])return n[h].instance},l=(h,C)=>{const w=as.getCode(),_=","+(C||"")+",";!w||C&&_.indexOf(","+w+",")===-1||Ys.ScriptLoader.add(t[h]+"/langs/"+w+".js")},c=(h,C)=>{Zt.languageLoad!==!1&&(r(h)?l(h,C):E(h,"loaded").then(()=>l(h,C)))},f=(h,C)=>(e.push(C),n[h]={instance:C},o(h,"added"),C),u=h=>{delete t[h],delete n[h]},d=(h,C)=>ce(C)?ce(h)?{prefix:"",resource:C,suffix:""}:{prefix:h.prefix,resource:C,suffix:h.suffix}:C,v=(h,C)=>{if(t[h])return Promise.resolve();let w=ce(C)?C:C.prefix+C.resource+C.suffix;w.indexOf("/")!==0&&w.indexOf("://")===-1&&(w=Zt.baseURL+"/"+w),t[h]=w.substring(0,w.lastIndexOf("/"));const _=()=>(o(h,"loaded"),Promise.resolve());return n[h]?_():Ys.ScriptLoader.add(w).then(_)},E=(h,C="added")=>C==="added"&&a(h)||C==="loaded"&&r(h)?Promise.resolve():new Promise(w=>{s.push({name:h,state:C,resolve:w})});return{items:e,urls:t,lookup:n,get:i,requireLangPack:c,add:f,remove:u,createUrl:d,load:v,waitFor:E}};Zt.languageLoad=!0,Zt.baseURL="",Zt.PluginManager=Zt(),Zt.ThemeManager=Zt(),Zt.ModelManager=Zt();const rD=e=>{const t=Rt(m.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(i))}}},aD=e=>{const t=Rt(m.none()),n=()=>t.get().each(i=>clearInterval(i));return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(setInterval(i,e)))}}},go=()=>{const e=rD(Ee);return{...e,on:n=>e.get().each(n)}},Ol=(e,t)=>{let n=null;return{cancel:()=>{Et(n)||(clearTimeout(n),n=null)},throttle:(...r)=>{Et(n)&&(n=setTimeout(()=>{n=null,e.apply(null,r)},t))}}},Rf=(e,t)=>{let n=null;const s=()=>{Et(n)||(clearTimeout(n),n=null)};return{cancel:s,throttle:(...r)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,r)},t)}}},Ka=Y("mce-annotation"),Yo=Y("data-mce-annotation"),Wr=Y("data-mce-annotation-uid"),Ga=Y("data-mce-annotation-active"),Ya=Y("data-mce-annotation-classes"),Xa=Y("data-mce-annotation-attrs"),yb=e=>t=>ze(t,e),Cb=(e,t)=>{const n=e.selection.getRng(),s=S.fromDom(n.startContainer),o=S.fromDom(e.getBody()),r=t.fold(()=>"."+Ka(),l=>`[${Yo()}="${l}"]`),a=Or(s,n.startOffset).getOr(s);return Uo(a,r,yb(o)).bind(l=>Hs(l,`${Wr()}`).bind(c=>Hs(l,`${Yo()}`).map(f=>{const u=Sb(e,c);return{uid:c,name:f,elements:u}})))},iD=e=>bn(e)&&Xu(e,Ka()),Eb=(e,t)=>ul(e,"data-mce-bogus")||Lh(e,'[data-mce-bogus="all"]',yb(t)),Sb=(e,t)=>{const n=S.fromDom(e.getBody()),s=Yt(n,`[${Wr()}="${t}"]`);return ve(s,o=>!Eb(o,n))},wb=(e,t)=>{const n=S.fromDom(e.getBody()),s=Yt(n,`[${Yo()}="${t}"]`),o={};return M(s,r=>{if(!Eb(r,n)){const a=Pn(r,Wr()),i=st(o,a).getOr([]);o[a]=i.concat([r])}}),o},lD=(e,t)=>{const n=Rt({}),s=()=>({listeners:[],previous:go()}),o=(u,d)=>{r(u,v=>(d(v),v))},r=(u,d)=>{const v=n.get(),E=st(v,u).getOrThunk(s),h=d(E);v[u]=h,n.set(v)},a=(u,d,v)=>{o(u,E=>{M(E.listeners,h=>h(!0,u,{uid:d,nodes:Ue(v,C=>C.dom)}))})},i=u=>{o(u,d=>{M(d.listeners,v=>v(!1,u))})},l=(u,d)=>{M(Sb(e,u),v=>{d?It(v,Ga(),"true"):zt(v,Ga())})},c=Rf(()=>{const u=Oo(t.getNames());M(u,d=>{r(d,v=>{const E=v.previous.get();return Cb(e,m.some(d)).fold(()=>{E.each(h=>{i(d),v.previous.clear(),l(h,!1)})},({uid:h,name:C,elements:w})=>{Tr(E,h)||(E.each(_=>l(_,!1)),a(C,h,w),v.previous.set(h),l(h,!0))}),{previous:v.previous,listeners:v.listeners}})})},30);return e.on("remove",()=>{c.cancel()}),e.on("NodeChange",()=>{c.throttle()}),{addListener:(u,d)=>{r(u,v=>({previous:v.previous,listeners:v.listeners.concat([d])}))}}},cD=(e,t)=>{const n=Yo(),s=r=>m.from(r.attr(n)).bind(t.lookup),o=r=>{var a,i;r.attr(Wr(),null),r.attr(Yo(),null),r.attr(Ga(),null);const l=m.from(r.attr(Xa())).map(d=>d.split(",")).getOr([]),c=m.from(r.attr(Ya())).map(d=>d.split(",")).getOr([]);M(l,d=>r.attr(d,null));const f=(i=(a=r.attr("class"))===null||a===void 0?void 0:a.split(" "))!==null&&i!==void 0?i:[],u=sl(f,[Ka()].concat(c));r.attr("class",u.length>0?u.join(" "):null),r.attr(Ya(),null),r.attr(Xa(),null)};e.serializer.addTempAttr(Ga()),e.serializer.addAttributeFilter(n,r=>{for(const a of r)s(a).each(i=>{i.persistent===!1&&(a.name==="span"?a.unwrap():o(a))})})},uD=()=>{const e={};return{register:(o,r)=>{e[o]={name:o,settings:r}},lookup:o=>st(e,o).map(r=>r.settings),getNames:()=>wn(e)}};let _b=0;const Za=e=>{const n=new Date().getTime(),s=Math.floor(Math.random()*1e9);return _b++,e+"_"+s+_b+String(n)},fD=(e,t)=>{M(t,n=>{Rr(e,n)})},dD=(e,t)=>{M(t,n=>{Pr(e,n)})},xb=(e,t)=>S.fromDom(e.dom.cloneNode(t)),Xo=e=>xb(e,!1),kb=e=>xb(e,!0),mD=(e,t)=>{const n=S.fromTag(t),s=uh(e);return ro(n,s),n},Nb=(e,t)=>{const n=mD(e,t);io(e,n);const s=Ht(e);return zo(n,s),at(e),n},Ab=(e,t,n=lt)=>{const s=new xt(e,t),o=r=>{let a;do a=s[r]();while(a&&!z(a)&&!n(a));return m.from(a).filter(z)};return{current:()=>m.from(s.current()).filter(z),next:()=>o("next"),prev:()=>o("prev"),prev2:()=>o("prev2")}},Zo=(e,t)=>{const n=t||(a=>e.isBlock(a)||dt(a)||tt(a)),s=(a,i,l,c)=>{if(z(a)){const f=c(a,i,a.data);if(f!==-1)return m.some({container:a,offset:f})}return l().bind(f=>s(f.container,f.offset,l,c))};return{backwards:(a,i,l,c)=>{const f=Ab(a,c??e.getRoot(),n);return s(a,i,()=>f.prev().map(u=>({container:u,offset:u.length})),l).getOrNull()},forwards:(a,i,l,c)=>{const f=Ab(a,c??e.getRoot(),n);return s(a,i,()=>f.next().map(u=>({container:u,offset:0})),l).getOrNull()}}},Vr=Math.round,Qo=e=>e?{left:Vr(e.left),top:Vr(e.top),bottom:Vr(e.bottom),right:Vr(e.right),width:Vr(e.width),height:Vr(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},Tb=(e,t)=>(e=Qo(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),pD=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,Db=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,Qa=(e,t)=>{const n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top?!0:e.top>t.bottom?!1:Db(t.top-e.bottom,e,t)},Ja=(e,t)=>e.top>t.bottom?!0:e.bottom<t.top?!1:Db(t.bottom-e.top,e,t),gD=(e,t,n)=>t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom,hD=e=>Sn(e,(t,n)=>t.fold(()=>m.some(n),s=>{const o=Math.min(n.left,s.left),r=Math.min(n.top,s.top),a=Math.max(n.right,s.right),i=Math.max(n.bottom,s.bottom);return m.some({top:r,right:a,bottom:i,left:o,width:a-o,height:i-r})}),m.none()),Rb=(e,t,n)=>{const s=Math.max(Math.min(t,e.left+e.width),e.left),o=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-s)*(t-s)+(n-o)*(n-o))},bD=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),vD=(e,t,n)=>Math.min(Math.max(e,t),n),Bl=e=>{const t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},ho=(e,t)=>{if(Q(e)&&e.hasChildNodes()){const n=e.childNodes,s=vD(t,0,n.length-1);return n[s]}else return e},yD=(e,t)=>{if(!(t<0&&Q(e)&&e.hasChildNodes()))return ho(e,t)},CD=new RegExp("[-----------------------------------------------------------------------------------------------------------------------------------]"),Pb=e=>ce(e)&&e.charCodeAt(0)>=768&&CD.test(e),ED=(...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1},SD=(...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0},Ob=Q,wD=Zn,Bb=hl("display","block table"),_D=hl("float","left right"),ei=SD(Ob,wD,xr(_D)),xD=xr(hl("white-space","pre pre-line pre-wrap")),ti=z,Pf=dt,Ib=qe.nodeIndex,Il=yD,Of=e=>e?e.createRange():qe.DOM.createRng(),Bf=e=>ce(e)&&/[\r\n\t ]/.test(e),Fb=e=>!!e.setStart&&!!e.setEnd,If=e=>{const t=e.startContainer,n=e.startOffset;if(Bf(e.toString())&&xD(t.parentNode)&&z(t)){const s=t.data;if(Bf(s[n-1])||Bf(s[n+1]))return!0}return!1},kD=e=>{const t=e.ownerDocument,n=Of(t),s=t.createTextNode(Dt),o=e.parentNode;o.insertBefore(s,e),n.setStart(s,0),n.setEnd(s,1);const r=Qo(n.getBoundingClientRect());return o.removeChild(s),r},ND=e=>{const t=e.startContainer,n=e.endContainer,s=e.startOffset,o=e.endOffset;if(t===n&&z(n)&&s===0&&o===1){const r=e.cloneRange();return r.setEndAfter(n),bo(r)}else return null},Lb=e=>e.left===0&&e.right===0&&e.top===0&&e.bottom===0,bo=e=>{var t;let n;const s=e.getClientRects();return s.length>0?n=Qo(s[0]):n=Qo(e.getBoundingClientRect()),!Fb(e)&&Pf(e)&&Lb(n)?kD(e):Lb(n)&&Fb(e)&&(t=ND(e))!==null&&t!==void 0?t:n},Jo=(e,t)=>{const n=Tb(e,t);return n.width=1,n.right=n.left+1,n},AD=e=>{const t=[],n=a=>{a.height!==0&&(t.length>0&&pD(a,t[t.length-1])||t.push(a))},s=(a,i)=>{const l=Of(a.ownerDocument);if(i<a.data.length){if(Pb(a.data[i]))return;if(Pb(a.data[i-1])&&(l.setStart(a,i),l.setEnd(a,i+1),!If(l))){n(Jo(bo(l),!1));return}}i>0&&(l.setStart(a,i-1),l.setEnd(a,i),If(l)||n(Jo(bo(l),!1))),i<a.data.length&&(l.setStart(a,i),l.setEnd(a,i+1),If(l)||n(Jo(bo(l),!0)))},o=e.container(),r=e.offset();if(ti(o))return s(o,r),t;if(Ob(o))if(e.isAtEnd()){const a=Il(o,r);ti(a)&&s(a,a.data.length),ei(a)&&!Pf(a)&&n(Jo(bo(a),!1))}else{const a=Il(o,r);if(ti(a)&&s(a,0),ei(a)&&e.isAtEnd())return n(Jo(bo(a),!1)),t;const i=Il(e.container(),e.offset()-1);ei(i)&&!Pf(i)&&(Bb(i)||Bb(a)||!ei(a))&&n(Jo(bo(i),!1)),ei(a)&&n(Jo(bo(a),!0))}return t},P=(e,t,n)=>{const s=()=>(ti(e),t===0),o=()=>ti(e)?t>=e.data.length:t>=e.childNodes.length,r=()=>{const f=Of(e.ownerDocument);return f.setStart(e,t),f.setEnd(e,t),f},a=()=>(n||(n=AD(P(e,t))),n),i=()=>a().length>0,l=f=>f&&e===f.container()&&t===f.offset(),c=f=>Il(e,f?t-1:t);return{container:Y(e),offset:Y(t),toRange:r,getClientRects:a,isVisible:i,isAtStart:s,isAtEnd:o,isEqual:l,getNode:c}};P.fromRangeStart=e=>P(e.startContainer,e.startOffset),P.fromRangeEnd=e=>P(e.endContainer,e.endOffset),P.after=e=>P(e.parentNode,Ib(e)+1),P.before=e=>P(e.parentNode,Ib(e)),P.isAbove=(e,t)=>an(hn(t.getClientRects()),Bo(e.getClientRects()),Qa).getOr(!1),P.isBelow=(e,t)=>an(Bo(t.getClientRects()),hn(e.getClientRects()),Ja).getOr(!1),P.isAtStart=e=>e?e.isAtStart():!1,P.isAtEnd=e=>e?e.isAtEnd():!1,P.isTextPosition=e=>e?z(e.container()):!1,P.isElementPosition=e=>!P.isTextPosition(e);const Fl=(e,t)=>{z(t)&&t.data.length===0&&e.remove(t)},TD=(e,t,n)=>{t.insertNode(n),Fl(e,n.previousSibling),Fl(e,n.nextSibling)},DD=(e,t,n)=>{const s=m.from(n.firstChild),o=m.from(n.lastChild);t.insertNode(n),s.each(r=>Fl(e,r.previousSibling)),o.each(r=>Fl(e,r.nextSibling))},Ff=(e,t,n)=>{lf(n)?DD(e,t,n):TD(e,t,n)},is=z,$b=Wo,Mb=qe.nodeIndex,Ub=e=>{const t=e.parentNode;return $b(t)?Ub(t):t},Lf=e=>e?il(e.childNodes,(t,n)=>($b(n)&&n.nodeName!=="BR"?t=t.concat(Lf(n)):t.push(n),t),[]):[],RD=(e,t)=>{let n=e;for(;(n=n.previousSibling)&&is(n);)t+=n.data.length;return t},zb=e=>t=>e===t,PD=e=>{let t,n;t=Lf(Ub(e)),n=Dg(t,zb(e),e),t=t.slice(0,n+1);const s=il(t,(o,r,a)=>(is(r)&&is(t[a-1])&&o++,o),0);return t=Aa(t,os([e.nodeName])),n=Dg(t,zb(e),e),n-s},Hb=e=>(is(e)?"text()":e.nodeName.toLowerCase())+"["+PD(e)+"]",OD=(e,t,n)=>{const s=[];for(let o=t.parentNode;o&&o!==e&&!(n&&n(o));o=o.parentNode)s.push(o);return s},Wb=(e,t)=>{let n=[],s=t.container(),o=t.offset(),r;if(is(s))r=RD(s,o);else{const i=s.childNodes;o>=i.length?(r="after",o=i.length-1):r="before",s=i[o]}n.push(Hb(s));let a=OD(e,s);return a=Aa(a,xr(Wo)),n=n.concat(zu(a,i=>Hb(i))),n.reverse().join("/")+","+r},BD=(e,t,n)=>{let s=Lf(e);return s=Aa(s,(o,r)=>!is(o)||!is(s[r-1])),s=Aa(s,os([t])),s[n]},ID=(e,t)=>{let n=e,s=0;for(;is(n);){const o=n.data.length;if(t>=s&&t<=s+o){e=n,t=t-s;break}if(!is(n.nextSibling)){e=n,t=o;break}s+=o,n=n.nextSibling}return is(e)&&t>e.data.length&&(t=e.data.length),P(e,t)},Vb=(e,t)=>{if(!t)return null;const n=t.split(","),s=n[0].split("/"),o=n.length>1?n[1]:"before",r=il(s,(a,i)=>{const l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?(l[1]==="text()"&&(l[1]="#text"),BD(a,l[1],parseInt(l[2],10))):null},e);if(!r)return null;if(!is(r)&&r.parentNode){let a;return o==="after"?a=Mb(r)+1:a=Mb(r),P(r.parentNode,a)}return ID(r,parseInt(o,10))},Ll=tt,FD=(e,t,n)=>{let s=e(t.data.slice(0,n)).length;for(let o=t.previousSibling;o&&z(o);o=o.previousSibling)s+=e(o.data).length;return s},qb=(e,t,n,s,o)=>{const r=o?s.startContainer:s.endContainer;let a=o?s.startOffset:s.endOffset;const i=[],l=e.getRoot();if(z(r))i.push(n?FD(t,r,a):a);else{let c=0;const f=r.childNodes;a>=f.length&&f.length&&(c=1,a=Math.max(0,f.length-1)),i.push(e.nodeIndex(f[a],n)+c)}for(let c=r;c&&c!==l;c=c.parentNode)i.push(e.nodeIndex(c,n));return i},LD=(e,t,n,s)=>{const o=t.dom,r=qb(o,e,n,s,!0),a=t.isForward(),i=qh(s)?{isFakeCaret:!0}:{};if(t.isCollapsed())return{start:r,forward:a,...i};{const l=qb(o,e,n,s,!1);return{start:r,end:l,forward:a,...i}}},$f=(e,t,n)=>{let s=0;return V.each(e.select(t),o=>{if(o.getAttribute("data-mce-bogus")!=="all"){if(o===n)return!1;s++;return}}),s},jb=(e,t)=>{let n=t?e.startContainer:e.endContainer,s=t?e.startOffset:e.endOffset;if(Q(n)&&n.nodeName==="TR"){const o=n.childNodes;n=o[Math.min(t?s:s-1,o.length-1)],n&&(s=t?0:n.childNodes.length,t?e.setStart(n,s):e.setEnd(n,s))}},Kb=e=>(jb(e,!0),jb(e,!1),e),Gb=(e,t)=>{if(Q(e)&&(e=ho(e,t),Ll(e)))return e;if(Bn(e)){z(e)&&Ur(e)&&(e=e.parentNode);let n=e.previousSibling;if(Ll(n)||(n=e.nextSibling,Ll(n)))return n}},$D=e=>Gb(e.startContainer,e.startOffset)||Gb(e.endContainer,e.endOffset),Yb=(e,t,n)=>{const s=n.getNode(),o=n.getRng();if(s.nodeName==="IMG"||Ll(s)){const a=s.nodeName;return{name:a,index:$f(n.dom,a,s)}}const r=$D(o);if(r){const a=r.tagName;return{name:a,index:$f(n.dom,a,r)}}return LD(e,n,t,o)},MD=e=>{const t=e.getRng();return{start:Wb(e.dom.getRoot(),P.fromRangeStart(t)),end:Wb(e.dom.getRoot(),P.fromRangeEnd(t)),forward:e.isForward()}},UD=e=>({rng:e.getRng(),forward:e.isForward()}),Xb=(e,t,n)=>{const s={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",s,"&#xFEFF;"):e.create("span",s)},Zb=(e,t)=>{const n=e.dom;let s=e.getRng();const o=n.uniqueId(),r=e.isCollapsed(),a=e.getNode(),i=a.nodeName,l=e.isForward();if(i==="IMG")return{name:i,index:$f(n,i,a)};const c=Kb(s.cloneRange());if(!r){c.collapse(!1);const u=Xb(n,o+"_end",t);Ff(n,c,u)}s=Kb(s),s.collapse(!0);const f=Xb(n,o+"_start",t);return Ff(n,s,f),e.moveToBookmark({id:o,keep:!0,forward:l}),{id:o,forward:l}},zD=(e,t,n=!1)=>t===2?Yb(Gs,n,e):t===3?MD(e):t?UD(e):Zb(e,!1),Mf=ne(Yb,Kt,!0),Qb=e=>{const t=r=>r(e),n=Y(e),s=()=>o,o={tag:!0,inner:e,fold:(r,a)=>a(e),isValue:St,isError:lt,map:r=>ln.value(r(e)),mapError:s,bind:t,exists:t,forall:t,getOr:n,or:s,getOrThunk:n,orThunk:s,getOrDie:n,each:r=>{r(e)},toOptional:()=>m.some(e)};return o},Jb=e=>{const t=()=>n,n={tag:!1,inner:e,fold:(s,o)=>s(e),isValue:lt,isError:St,map:t,mapError:s=>ln.error(s(e)),bind:t,exists:lt,forall:St,getOr:Kt,or:Kt,getOrThunk:Bu,orThunk:Bu,getOrDie:Sg(String(e)),each:Ee,toOptional:m.none};return n},ln={value:Qb,error:Jb,fromOption:(e,t)=>e.fold(()=>Jb(t),Qb)},ks={generate:e=>{if(!Ge(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return M(e,(s,o)=>{const r=wn(s);if(r.length!==1)throw new Error("one and only one name per case");const a=r[0],i=s[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!Ge(i))throw new Error("case arguments must be an array");t.push(a),n[a]=(...l)=>{const c=l.length;if(c!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+c);return{fold:(...u)=>{if(u.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+u.length);return u[o].apply(null,l)},match:u=>{const d=wn(u);if(t.length!==d.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+d.join(","));if(!oo(t,E=>Ve(d,E)))throw new Error("Not all branches were specified when using match. Specified: "+d.join(", ")+`
Required: `+t.join(", "));return u[a].apply(null,l)},log:u=>{console.log(u,{constructors:t,constructor:a,params:l})}}}}),n}};ks.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const HD=e=>{const t=[],n=[];return M(e,s=>{s.fold(o=>{t.push(o)},o=>{n.push(o)})}),{errors:t,values:n}},WD=e=>e.type==="inline-command"||e.type==="inline-format",VD=e=>e.type==="block-command"||e.type==="block-format",qD=e=>{const t=s=>ln.error({message:s,pattern:e}),n=(s,o,r)=>{if(e.format!==void 0){let a;if(Ge(e.format)){if(!oo(e.format,ce))return t(s+" pattern has non-string items in the `format` array");a=e.format}else if(ce(e.format))a=[e.format];else return t(s+" pattern has non-string `format` parameter");return ln.value(o(a))}else return e.cmd!==void 0?ce(e.cmd)?ln.value(r(e.cmd,e.value)):t(s+" pattern has non-string `cmd` parameter"):t(s+" pattern is missing both `format` and `cmd` parameters")};if(!Qe(e))return t("Raw pattern is not an object");if(!ce(e.start))return t("Raw pattern is missing `start` parameter");if(e.end!==void 0){if(!ce(e.end))return t("Inline pattern has non-string `end` parameter");if(e.start.length===0&&e.end.length===0)return t("Inline pattern has empty `start` and `end` parameters");let s=e.start,o=e.end;return o.length===0&&(o=s,s=""),n("Inline",r=>({type:"inline-format",start:s,end:o,format:r}),(r,a)=>({type:"inline-command",start:s,end:o,cmd:r,value:a}))}else return e.replacement!==void 0?ce(e.replacement)?e.start.length===0?t("Replacement pattern has empty `start` parameter"):ln.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):t("Replacement pattern has non-string `replacement` parameter"):e.start.length===0?t("Block pattern has empty `start` parameter"):n("Block",s=>({type:"block-format",start:e.start,format:s[0]}),(s,o)=>({type:"block-command",start:e.start,cmd:s,value:o}))},ev=e=>ve(e,VD),tv=e=>ve(e,WD),jD=(e,t)=>({inlinePatterns:tv(e),blockPatterns:ev(e),dynamicPatternsLookup:t}),nv=e=>{const t=HD(Ue(e,qD));return M(t.errors,n=>console.error(n.message,n.pattern)),t.values},KD=e=>t=>{const n=e(t);return nv(n)},Uf=Es().deviceType,GD=Uf.isTouch(),YD=qe.DOM,XD=e=>{const t=e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(",");return Sn(t,(n,s)=>{const o=s.split("="),r=o[0],a=o.length>1?o[1]:r;return n[Ar(r)]=Ar(a),n},{})},sv=e=>Bt(e,RegExp),J=e=>t=>t.options.get(e),zf=e=>ce(e)||Qe(e),ov=(e,t="")=>n=>{const s=ce(n);if(s)if(n.indexOf("=")!==-1){const o=XD(n);return{value:st(o,e.id).getOr(t),valid:s}}else return{value:n,valid:s};else return{valid:!1,message:"Must be a string."}},ZD=e=>{const t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean",default:!0}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:ov(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:ov(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:n=>{const s=ce(n)&&Cs(n);return s?{value:n,valid:s}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:n=>{const s=Ve(["block","linebreak","invert","default"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:n=>Dn(n)?{valid:!0,value:n}:ce(n)?{valid:!0,value:n}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:n=>{const s=n===!1||ce(n)||En(n,ce);return s?ce(n)?{value:Ue(n.split(","),Ar),valid:s}:Ge(n)?{value:n,valid:s}:n===!1?{value:[],valid:s}:{value:n,valid:s}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:Vf(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:n=>{const s=ce(n)||En(n,ce);return s?{value:Ge(n)?n:Ue(n.split(","),Ar),valid:s}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:n=>{const s=Dn(n)||ce(n);return s?n===!1||Uf.isiPhone()||Uf.isiPad()?{value:"",valid:s}:{value:n===!0?"table,img,figure.image,div,video,iframe":n,valid:s}:{valid:!1,message:"Must be boolean or a string"}},default:!GD}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"object"}),t("service_message",{processor:"string"}),t("theme",{processor:n=>n===!1||ce(n)||Be(n),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("format_noneditable_selector",{processor:"string",default:""}),t("preview_styles",{processor:n=>{const s=n===!1||ce(n);return s?{value:n===!1?"":n,valid:s}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("readonly",{processor:"boolean",default:!1}),t("editable_root",{processor:"boolean",default:!0}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area. Press ALT-0 for help."}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean",default:!0}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:"string"}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:zf}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:zf}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:zf}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:n=>ce(n)||n===!0}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:n=>En(n,Qe)||n===!1?{value:nv(n===!1?[]:n),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1"},{start:"##",format:"h2"},{start:"###",format:"h3"},{start:"####",format:"h4"},{start:"#####",format:"h5"},{start:"######",format:"h6"},{start:"1. ",cmd:"InsertOrderedList"},{start:"* ",cmd:"InsertUnorderedList"},{start:"- ",cmd:"InsertUnorderedList"}]}),t("text_patterns_lookup",{processor:n=>Be(n)?{value:KD(n),valid:!0}:{valid:!1,message:"Must be a single function"},default:n=>[]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:n=>En(n,sv)?{value:n,valid:!0}:sv(n)?{value:[n],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),t("highlight_on_focus",{processor:"boolean",default:!1}),t("xss_sanitization",{processor:"boolean",default:!0}),t("details_initial_state",{processor:n=>{const s=Ve(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("details_serialized_state",{processor:n=>{const s=Ve(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("init_content_sync",{processor:"boolean",default:!1}),t("newdocument_content",{processor:"string",default:""}),e.on("ScriptsLoaded",()=>{t("directionality",{processor:"string",default:as.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:YD.getAttrib(e.getElement(),"placeholder")})})},QD=J("iframe_attrs"),JD=J("doctype"),rv=J("document_base_url"),eR=J("body_id"),tR=J("body_class"),av=J("content_security_policy"),nR=J("br_in_pre"),cn=J("forced_root_block"),ni=J("forced_root_block_attrs"),sR=J("newline_behavior"),oR=J("br_newline_selector"),rR=J("no_newline_selector"),aR=J("keep_styles"),iR=J("end_container_on_empty_block"),iv=J("automatic_uploads"),lv=J("images_reuse_filename"),lR=J("images_replace_blob_uris"),cv=J("icons"),cR=J("icons_url"),uR=J("images_upload_url"),fR=J("images_upload_base_path"),dR=J("images_upload_credentials"),mR=J("images_upload_handler"),pR=J("content_css_cors"),Hf=J("referrer_policy"),uv=J("language"),gR=J("language_url"),fv=J("indent_use_margin"),hR=J("indentation"),bR=J("content_css"),vR=J("content_style"),dv=J("font_css"),yR=J("directionality"),CR=J("inline_boundaries_selector"),mv=J("object_resizing"),ER=J("resize_img_proportional"),SR=J("placeholder"),pv=J("event_root"),wR=J("service_message"),qr=J("theme"),_R=J("theme_url"),Wf=J("model"),xR=J("model_url"),si=J("inline_boundaries"),kR=J("formats"),NR=J("preview_styles"),AR=J("format_empty_lines"),TR=J("format_noneditable_selector"),DR=J("custom_ui_selector"),Vf=J("inline"),RR=J("hidden_input"),PR=J("submit_patch"),OR=J("add_form_submit_trigger"),BR=J("add_unload_trigger"),IR=J("custom_undo_redo_levels"),FR=J("disable_nodechange"),gv=J("readonly"),LR=J("editable_root"),hv=J("content_css_cors"),$l=J("plugins"),$R=J("external_plugins"),MR=J("block_unsupported_drop"),UR=J("visual"),zR=J("visual_table_class"),bv=J("visual_anchor_class"),HR=J("iframe_aria_text"),WR=J("setup"),VR=J("init_instance_callback"),qR=J("urlconverter_callback"),jR=J("auto_focus"),KR=J("browser_spellcheck"),GR=J("protect"),YR=J("paste_block_drop"),Ml=J("paste_data_images"),XR=J("paste_preprocess"),ZR=J("paste_postprocess"),QR=J("newdocument_content"),JR=J("paste_webkit_styles"),e1=J("paste_remove_styles_if_webkit"),t1=J("paste_merge_formats"),n1=J("smart_paste"),s1=J("paste_as_text"),o1=J("paste_tab_spaces"),r1=J("allow_html_data_urls"),a1=J("text_patterns"),i1=J("text_patterns_lookup"),vv=J("noneditable_class"),l1=J("editable_class"),c1=J("noneditable_regexp"),u1=J("preserve_cdata"),f1=J("highlight_on_focus"),qf=J("xss_sanitization"),d1=J("init_content_sync"),m1=e=>e.options.isSet("text_patterns_lookup"),p1=e=>V.explode(e.options.get("font_size_style_values")),g1=e=>V.explode(e.options.get("font_size_classes")),h1=e=>e.options.get("encoding")==="xml",yv=e=>V.explode(e.options.get("images_file_types")),b1=J("table_tab_navigation"),v1=J("details_initial_state"),y1=J("details_serialized_state"),C1=Q,Cv=z,Ev=e=>{const t=e.parentNode;t&&t.removeChild(e)},Sv=e=>{const t=Gs(e);return{count:e.length-t.length,text:t}},wv=e=>{let t;for(;(t=e.data.lastIndexOf(Wt))!==-1;)e.deleteData(t,1)},_v=(e,t)=>(er(e),t),E1=(e,t)=>{const n=Sv(e.data.substr(0,t.offset())),s=Sv(e.data.substr(t.offset()));return(n.text+s.text).length>0?(wv(e),P(e,t.offset()-n.count)):t},S1=(e,t)=>{const n=t.container(),s=qk(rn(n.childNodes),e).map(o=>o<t.offset()?P(n,t.offset()-1):t).getOr(t);return er(e),s},w1=(e,t)=>Cv(e)&&t.container()===e?E1(e,t):_v(e,t),_1=(e,t)=>t.container()===e.parentNode?S1(e,t):_v(e,t),x1=(e,t)=>P.isTextPosition(t)?w1(e,t):_1(e,t),er=e=>{C1(e)&&Bn(e)&&(Vh(e)?e.removeAttribute("data-mce-caret"):Ev(e)),Cv(e)&&(wv(e),e.data.length===0&&Ev(e))},k1=tt,N1=xs,A1=bl,T1="*[contentEditable=false],video,audio,embed,object",xv=(e,t,n)=>{const s=Tb(t.getBoundingClientRect(),n);let o,r;if(e.tagName==="BODY"){const i=e.ownerDocument.documentElement;o=e.scrollLeft||i.scrollLeft,r=e.scrollTop||i.scrollTop}else{const i=e.getBoundingClientRect();o=e.scrollLeft-i.left,r=e.scrollTop-i.top}s.left+=o,s.right+=o,s.top+=r,s.bottom+=r,s.width=1;let a=t.offsetWidth-t.clientWidth;return a>0&&(n&&(a*=-1),s.left+=a,s.right+=a),s},D1=e=>{var t,n;const s=Yt(S.fromDom(e),T1);for(let o=0;o<s.length;o++){const r=s[o].dom;let a=r.previousSibling;if(_l(a)){const i=a.data;i.length===1?(t=a.parentNode)===null||t===void 0||t.removeChild(a):a.deleteData(i.length-1,1)}a=r.nextSibling,wl(a)&&(a.data.length===1?(n=a.parentNode)===null||n===void 0||n.removeChild(a):a.deleteData(0,1))}},R1=(e,t,n,s)=>{const o=go();let r,a;const i=cn(e),l=e.dom,c=(h,C)=>{let w;if(f(),A1(C))return null;if(n(C)){const _=KA(i,C,h),x=xv(t,C,h);l.setStyle(_,"top",x.top),a=_;const N=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(N,{...x}),l.add(t,N),o.set({caret:N,element:C,before:h}),h&&l.addClass(N,"mce-visual-caret-before"),u(),w=C.ownerDocument.createRange(),w.setStart(_,0),w.setEnd(_,0)}else return a=jA(C,h),w=C.ownerDocument.createRange(),oi(a.nextSibling)?(w.setStart(a,0),w.setEnd(a,0)):(w.setStart(a,1),w.setEnd(a,1)),w;return w},f=()=>{D1(t),a&&(er(a),a=null),o.on(h=>{l.remove(h.caret),o.clear()}),r&&(clearInterval(r),r=void 0)},u=()=>{r=setInterval(()=>{o.on(h=>{s()?l.toggleClass(h.caret,"mce-visual-caret-hidden"):l.addClass(h.caret,"mce-visual-caret-hidden")})},500)};return{show:c,hide:f,getCss:()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}",reposition:()=>{o.on(h=>{const C=xv(t,h.element,h.before);l.setStyles(h.caret,{...C})})},destroy:()=>clearInterval(r)}},kv=()=>Fe.browser.isFirefox(),oi=e=>k1(e)||N1(e),ri=e=>(oi(e)||Ks(e)&&kv())&&Zu(S.fromDom(e)).exists(Ir),P1=rs,jf=tt,O1=xs,Nv=hl("display","block table table-cell table-caption list-item"),Av=Bn,Tv=Ur,B1=Q,I1=z,F1=Zn,jr=e=>e>0,tr=e=>e<0,Ul=(e,t)=>{let n;for(;n=e(t);)if(!Tv(n))return n;return null},ai=(e,t,n,s,o)=>{const r=new xt(e,s),a=jf(e)||Tv(e);let i;if(tr(t)){if(a&&(i=Ul(r.prev.bind(r),!0),n(i)))return i;for(;i=Ul(r.prev.bind(r),o);)if(n(i))return i}if(jr(t)){if(a&&(i=Ul(r.next.bind(r),!0),n(i)))return i;for(;i=Ul(r.next.bind(r),o);)if(n(i))return i}return null},L1=(e,t)=>{const n=o=>P1(o.dom),s=o=>o.dom===t;return qs(S.fromDom(e),n,s).map(o=>o.dom).getOr(t)},vo=(e,t)=>{for(;e&&e!==t;){if(Nv(e))return e;e=e.parentNode}return null},Ns=(e,t,n)=>vo(e.container(),n)===vo(t.container(),n),Kf=(e,t)=>{if(!t)return m.none();const n=t.container(),s=t.offset();return B1(n)?m.from(n.childNodes[s+e]):m.none()},Dv=(e,t)=>{var n;const o=((n=t.ownerDocument)!==null&&n!==void 0?n:document).createRange();return e?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),o},$1=(e,t,n)=>vo(t,e)===vo(n,e),Rv=(e,t,n)=>{const s=e?"previousSibling":"nextSibling";let o=n;for(;o&&o!==t;){let r=o[s];if(r&&Av(r)&&(r=r[s]),jf(r)||O1(r)){if($1(t,r,o))return r;break}if(F1(r))break;o=o.parentNode}return null},ii=ne(Dv,!0),li=ne(Dv,!1),Gf=(e,t,n)=>{let s;const o=ne(Rv,!0,t),r=ne(Rv,!1,t),a=n.startContainer,i=n.startOffset;if(Ur(a)){const l=I1(a)?a.parentNode:a,c=l.getAttribute("data-mce-caret");if(c==="before"&&(s=l.nextSibling,ri(s)))return ii(s);if(c==="after"&&(s=l.previousSibling,ri(s)))return li(s)}if(!n.collapsed)return n;if(z(a)){if(Av(a)){if(e===1){if(s=r(a),s)return ii(s);if(s=o(a),s)return li(s)}if(e===-1){if(s=o(a),s)return li(s);if(s=r(a),s)return ii(s)}return n}if(_l(a)&&i>=a.data.length-1)return e===1&&(s=r(a),s)?ii(s):n;if(wl(a)&&i<=1)return e===-1&&(s=o(a),s)?li(s):n;if(i===a.data.length)return s=r(a),s?ii(s):n;if(i===0)return s=o(a),s?li(s):n}return n},Pv=(e,t)=>Kf(e?0:-1,t).filter(jf),ci=(e,t,n)=>{const s=Gf(e,t,n);return e===-1?P.fromRangeStart(s):P.fromRangeEnd(s)},zl=e=>m.from(e.getNode()).map(S.fromDom),M1=e=>m.from(e.getNode(!0)).map(S.fromDom),Yf=(e,t)=>{let n=t;for(;n=e(n);)if(n.isVisible())return n;return n},Hl=(e,t)=>{const n=Ns(e,t);return!n&&dt(e.getNode())?!0:n};var Pt;(function(e){e[e.Backwards=-1]="Backwards",e[e.Forwards=1]="Forwards"})(Pt||(Pt={}));const U1=tt,As=z,Ov=Q,Xf=dt,Kr=Zn,Bv=oT,Wl=Gh,z1=(e,t)=>{const n=[];let s=e;for(;s&&s!==t;)n.push(s),s=s.parentNode;return n},Iv=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,Fv=(e,t)=>{if(jr(e)){if(Kr(t.previousSibling)&&!As(t.previousSibling))return P.before(t);if(As(t))return P(t,0)}if(tr(e)){if(Kr(t.nextSibling)&&!As(t.nextSibling))return P.after(t);if(As(t))return P(t,t.data.length)}return tr(e)?Xf(t)?P.before(t):P.after(t):P.before(t)},H1=(e,t)=>{const n=t.nextSibling;return n&&Kr(n)?As(n)?P(n,0):P.before(n):Zf(Pt.Forwards,P.after(t),e)},Zf=(e,t,n)=>{let s,o,r,a;if(!Ov(n)||!t)return null;if(t.isEqual(P.after(n))&&n.lastChild){if(a=P.after(n.lastChild),tr(e)&&Kr(n.lastChild)&&Ov(n.lastChild))return Xf(n.lastChild)?P.before(n.lastChild):a}else a=t;const i=a.container();let l=a.offset();if(As(i)){if(tr(e)&&l>0)return P(i,--l);if(jr(e)&&l<i.length)return P(i,++l);s=i}else{if(tr(e)&&l>0&&(o=Iv(i,l-1),Kr(o)))return!Bv(o)&&(r=ai(o,e,Wl,o),r)?As(r)?P(r,r.data.length):P.after(r):As(o)?P(o,o.data.length):P.before(o);if(jr(e)&&l<i.childNodes.length&&(o=Iv(i,l),Kr(o)))return Xf(o)?H1(n,o):!Bv(o)&&(r=ai(o,e,Wl,o),r)?As(r)?P(r,0):P.before(r):As(o)?P(o,0):P.after(o);s=o||a.getNode()}if(s&&(jr(e)&&a.isAtEnd()||tr(e)&&a.isAtStart())&&(s=ai(s,e,St,n,!0),Wl(s,n)))return Fv(e,s);o=s&&ai(s,e,Wl,n);const c=Io(ve(z1(i,n),U1));return c&&(!o||!c.contains(o))?(jr(e)?a=P.after(c):a=P.before(c),a):o?Fv(e,o):null},Ts=e=>({next:t=>Zf(Pt.Forwards,t,e),prev:t=>Zf(Pt.Backwards,t,e)}),W1=(e,t,n)=>{const s=e?P.before(n):P.after(n);return In(e,t,s)},V1=e=>dt(e)?P.before(e):P.after(e),Lv=e=>P.isTextPosition(e)?e.offset()===0:Zn(e.getNode()),$v=e=>{if(P.isTextPosition(e)){const t=e.container();return e.offset()===t.data.length}else return Zn(e.getNode(!0))},Mv=(e,t)=>!P.isTextPosition(e)&&!P.isTextPosition(t)&&e.getNode()===t.getNode(!0),q1=e=>!P.isTextPosition(e)&&dt(e.getNode()),j1=(e,t,n)=>e?!Mv(t,n)&&!q1(t)&&$v(t)&&Lv(n):!Mv(n,t)&&Lv(t)&&$v(n),In=(e,t,n)=>{const s=Ts(t);return m.from(e?s.next(n):s.prev(n))},ui=(e,t,n)=>In(e,t,n).bind(s=>Ns(n,s,t)&&j1(e,n,s)?In(e,t,s):m.some(s)),Uv=(e,t,n,s)=>ui(e,t,n).bind(o=>s(o)?Uv(e,t,o,s):m.some(o)),Gr=(e,t)=>{const n=e?t.firstChild:t.lastChild;return z(n)?m.some(P(n,e?0:n.data.length)):n?Zn(n)?m.some(e?P.before(n):V1(n)):W1(e,t,n):m.none()},Qt=ne(In,!0),un=ne(In,!1),Jt=ne(Gr,!0),Qn=ne(Gr,!1),Qf="_mce_caret",Jn=e=>Q(e)&&e.id===Qf,nr=(e,t)=>{let n=t;for(;n&&n!==e;){if(Jn(n))return n;n=n.parentNode}return null},K1=e=>ce(e.start),G1=e=>Se(e,"rng"),Y1=e=>Se(e,"id"),zv=e=>Se(e,"name"),Hv=e=>V.isArray(e.start),Vl=e=>!zv(e)&&Dn(e.forward)?e.forward:!0,Wv=(e,t)=>(Q(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),X1=(e,t)=>{const n=m.from(Vb(e.getRoot(),t.start)),s=m.from(Vb(e.getRoot(),t.end));return an(n,s,(o,r)=>{const a=e.createRng();return a.setStart(o.container(),o.offset()),a.setEnd(r.container(),r.offset()),{range:a,forward:Vl(t)}})},Z1=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(Wt);e.appendChild(o),t.setStart(o,0),t.setEnd(o,0)},Q1=e=>!e.hasChildNodes(),J1=(e,t)=>Qn(e).fold(lt,n=>(t.setStart(n.container(),n.offset()),t.setEnd(n.container(),n.offset()),!0)),Vv=(e,t,n)=>Q1(t)&&nr(e,t)?(Z1(t,n),!0):!1,qv=(e,t,n,s)=>{const o=n[t?"start":"end"],r=e.getRoot();if(o){let a=r,i=o[0];for(let l=o.length-1;a&&l>=1;l--){const c=a.childNodes;if(Vv(r,a,s))return!0;if(o[l]>c.length-1)return Vv(r,a,s)?!0:J1(a,s);a=c[o[l]]}z(a)&&(i=Math.min(o[0],a.data.length)),Q(a)&&(i=Math.min(o[0],a.childNodes.length)),t?s.setStart(a,i):s.setEnd(a,i)}return!0},Jf=e=>z(e)&&e.data.length>0,jv=(e,t,n)=>{const s=e.get(n.id+"_"+t),o=s==null?void 0:s.parentNode,r=n.keep;if(s&&o){let a,i;if(t==="start"?r?s.hasChildNodes()?(a=s.firstChild,i=1):Jf(s.nextSibling)?(a=s.nextSibling,i=0):Jf(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)+1):(a=o,i=e.nodeIndex(s)):r?s.hasChildNodes()?(a=s.firstChild,i=1):Jf(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)):(a=o,i=e.nodeIndex(s)),!r){const l=s.previousSibling,c=s.nextSibling;V.each(V.grep(s.childNodes),u=>{z(u)&&(u.data=u.data.replace(/\uFEFF/g,""))});let f;for(;f=e.get(n.id+"_"+t);)e.remove(f,!0);if(z(c)&&z(l)&&!Fe.browser.isOpera()){const u=l.data.length;l.appendData(c.data),e.remove(c),a=l,i=u}}return m.some(P(a,i))}else return m.none()},eP=(e,t)=>{const n=e.createRng();return qv(e,!0,t,n)&&qv(e,!1,t,n)?m.some({range:n,forward:Vl(t)}):m.none()},tP=(e,t)=>{const n=jv(e,"start",t),s=jv(e,"end",t);return an(n,s.or(n),(o,r)=>{const a=e.createRng();return a.setStart(Wv(e,o.container()),o.offset()),a.setEnd(Wv(e,r.container()),r.offset()),{range:a,forward:Vl(t)}})},nP=(e,t)=>m.from(e.select(t.name)[t.index]).map(n=>{const s=e.createRng();return s.selectNode(n),{range:s,forward:!0}}),sP=(e,t)=>{const n=e.dom;if(t){if(Hv(t))return eP(n,t);if(K1(t))return X1(n,t);if(Y1(t))return tP(n,t);if(zv(t))return nP(n,t);if(G1(t))return m.some({range:t.rng,forward:Vl(t)})}return m.none()},oP=(e,t,n)=>zD(e,t,n),rP=(e,t)=>{sP(e,t).each(({range:n,forward:s})=>{e.setRng(n,s)})},Fn=e=>Q(e)&&e.tagName==="SPAN"&&e.getAttribute("data-mce-type")==="bookmark",ql=(e=>t=>e===t)(Dt),Yr=e=>e!==""&&` \f
\r	\v`.indexOf(e)!==-1,ed=e=>!Yr(e)&&!ql(e)&&!cf(e),aP=e=>({value:iP(e)}),iP=e=>Bg(e,"#").toUpperCase(),td=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},lP=e=>{const t=td(e.red)+td(e.green)+td(e.blue);return aP(t)},cP=/^\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)\s*$/i,uP=/^\s*rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?(?:\.\d+)?)\s*\)\s*$/i,Kv=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),Gv=(e,t,n,s)=>{const o=parseInt(e,10),r=parseInt(t,10),a=parseInt(n,10),i=parseFloat(s);return Kv(o,r,a,i)},fP=e=>{if(e==="transparent")return m.some(Kv(0,0,0,0));const t=cP.exec(e);if(t!==null)return m.some(Gv(t[1],t[2],t[3],"1"));const n=uP.exec(e);return n!==null?m.some(Gv(n[1],n[2],n[3],n[4])):m.none()},jl=e=>fP(e).map(lP).map(t=>"#"+t.value).getOr(e),nd=e=>{const t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},dP=e=>ys(e,t=>{const n=Bl(t);return n?[S.fromDom(n)]:[]}),mP=e=>nd(e).length>1,pP=e=>ve(dP(e),Ha),gP=e=>Yt(e,"td[data-mce-selected],th[data-mce-selected]"),Yv=(e,t)=>{const n=gP(t);return n.length>0?n:pP(e)},Xr=e=>Yv(nd(e.selection.getSel()),S.fromDom(e.getBody())),fi=(e,t)=>Fa(e,"table",t),hP=e=>{const t=e.startContainer,n=e.startOffset;return z(t)?n===0?m.some(S.fromDom(t)):m.none():m.from(t.childNodes[n]).map(S.fromDom)},bP=e=>{const t=e.endContainer,n=e.endOffset;return z(t)?n===t.data.length?m.some(S.fromDom(t)):m.none():m.from(t.childNodes[n-1]).map(S.fromDom)},Xv=e=>Qu(e).fold(Y([e]),t=>[e].concat(Xv(t))),sd=e=>Ju(e).fold(Y([e]),t=>et(t)==="br"?$o(t).map(n=>[e].concat(sd(n))).getOr([]):[e].concat(sd(t))),od=(e,t)=>an(hP(t),bP(t),(n,s)=>{const o=_t(Xv(e),ne(ze,n)),r=_t(sd(e),ne(ze,s));return o.isSome()&&r.isSome()}).getOr(!1),rd=(e,t,n,s)=>{const o=n,r=new xt(n,o),a=Na(e.schema.getMoveCaretBeforeOnEnterElements(),(l,c)=>!Ve(["td","th","table"],c.toLowerCase()));let i=n;do{if(z(i)&&V.trim(i.data).length!==0){s?t.setStart(i,0):t.setEnd(i,i.data.length);return}if(a[i.nodeName]){s?t.setStartBefore(i):i.nodeName==="BR"?t.setEndBefore(i):t.setEndAfter(i);return}}while(i=s?r.next():r.prev());o.nodeName==="BODY"&&(s?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},Kl=e=>{const t=e.selection.getSel();return G(t)&&t.rangeCount>0},ad=(e,t)=>{const n=Xr(e);n.length>0?M(n,s=>{const o=s.dom,r=e.dom.createRng();r.setStartBefore(o),r.setEndAfter(o),t(r,!0)}):t(e.selection.getRng(),!1)},Zv=(e,t,n)=>{const s=Zb(e,t);n(s),e.moveToBookmark(s)},di=e=>Tt(e==null?void 0:e.nodeType),id=e=>Q(e)&&!Fn(e)&&!Jn(e)&&!Wo(e),vP=(e,t)=>{if(id(t)&&!/^(TD|TH)$/.test(t.nodeName)){const n=e.getAttrib(t,"data-mce-selected"),s=parseInt(n,10);return!isNaN(s)&&s>0}else return!1},sr=e=>e.isContentEditable===!0,Qv=(e,t,n)=>{const{selection:s,dom:o}=e,r=s.getNode(),a=tt(r);Zv(s,!0,()=>{t()}),a&&tt(r)&&o.isChildOf(r,e.getBody())?e.selection.select(r):n(s.getStart())&&yP(o,s)},yP=(e,t)=>{var n,s;const o=t.getRng(),{startContainer:r,startOffset:a}=o,i=t.getNode();if(!vP(e,i)&&Q(r)){const l=r.childNodes,c=e.getRoot();let f;if(a<l.length){const u=l[a];f=new xt(u,(n=e.getParent(u,e.isBlock))!==null&&n!==void 0?n:c)}else{const u=l[l.length-1];f=new xt(u,(s=e.getParent(u,e.isBlock))!==null&&s!==void 0?s:c),f.next(!0)}for(let u=f.current();u;u=f.next()){if(e.getContentEditable(u)==="false")return;if(z(u)&&!cd(u)){o.setStart(u,0),t.setRng(o);return}}}},Jv=(e,t,n)=>{if(e){const s=t?"nextSibling":"previousSibling";for(e=n?e:e[s];e;e=e[s])if(Q(e)||!cd(e))return e}},ld=(e,t)=>!!e.getTextBlockElements()[t.nodeName.toLowerCase()]||jo(e,t),Zr=(e,t,n)=>e.schema.isValidChild(t,n),cd=(e,t=!1)=>{if(G(e)&&z(e)){const n=t?e.data.replace(/ /g,""):e.data;return qo(n)}else return!1},CP=e=>G(e)&&z(e)&&e.length===0,EP=(e,t)=>{const n="[data-mce-cef-wrappable]",s=TR(e),o=Da(s)?n:`${n},${s}`;return ss(S.fromDom(t),o)},ey=(e,t)=>{const n=e.dom;return id(t)&&n.getContentEditable(t)==="false"&&EP(e,t)&&n.select('[contenteditable="true"]',t).length===0},yo=(e,t)=>Be(e)?e(t):(G(t)&&(e=e.replace(/%(\w+)/g,(n,s)=>t[s]||n)),e),ud=(e,t)=>(e=e||"",t=t||"",e=""+(e.nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),fd=(e,t)=>{if(rt(e))return null;{let n=String(e);return(t==="color"||t==="backgroundColor")&&(n=jl(n)),t==="fontWeight"&&e===700&&(n="bold"),t==="fontFamily"&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},Gl=(e,t,n)=>{const s=e.getStyle(t,n);return fd(s,n)},ty=(e,t)=>{let n;return e.getParent(t,s=>Q(s)?(n=e.getStyle(s,"text-decoration"),!!n&&n!=="none"):!1),n},Yl=(e,t,n)=>e.getParents(t,n,e.getRoot()),dd=(e,t,n)=>{const s=e.formatter.get(t);return G(s)&&ht(s,n)},SP=(e,t)=>dd(e,t,s=>{const o=r=>Be(r)||r.length>1&&r.charAt(0)==="%";return ht(["styles","attributes"],r=>st(s,r).exists(a=>{const i=Ge(a)?a:Mu(a);return ht(i,o)}))}),wP=(e,t,n)=>{const s=["inline","block","selector","attributes","styles","classes"],o=r=>Na(r,(a,i)=>ht(s,l=>l===i));return dd(e,t,r=>{const a=o(r);return dd(e,n,i=>{const l=o(i);return Xk(a,l)})})},Ds=e=>Nr(e,"block"),_P=e=>Ds(e)&&e.wrapper===!0,xP=e=>Ds(e)&&e.wrapper!==!0,Ln=e=>Nr(e,"selector"),kt=e=>Nr(e,"inline"),kP=e=>Ln(e)&&kt(e)&&Tr(st(e,"mixed"),!0),md=e=>Ln(e)&&e.expand!==!1&&!kt(e),Qr=Fn,ny=Yl,sy=cd,NP=ld,AP=e=>dt(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,oy=(e,t)=>{let n=t;for(;n;){if(Q(n)&&e.getContentEditable(n))return e.getContentEditable(n)==="false"?n:t;n=n.parentNode}return t},ry=(e,t,n,s)=>{const o=t.data;if(e){for(let r=n;r>0;r--)if(s(o.charAt(r-1)))return r}else for(let r=n;r<o.length;r++)if(s(o.charAt(r)))return r;return-1},TP=(e,t,n)=>ry(e,t,n,s=>ql(s)||Yr(s)),DP=(e,t,n)=>ry(e,t,n,ed),ay=(e,t,n,s,o,r)=>{let a;const i=e.getParent(n,e.isBlock)||t,l=(f,u,d)=>{const v=Zo(e),E=o?v.backwards:v.forwards;return m.from(E(f,u,(h,C)=>Qr(h.parentNode)?-1:(a=h,d(o,h,C)),i))};return l(n,s,TP).bind(f=>r?l(f.container,f.offset+(o?-1:0),DP):m.some(f)).orThunk(()=>a?m.some({container:a,offset:o?0:a.length}):m.none())},iy=(e,t,n,s,o)=>{const r=s[o];z(s)&&Da(s.data)&&r&&(s=r);const a=ny(e,s);for(let i=0;i<a.length;i++)for(let l=0;l<t.length;l++){const c=t[l];if(!(G(c.collapsed)&&c.collapsed!==n.collapsed)&&Ln(c)&&e.is(a[i],c.selector))return a[i]}return s},ly=(e,t,n,s)=>{var o;let r=n;const a=e.getRoot(),i=t[0];if(Ds(i)&&(r=i.wrapper?null:e.getParent(n,i.block,a)),!r){const l=(o=e.getParent(n,"LI,TD,TH"))!==null&&o!==void 0?o:a;r=e.getParent(z(n)?n.parentNode:n,c=>c!==a&&NP(e.schema,c),l)}if(r&&Ds(i)&&i.wrapper&&(r=ny(e,r,"ul,ol").reverse()[0]||r),!r)for(r=n;r&&r[s]&&!e.isBlock(r[s])&&(r=r[s],!ud(r,"br")););return r||n},cy=(e,t,n,s)=>{const o=n.parentNode;return G(n[s])?!1:o===t||rt(o)||e.isBlock(o)?!0:cy(e,t,o,s)},Xl=(e,t,n,s,o)=>{let r=n;const a=o?"previousSibling":"nextSibling",i=e.getRoot();if(z(n)&&!sy(n)&&(o?s>0:s<n.data.length))return n;for(;r;){if(!t[0].block_expand&&e.isBlock(r))return r;for(let l=r[a];l;l=l[a]){const c=z(l)&&!cy(e,i,l,a);if(!Qr(l)&&!AP(l)&&!sy(l,c))return r}if(r===i||r.parentNode===i){n=r;break}r=r.parentNode}return n},uy=e=>Qr(e.parentNode)||Qr(e),or=(e,t,n,s=!1)=>{let{startContainer:o,startOffset:r,endContainer:a,endOffset:i}=t;const l=n[0];return Q(o)&&o.hasChildNodes()&&(o=ho(o,r),z(o)&&(r=0)),Q(a)&&a.hasChildNodes()&&(a=ho(a,t.collapsed?i:i-1),z(a)&&(i=a.data.length)),o=oy(e,o),a=oy(e,a),uy(o)&&(o=Qr(o)?o:o.parentNode,t.collapsed?o=o.previousSibling||o:o=o.nextSibling||o,z(o)&&(r=t.collapsed?o.length:0)),uy(a)&&(a=Qr(a)?a:a.parentNode,t.collapsed?a=a.nextSibling||a:a=a.previousSibling||a,z(a)&&(i=t.collapsed?0:a.length)),t.collapsed&&(ay(e,e.getRoot(),o,r,!0,s).each(({container:u,offset:d})=>{o=u,r=d}),ay(e,e.getRoot(),a,i,!1,s).each(({container:u,offset:d})=>{a=u,i=d})),(kt(l)||l.block_expand)&&((!kt(l)||!z(o)||r===0)&&(o=Xl(e,n,o,r,!0)),(!kt(l)||!z(a)||i===a.data.length)&&(a=Xl(e,n,a,i,!1))),md(l)&&(o=iy(e,n,t,o,"previousSibling"),a=iy(e,n,t,a,"nextSibling")),(Ds(l)||Ln(l))&&(o=ly(e,n,o,"previousSibling"),a=ly(e,n,a,"nextSibling"),Ds(l)&&(e.isBlock(o)||(o=Xl(e,n,o,r,!0)),e.isBlock(a)||(a=Xl(e,n,a,i,!1)))),Q(o)&&o.parentNode&&(r=e.nodeIndex(o),o=o.parentNode),Q(a)&&a.parentNode&&(i=e.nodeIndex(a)+1,a=a.parentNode),{startContainer:o,startOffset:r,endContainer:a,endOffset:i}},mi=(e,t,n)=>{var s;const o=t.startOffset,r=ho(t.startContainer,o),a=t.endOffset,i=ho(t.endContainer,a-1),l=C=>{const w=C[0];z(w)&&w===r&&o>=w.data.length&&C.splice(0,1);const _=C[C.length-1];return a===0&&C.length>0&&_===i&&z(_)&&C.splice(C.length-1,1),C},c=(C,w,_)=>{const x=[];for(;C&&C!==_;C=C[w])x.push(C);return x},f=(C,w)=>e.getParent(C,_=>_.parentNode===w,w),u=(C,w,_)=>{const x=_?"nextSibling":"previousSibling";for(let N=C,I=N.parentNode;N&&N!==w;N=I){I=N.parentNode;const oe=c(N===C?N:N[x],x);oe.length&&(_||oe.reverse(),n(l(oe)))}};if(r===i)return n(l([r]));const d=(s=e.findCommonAncestor(r,i))!==null&&s!==void 0?s:e.getRoot();if(e.isChildOf(r,i))return u(r,d,!0);if(e.isChildOf(i,r))return u(i,d);const v=f(r,d)||r,E=f(i,d)||i;u(r,v,!0);const h=c(v===r?v:v.nextSibling,"nextSibling",E===i?E.nextSibling:E);h.length&&n(l(h)),u(i,E)},RP=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]"],PP=e=>Rn(e)&&vl(e)===Wt,OP=(e,t,n,s)=>Xn(t).fold(()=>"skipping",o=>s==="br"||PP(t)?"valid":iD(t)?"existing":Jn(t.dom)?"caret":ht(RP,r=>ss(t,r))?"valid-block":!Zr(e,n,s)||!Zr(e,et(o),n)?"invalid-child":"valid"),BP=(e,t)=>{const n=or(e.dom,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},fy=(e,t,n,s,o,r)=>{const{uid:a=t,...i}=n;Rr(e,Ka()),It(e,`${Wr()}`,a),It(e,`${Yo()}`,s);const{attributes:l={},classes:c=[]}=o(a,i);if(ro(e,l),fD(e,c),r){c.length>0&&It(e,`${Ya()}`,c.join(","));const f=wn(l);f.length>0&&It(e,`${Xa()}`,f.join(","))}},IP=e=>{Pr(e,Ka()),zt(e,`${Wr()}`),zt(e,`${Yo()}`),zt(e,`${Ga()}`);const t=Hs(e,`${Xa()}`).map(s=>s.split(",")).getOr([]),n=Hs(e,`${Ya()}`).map(s=>s.split(",")).getOr([]);M(t,s=>zt(e,s)),dD(e,n),zt(e,`${Ya()}`),zt(e,`${Xa()}`)},dy=(e,t,n,s,o)=>{const r=S.fromTag("span",e);return fy(r,t,n,s,o,!1),r},FP=(e,t,n,s,o,r)=>{const a=[],i=dy(e.getDoc(),n,r,s,o),l=go(),c=()=>{l.clear()},f=()=>l.get().getOrThunk(()=>{const E=Xo(i);return a.push(E),l.set(E),E}),u=E=>{M(E,d)},d=E=>{switch(OP(e,E,"span",et(E))){case"invalid-child":{c();const C=Ht(E);u(C),c();break}case"valid-block":{c(),fy(E,n,r,s,o,!0);break}case"valid":{const C=f();Dh(E,C);break}}},v=E=>{const h=Ue(E,S.fromDom);u(h)};return mi(e.dom,t,E=>{c(),v(E)}),a},LP=(e,t,n,s)=>{e.undoManager.transact(()=>{const o=e.selection,r=o.getRng(),a=Xr(e).length>0,i=Za("mce-annotation");if(r.collapsed&&!a&&BP(e,r),o.getRng().collapsed&&!a){const l=dy(e.getDoc(),i,s,t,n.decorate);ml(l,Dt),o.getRng().insertNode(l.dom),o.select(l.dom)}else Zv(o,!1,()=>{ad(e,l=>{FP(e,l,i,t,n.decorate,s)})})})},my=e=>{const t=uD();cD(e,t);const n=lD(e,t),s=Gu("span"),o=r=>{M(r,a=>{s(a)?js(a):IP(a)})};return{register:(r,a)=>{t.register(r,a)},annotate:(r,a)=>{t.lookup(r).each(i=>{LP(e,r,i,a)})},annotationChanged:(r,a)=>{n.addListener(r,a)},remove:r=>{Cb(e,m.some(r)).each(({elements:a})=>{const i=e.selection.getBookmark();o(a),e.selection.moveToBookmark(i)})},removeAll:r=>{const a=e.selection.getBookmark();Je(wb(e,r),(i,l)=>{o(i)}),e.selection.moveToBookmark(a)},getAll:r=>{const a=wb(e,r);return rl(a,i=>Ue(i,l=>l.dom))}}},pi=e=>({getBookmark:ne(oP,e),moveToBookmark:ne(rP,e)});pi.isBookmarkNode=Fn;const py=(e,t,n)=>n.collapsed?!1:ht(n.getClientRects(),s=>gD(s,e,t)),$P=(e,t)=>e.dispatch("PreProcess",t),MP=(e,t)=>e.dispatch("PostProcess",t),UP=e=>{e.dispatch("remove")},zP=e=>{e.dispatch("detach")},HP=(e,t)=>{e.dispatch("SwitchMode",{mode:t})},WP=(e,t,n,s,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:s,origin:o})},VP=(e,t,n,s,o)=>{e.dispatch("ObjectResized",{target:t,width:n,height:s,origin:o})},qP=e=>{e.dispatch("PreInit")},jP=e=>{e.dispatch("PostRender")},KP=e=>{e.dispatch("Init")},GP=(e,t)=>{e.dispatch("PlaceholderToggle",{state:t})},gy=(e,t,n)=>{e.dispatch(t,n)},hy=(e,t,n,s)=>{e.dispatch("FormatApply",{format:t,node:n,vars:s})},by=(e,t,n,s)=>{e.dispatch("FormatRemove",{format:t,node:n,vars:s})},YP=(e,t)=>e.dispatch("BeforeSetContent",t),vy=(e,t)=>e.dispatch("SetContent",t),XP=(e,t)=>e.dispatch("BeforeGetContent",t),yy=(e,t)=>e.dispatch("GetContent",t),ZP=(e,t)=>{e.dispatch("AutocompleterStart",t)},QP=(e,t)=>{e.dispatch("AutocompleterUpdate",t)},JP=e=>{e.dispatch("AutocompleterEnd")},eO=(e,t,n)=>e.dispatch("PastePreProcess",{content:t,internal:n}),tO=(e,t,n)=>e.dispatch("PastePostProcess",{node:t,internal:n}),Cy=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),nO=(e,t)=>e.dispatch("EditableRootStateChange",{state:t}),te={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||te.metaKeyPressed(e),metaKeyPressed:e=>Fe.os.isMacOS()||Fe.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},rr="data-mce-selected",sO="table,img,figure.image,hr,video,span.mce-preview-object,details",Ey=Math.abs,Zl=Math.round,pd={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},oO=e=>e.type==="longpress"||e.type.indexOf("touch")===0,Sy=(e,t)=>{const n=t.dom,s=t.getDoc(),o=document,r=t.getBody();let a,i,l,c,f,u,d,v,E,h,C,w,_,x,N,I,oe;const F=U=>G(U)&&(Uh(U)||n.is(U,"figure.image")),D=U=>xs(U)||n.hasClass(U,"mce-preview-object"),O=(U,pe)=>{if(oO(U)){const _e=U.touches[0];return F(U.target)&&!py(_e.clientX,_e.clientY,pe)}else return F(U.target)&&!py(U.clientX,U.clientY,pe)},q=U=>{const pe=U.target;O(U,t.selection.getRng())&&!U.isDefaultPrevented()&&t.selection.select(pe)},K=U=>n.hasClass(U,"mce-preview-object")&&G(U.firstElementChild)?[U,U.firstElementChild]:n.is(U,"figure.image")?[U.querySelector("img")]:[U],ee=U=>{const pe=mv(t);return!pe||U.getAttribute("data-mce-resize")==="false"||U===t.getBody()?!1:n.hasClass(U,"mce-preview-object")&&G(U.firstElementChild)?ss(S.fromDom(U.firstElementChild),pe):ss(S.fromDom(U),pe)},ge=U=>D(U)?n.create("img",{src:Fe.transparentSrc}):U.cloneNode(!0),me=(U,pe,_e)=>{if(G(_e)){const Me=K(U);M(Me,je=>{je.style[pe]||!t.schema.isValid(je.nodeName.toLowerCase(),pe)?n.setStyle(je,pe,_e):n.setAttrib(je,pe,""+_e)})}},Ne=(U,pe,_e)=>{me(U,"width",pe),me(U,"height",_e)},Ie=U=>{let pe,_e,Me,je,he;pe=U.screenX-u,_e=U.screenY-d,x=pe*c[2]+h,N=_e*c[3]+C,x=x<5?5:x,N=N<5?5:N,(F(a)||D(a))&&ER(t)!==!1?Me=!te.modifierPressed(U):Me=te.modifierPressed(U),Me&&(Ey(pe)>Ey(_e)?(N=Zl(x*w),x=Zl(N/w)):(x=Zl(N/w),N=Zl(x*w))),Ne(i,x,N),je=c.startPos.x+pe,he=c.startPos.y+_e,je=je>0?je:0,he=he>0?he:0,n.setStyles(l,{left:je,top:he,display:"block"}),l.innerHTML=x+" &times; "+N,c[2]<0&&i.clientWidth<=x&&n.setStyle(i,"left",v+(h-x)),c[3]<0&&i.clientHeight<=N&&n.setStyle(i,"top",E+(C-N)),pe=r.scrollWidth-I,_e=r.scrollHeight-oe,pe+_e!==0&&n.setStyles(l,{left:je-pe,top:he-_e}),_||(WP(t,a,h,C,"corner-"+c.name),_=!0)},it=()=>{const U=_;_=!1,U&&(me(a,"width",x),me(a,"height",N)),n.unbind(s,"mousemove",Ie),n.unbind(s,"mouseup",it),o!==s&&(n.unbind(o,"mousemove",Ie),n.unbind(o,"mouseup",it)),n.remove(i),n.remove(l),n.remove(f),Lt(a),U&&(VP(t,a,x,N,"corner-"+c.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),t.nodeChanged()},Lt=U=>{xe();const pe=n.getPos(U,r),_e=pe.x,Me=pe.y,je=U.getBoundingClientRect(),he=je.width||je.right-je.left,Re=je.height||je.bottom-je.top;a!==U&&(H(),a=U,x=N=0);const ft=t.dispatch("ObjectSelected",{target:U});ee(U)&&!ft.isDefaultPrevented()?Je(pd,(We,ot)=>{const ct=mt=>{const Hn=K(a)[0];u=mt.screenX,d=mt.screenY,h=Hn.clientWidth,C=Hn.clientHeight,w=C/h,c=We,c.name=ot,c.startPos={x:he*We[0]+_e,y:Re*We[1]+Me},I=r.scrollWidth,oe=r.scrollHeight,f=n.add(r,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(f,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=ge(a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:_e,top:Me,margin:0}),Ne(i,he,Re),i.removeAttribute(rr),r.appendChild(i),n.bind(s,"mousemove",Ie),n.bind(s,"mouseup",it),o!==s&&(n.bind(o,"mousemove",Ie),n.bind(o,"mouseup",it)),l=n.add(r,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},h+" &times; "+C)};let Xe=n.get("mceResizeHandle"+ot);Xe&&n.remove(Xe),Xe=n.add(r,"div",{id:"mceResizeHandle"+ot,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+ot+"-resize; margin:0; padding:0"}),n.bind(Xe,"mousedown",mt=>{mt.stopImmediatePropagation(),mt.preventDefault(),ct(mt)}),We.elm=Xe,n.setStyles(Xe,{left:he*We[0]+_e-Xe.offsetWidth/2,top:Re*We[1]+Me-Xe.offsetHeight/2})}):H(!1)},yt=Ol(Lt,0),H=(U=!0)=>{yt.cancel(),xe(),a&&U&&a.removeAttribute(rr),Je(pd,(pe,_e)=>{const Me=n.get("mceResizeHandle"+_e);Me&&(n.unbind(Me),n.remove(Me))})},re=(U,pe)=>n.isChildOf(U,pe),Ae=U=>{if(_||t.removed||t.composing)return;const pe=U.type==="mousedown"?U.target:e.getNode(),_e=Uo(S.fromDom(pe),sO).map(je=>je.dom).filter(je=>n.isEditable(je.parentElement)).getOrUndefined(),Me=G(_e)?n.getAttrib(_e,rr,"1"):"1";if(M(n.select(`img[${rr}],hr[${rr}]`),je=>{je.removeAttribute(rr)}),G(_e)&&re(_e,r)&&t.hasFocus()){ae();const je=e.getStart(!0);if(re(je,_e)&&re(e.getEnd(!0),_e)){n.setAttrib(_e,rr,Me),yt.throttle(_e);return}}H()},xe=()=>{Je(pd,U=>{U.elm&&(n.unbind(U.elm),delete U.elm)})},ae=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch{}};return t.on("init",()=>{ae(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",Ae),t.on("keyup compositionend",U=>{a&&a.nodeName==="TABLE"&&Ae(U)}),t.on("hide blur",H),t.on("contextmenu longpress",q,!0)}),t.on("remove",xe),{isResizable:ee,showResizeRect:Lt,hideResizeRect:H,updateResizeRect:Ae,destroy:()=>{yt.cancel(),a=i=f=null}}},rO=(e,t)=>{t.fold(n=>{e.setStartBefore(n.dom)},(n,s)=>{e.setStart(n.dom,s)},n=>{e.setStartAfter(n.dom)})},aO=(e,t)=>{t.fold(n=>{e.setEndBefore(n.dom)},(n,s)=>{e.setEnd(n.dom,s)},n=>{e.setEndAfter(n.dom)})},wy=(e,t,n)=>{const s=e.document.createRange();return rO(s,t),aO(s,n),s},gd=(e,t,n,s,o)=>{const r=e.document.createRange();return r.setStart(t.dom,n),r.setEnd(s.dom,o),r},gi=ks.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),_y=(e,t,n)=>t(S.fromDom(n.startContainer),n.startOffset,S.fromDom(n.endContainer),n.endOffset),iO=(e,t)=>t.match({domRange:n=>({ltr:Y(n),rtl:m.none}),relative:(n,s)=>({ltr:Fo(()=>wy(e,n,s)),rtl:Fo(()=>m.some(wy(e,s,n)))}),exact:(n,s,o,r)=>({ltr:Fo(()=>gd(e,n,s,o,r)),rtl:Fo(()=>m.some(gd(e,o,r,n,s)))})}),lO=(e,t)=>{const n=t.ltr();return n.collapsed?t.rtl().filter(o=>o.collapsed===!1).map(o=>gi.rtl(S.fromDom(o.endContainer),o.endOffset,S.fromDom(o.startContainer),o.startOffset)).getOrThunk(()=>_y(e,gi.ltr,n)):_y(e,gi.ltr,n)},cO=(e,t)=>{const n=iO(e,t);return lO(e,n)};gi.ltr,gi.rtl;const xy={create:(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s})},uO=(e,t,n)=>{var s,o;return m.from((o=(s=e.dom).caretPositionFromPoint)===null||o===void 0?void 0:o.call(s,t,n)).bind(r=>{if(r.offsetNode===null)return m.none();const a=e.dom.createRange();return a.setStart(r.offsetNode,r.offset),a.collapse(),m.some(a)})},fO=(e,t,n)=>{var s,o;return m.from((o=(s=e.dom).caretRangeFromPoint)===null||o===void 0?void 0:o.call(s,t,n))},dO=(()=>document.caretPositionFromPoint?uO:document.caretRangeFromPoint?fO:m.none)(),mO=(e,t,n)=>{const s=S.fromDom(e.document);return dO(s,t,n).map(o=>xy.create(S.fromDom(o.startContainer),o.startOffset,S.fromDom(o.endContainer),o.endOffset))},hd=ks.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),pO=(e,t,n,s)=>e.fold(t,n,s),gO=e=>e.fold(Kt,Kt,Kt),hO=hd.before,bO=hd.on,vO=hd.after,Xs={before:hO,on:bO,after:vO,cata:pO,getStart:gO},Ql=ks.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),yO=e=>Ql.exact(e.start,e.soffset,e.finish,e.foffset),CO=e=>e.match({domRange:t=>S.fromDom(t.startContainer),relative:(t,n)=>Xs.getStart(t),exact:(t,n,s,o)=>t}),EO=Ql.domRange,SO=Ql.relative,wO=Ql.exact,_O=e=>{const t=CO(e);return Ba(t)},xO=xy.create,Jr={domRange:EO,relative:SO,exact:wO,exactFromRange:yO,getWin:_O,range:xO},Jl=(e,t)=>{const n=et(e);return n==="input"?Xs.after(e):Ve(["br","img"],n)?t===0?Xs.before(e):Xs.after(e):Xs.on(e,t)},kO=(e,t)=>{const n=e.fold(Xs.before,Jl,Xs.after),s=t.fold(Xs.before,Jl,Xs.after);return Jr.relative(n,s)},ky=(e,t,n,s)=>{const o=Jl(e,t),r=Jl(n,s);return Jr.relative(o,r)},NO=e=>e.match({domRange:t=>{const n=S.fromDom(t.startContainer),s=S.fromDom(t.endContainer);return ky(n,t.startOffset,s,t.endOffset)},relative:kO,exact:ky}),bd=(e,t)=>{const s=(t||document).createDocumentFragment();return M(e,o=>{s.appendChild(o.dom)}),S.fromDom(s)},AO=e=>{const t=Jr.getWin(e).dom,n=(o,r,a,i)=>gd(t,o,r,a,i),s=NO(e);return cO(t,s).match({ltr:n,rtl:n})},TO=(e,t,n)=>mO(e,t,n),Ny=(e,t,n)=>{const s=Ba(S.fromDom(n));return TO(s.dom,e,t).map(o=>{const r=n.createRange();return r.setStart(o.start.dom,o.soffset),r.setEnd(o.finish.dom,o.foffset),r}).getOrUndefined()},vd=(e,t)=>G(e)&&G(t)&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,DO=(e,t,n)=>{let s=e;for(;s&&s!==t;){if(n(s))return s;s=s.parentNode}return null},Ay=(e,t,n)=>DO(e,t,n)!==null,RO=(e,t,n)=>Ay(e,t,s=>s.nodeName===n),PO=(e,t)=>Bn(e)&&!Ay(e,t,Jn),Ty=(e,t,n)=>{const s=t.parentNode;if(s){const o=new xt(t,e.getParent(s,e.isBlock)||e.getRoot());let r;for(;r=o[n?"prev":"next"]();)if(dt(r))return!0}return!1},OO=(e,t)=>{var n;return((n=e.previousSibling)===null||n===void 0?void 0:n.nodeName)===t},BO=(e,t)=>{let n=t;for(;n&&n!==e;){if(tt(n))return!0;n=n.parentNode}return!1},yd=(e,t,n,s,o)=>{const r=e.getRoot(),a=e.schema.getNonEmptyElements(),i=o.parentNode;let l,c;if(!i)return m.none();const f=e.getParent(i,e.isBlock)||r;if(s&&dt(o)&&t&&e.isEmpty(f))return m.some(P(i,e.nodeIndex(o)));const u=new xt(o,f);for(;c=u[s?"prev":"next"]();){if(e.getContentEditableParent(c)==="false"||PO(c,r))return m.none();if(z(c)&&c.data.length>0)return RO(c,r,"A")?m.none():m.some(P(c,s?c.data.length:0));if(e.isBlock(c)||a[c.nodeName.toLowerCase()])return m.none();l=c}return lo(l)?m.none():n&&l?m.some(P(l,0)):m.none()},Dy=(e,t,n,s)=>{const o=e.getRoot();let r,a=!1,i=n?s.startContainer:s.endContainer,l=n?s.startOffset:s.endOffset;const c=Q(i)&&l===i.childNodes.length,f=e.schema.getNonEmptyElements();let u=n;if(Bn(i))return m.none();if(Q(i)&&l>i.childNodes.length-1&&(u=!1),Ua(i)&&(i=o,l=0),i===o){if(u&&(r=i.childNodes[l>0?l-1:0],r&&(Bn(r)||f[r.nodeName]||Ks(r))))return m.none();if(i.hasChildNodes()){if(l=Math.min(!u&&l>0?l-1:l,i.childNodes.length-1),i=i.childNodes[l],l=z(i)&&c?i.data.length:0,!t&&i===o.lastChild&&Ks(i)||BO(o,i)||Bn(i))return m.none();if(i.hasChildNodes()&&!Ks(i)){r=i;const d=new xt(i,o);do{if(tt(r)||Bn(r)){a=!1;break}if(z(r)&&r.data.length>0){l=u?0:r.data.length,i=r,a=!0;break}if(f[r.nodeName.toLowerCase()]&&!_A(r)){l=e.nodeIndex(r),i=r.parentNode,u||l++,a=!0;break}}while(r=u?d.next():d.prev())}}}return t&&(z(i)&&l===0&&yd(e,c,t,!0,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),Q(i)&&(r=i.childNodes[l],r||(r=i.childNodes[l-1]),r&&dt(r)&&!OO(r,"A")&&!Ty(e,r,!1)&&!Ty(e,r,!0)&&yd(e,c,t,!0,r).each(d=>{i=d.container(),l=d.offset(),a=!0}))),u&&!t&&z(i)&&l===i.data.length&&yd(e,c,t,!1,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),a&&i?m.some(P(i,l)):m.none()},ec=(e,t)=>{const n=t.collapsed,s=t.cloneRange(),o=P.fromRangeStart(t);return Dy(e,n,!0,s).each(r=>{(!n||!P.isAbove(o,r))&&s.setStart(r.container(),r.offset())}),n||Dy(e,n,!1,s).each(r=>{s.setEnd(r.container(),r.offset())}),n&&s.collapse(!0),vd(t,s)?m.none():m.some(s)},tc=(e,t)=>e.splitText(t),nc=e=>{let t=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset;if(t===s&&z(t)){if(n>0&&n<t.data.length)if(s=tc(t,n),t=s.previousSibling,o>n){o=o-n;const r=tc(s,o).previousSibling;t=s=r,o=r.data.length,n=0}else o=0}else if(z(t)&&n>0&&n<t.data.length&&(t=tc(t,n),n=0),z(s)&&o>0&&o<s.data.length){const r=tc(s,o).previousSibling;s=r,o=r.data.length}return{startContainer:t,startOffset:n,endContainer:s,endOffset:o}},ar=e=>({walk:(r,a)=>mi(e,r,a),split:nc,expand:(r,a={type:"word"})=>{if(a.type==="word"){const i=or(e,r,[{inline:"span"}]),l=e.createRng();return l.setStart(i.startContainer,i.startOffset),l.setEnd(i.endContainer,i.endOffset),l}return r},normalize:r=>ec(e,r).fold(lt,a=>(r.setStart(a.startContainer,a.startOffset),r.setEnd(a.endContainer,a.endOffset),!0))});ar.compareRanges=vd,ar.getCaretRangeFromPoint=Ny,ar.getSelectedNode=Bl,ar.getNode=ho;const IO=((e,t)=>{const n=(i,l)=>{if(!Tt(l)&&!l.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+l);const c=i.dom;$a(c)&&(c.style[e]=l+"px")},s=i=>{const l=t(i);if(l<=0||l===null){const c=_s(i,e);return parseFloat(c)||0}return l},o=s,r=(i,l)=>Sn(l,(c,f)=>{const u=_s(i,f),d=u===void 0?0:parseInt(u,10);return isNaN(d)?c:c+d},0);return{set:n,get:s,getOuter:o,aggregate:r,max:(i,l,c)=>{const f=r(i,c);return l>f?l-f:0}}})("height",e=>{const t=e.dom;return Br(e)?t.getBoundingClientRect().height:t.offsetHeight}),FO=e=>IO.get(e),Ry=()=>S.fromDom(document),Py=(e,t)=>e.view(t).fold(Y([]),s=>{const o=e.owner(s),r=Py(e,o);return[s].concat(r)}),LO=(e,t)=>{const n=t.owner(e);return Py(t,n)};var $O=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?m.none():m.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(S.fromDom)},owner:e=>Vs(e)});const MO=e=>{const t=Ry(),n=rf(t),s=LO(e,$O),o=of(e),r=_a(s,(a,i)=>{const l=of(i);return{left:a.left+l.left,top:a.top+l.top}},{left:0,top:0});return Lr(r.left+o.left+n.left,r.top+o.top+n.top)},Cd=e=>et(e)==="textarea",UO=(e,t)=>e.dispatch("ScrollIntoView",t).isDefaultPrevented(),zO=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},HO=(e,t)=>{const n=Ht(e);if(n.length===0||Cd(e))return{element:e,offset:t};if(t<n.length&&!Cd(n[t]))return{element:n[t],offset:0};{const s=n[n.length-1];return Cd(s)?{element:e,offset:t}:et(s)==="img"?{element:s,offset:1}:Rn(s)?{element:s,offset:vl(s).length}:{element:s,offset:Ht(s).length}}},Oy=(e,t)=>{const n=bA(e),s=FO(e);return{element:e,bottom:n.top+s,height:s,pos:n,cleanup:t}},WO=(e,t)=>{const n=HO(e,t),s=S.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+Wt+"</span>");return _n(n.element,s),Oy(s,()=>at(s))},VO=e=>Oy(S.fromDom(e),Ee),By=(e,t,n,s)=>{jO(e,(o,r)=>qO(e,t,n,s),n)},Iy=(e,t,n,s,o)=>{const r={elm:s.element.dom,alignToTop:o};if(UO(e,r))return;const a=rf(t).top;n(t,a,s,o),zO(e,r)},qO=(e,t,n,s)=>{const o=S.fromDom(e.getBody()),r=S.fromDom(e.getDoc());aA(o);const a=WO(S.fromDom(n.startContainer),n.startOffset);Iy(e,r,t,a,s),a.cleanup()},Fy=(e,t,n,s)=>{const o=S.fromDom(e.getDoc());Iy(e,o,n,VO(t),s)},jO=(e,t,n)=>{const s=n.startContainer,o=n.startOffset,r=n.endContainer,a=n.endOffset;t(S.fromDom(s),S.fromDom(r));const i=e.dom.createRng();i.setStart(s,o),i.setEnd(r,a),e.selection.setRng(n)},Ed=(e,t)=>e.element.dom.scrollIntoView({block:t?"start":"end"}),Ly=(e,t,n,s)=>{const o=t+e,r=n.pos.top,a=n.bottom,i=a-r>=t;r<e?Ed(n,s!==!1):r>o?Ed(n,i?s!==!1:s===!0):a>o&&!i&&Ed(n,s===!0)},$y=(e,t,n,s)=>{const o=Ba(e).dom.innerHeight;Ly(t,o,n,s)},My=(e,t,n,s)=>{const o=Ba(e).dom.innerHeight;Ly(t,o,n,s);const r=MO(n.element),a=Ih(window);r.top<a.y?Oh(n.element,s!==!1):r.top>a.bottom&&Oh(n.element,s===!0)},KO=(e,t,n)=>By(e,$y,t,n),GO=(e,t,n)=>Fy(e,t,$y,n),YO=(e,t,n)=>By(e,My,t,n),XO=(e,t,n)=>Fy(e,t,My,n),ZO=(e,t,n)=>{(e.inline?GO:XO)(e,t,n)},hi=(e,t,n)=>{(e.inline?KO:YO)(e,t,n)},Uy=e=>e.dom.focus(),zy=e=>{const t=ao(e).dom;return e.dom===t.activeElement},Sd=(e=Ry())=>m.from(e.dom.activeElement).map(S.fromDom),QO=e=>Sd(ao(e)).filter(t=>e.dom.contains(t.dom)),Hy=(e,t)=>{const n=Rn(t)?vl(t).length:Ht(t).length+1;return e>n?n:e<0?0:e},JO=e=>Jr.range(e.start,Hy(e.soffset,e.start),e.finish,Hy(e.foffset,e.finish)),Wy=(e,t)=>!gl(t.dom)&&(Ws(e,t)||ze(e,t)),Vy=e=>t=>Wy(e,t.start)&&Wy(e,t.finish),eB=e=>e.inline||Fe.browser.isFirefox(),tB=e=>Jr.range(S.fromDom(e.startContainer),e.startOffset,S.fromDom(e.endContainer),e.endOffset),nB=e=>{const t=e.getSelection();return(!t||t.rangeCount===0?m.none():m.from(t.getRangeAt(0))).map(tB)},sB=e=>{const t=Ba(e);return nB(t.dom).filter(Vy(e))},oB=(e,t)=>m.from(t).filter(Vy(e)).map(JO),rB=e=>{const t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),m.some(t)}catch{return m.none()}},wd=e=>{const t=eB(e)?sB(S.fromDom(e.getBody())):m.none();e.bookmark=t.isSome()?t:e.bookmark},_d=e=>(e.bookmark?e.bookmark:m.none()).bind(n=>oB(S.fromDom(e.getBody()),n)).bind(rB),aB=e=>{_d(e).each(t=>e.selection.setRng(t))},qy={isEditorUIElement:e=>{const t=e.className.toString();return t.indexOf("tox-")!==-1||t.indexOf("mce-")!==-1}},iB=(e,t)=>(Tt(t)||(t=0),setTimeout(e,t)),lB=(e,t)=>(Tt(t)||(t=0),setInterval(e,t)),$n={setEditorTimeout:(e,t,n)=>iB(()=>{e.removed||t()},n),setEditorInterval:(e,t,n)=>{const s=lB(()=>{e.removed?clearInterval(s):t()},n);return s}},cB=e=>e.type==="nodechange"&&e.selectionChange,uB=(e,t)=>{const n=()=>{t.throttle()};qe.DOM.bind(document,"mouseup",n),e.on("remove",()=>{qe.DOM.unbind(document,"mouseup",n)})},fB=(e,t)=>{e.on("mouseup touchend",n=>{t.throttle()})},dB=(e,t)=>{fB(e,t),e.on("keyup NodeChange AfterSetSelectionRange",n=>{cB(n)||wd(e)})},mB=e=>{const t=Ol(()=>{wd(e)},0);e.on("init",()=>{e.inline&&uB(e,t),dB(e,t)}),e.on("remove",()=>{t.cancel()})};let ea;const xd=qe.DOM,pB=e=>Q(e)&&qy.isEditorUIElement(e),kd=e=>{const t=e.classList;return t!==void 0?t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"):!1},sc=(e,t)=>{const n=DR(e);return xd.getParent(t,o=>pB(o)||(n?e.dom.is(o,n):!1))!==null},Nd=e=>{try{const t=ao(S.fromDom(e.getElement()));return Sd(t).fold(()=>document.body,n=>n.dom)}catch{return document.body}},gB=(e,t)=>{const n=t.editor;mB(n);const s=(o,r)=>{if(f1(o)&&o.inline!==!0){const a=S.fromDom(o.getContainer());r(a,"tox-edit-focus")}};n.on("focusin",()=>{const o=e.focusedEditor;kd(Nd(n))&&s(n,Rr),o!==n&&(o&&o.dispatch("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.dispatch("focus",{blurredEditor:o}),n.focus(!0))}),n.on("focusout",()=>{$n.setEditorTimeout(n,()=>{const o=e.focusedEditor;(!kd(Nd(n))||o!==n)&&s(n,Pr),!sc(n,Nd(n))&&o===n&&(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})}),ea||(ea=o=>{const r=e.activeEditor;r&&Sh(o).each(a=>{const i=a;i.ownerDocument===document&&i!==document.body&&!sc(r,i)&&e.focusedEditor===r&&(r.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})},xd.bind(document,"focusin",ea))},hB=(e,t)=>{e.focusedEditor===t.editor&&(e.focusedEditor=null),!e.activeEditor&&ea&&(xd.unbind(document,"focusin",ea),ea=null)},bB=e=>{e.on("AddEditor",ne(gB,e)),e.on("RemoveEditor",ne(hB,e))},vB=(e,t)=>e.dom.getParent(t,n=>e.dom.getContentEditable(n)==="true"),yB=e=>e.collapsed?m.from(ho(e.startContainer,e.startOffset)).map(S.fromDom):m.none(),CB=(e,t)=>yB(t).bind(n=>MA(n)?m.some(n):Ws(e,n)?m.none():m.some(e)),jy=(e,t)=>{CB(S.fromDom(e.getBody()),t).bind(n=>Jt(n.dom)).fold(()=>{e.selection.normalize()},n=>e.selection.setRng(n.toRange()))},Ad=e=>{if(e.setActive)try{e.setActive()}catch{e.focus()}else e.focus()},EB=e=>zy(e)||QO(e).isSome(),SB=e=>G(e.iframeElement)&&zy(S.fromDom(e.iframeElement)),wB=e=>{const t=e.getBody();return t&&EB(S.fromDom(t))},_B=e=>{const t=ao(S.fromDom(e.getElement()));return Sd(t).filter(n=>!kd(n.dom)&&sc(e,n.dom)).isSome()},ir=e=>e.inline?wB(e):SB(e),xB=e=>ir(e)||_B(e),kB=e=>{const t=e.selection,n=e.getBody();let s=t.getRng();e.quirks.refreshContentEditable(),G(e.bookmark)&&!ir(e)&&_d(e).each(r=>{e.selection.setRng(r),s=r});const o=vB(e,t.getNode());if(o&&e.dom.isChildOf(o,n)){Ad(o),jy(e,s),Td(e);return}e.inline||(Fe.browser.isOpera()||Ad(n),e.getWin().focus()),(Fe.browser.isFirefox()||e.inline)&&(Ad(n),jy(e,s)),Td(e)},Td=e=>e.editorManager.setActive(e),NB=(e,t)=>{e.removed||(t?Td(e):kB(e))},Ky=(e,t,n,s,o)=>{const r=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return m.from(r).map(S.fromDom).map(i=>!s||!t.collapsed?Or(i,o(i,a)).getOr(i):i).bind(i=>bn(i)?m.some(i):Xn(i).filter(bn)).map(i=>i.dom).getOr(e)},Gy=(e,t,n=!1)=>Ky(e,t,!0,n,(s,o)=>Math.min(ef(s),o)),Yy=(e,t,n=!1)=>Ky(e,t,!1,n,(s,o)=>o>0?o-1:o),Xy=(e,t)=>{const n=e;for(;e&&z(e)&&e.length===0;)e=t?e.nextSibling:e.previousSibling;return e||n},AB=(e,t)=>{if(!t)return e;let n=t.startContainer,s=t.endContainer;const o=t.startOffset,r=t.endOffset;let a=t.commonAncestorContainer;t.collapsed||(n===s&&r-o<2&&n.hasChildNodes()&&(a=n.childNodes[o]),z(n)&&z(s)&&(n.length===o?n=Xy(n.nextSibling,!0):n=n.parentNode,r===0?s=Xy(s.previousSibling,!1):s=s.parentNode,n&&n===s&&(a=n)));const i=z(a)?a.parentNode:a;return Q(i)?i:e},TB=(e,t,n,s)=>{const o=[],r=e.getRoot(),a=e.getParent(n||Gy(r,t,t.collapsed),e.isBlock),i=e.getParent(s||Yy(r,t,t.collapsed),e.isBlock);if(a&&a!==r&&o.push(a),a&&i&&a!==i){let l;const c=new xt(a,r);for(;(l=c.next())&&l!==i;)e.isBlock(l)&&o.push(l)}return i&&a!==i&&i!==r&&o.push(i),o},DB=(e,t,n)=>m.from(t).bind(s=>m.from(s.parentNode).map(o=>{const r=e.nodeIndex(s),a=e.createRng();return a.setStart(o,r),a.setEnd(o,r+1),n&&(rd(e,a,s,!0),rd(e,a,s,!1)),a})),Dd=(e,t)=>Ue(t,n=>{const s=e.dispatch("GetSelectionRange",{range:n});return s.range!==n?s.range:n}),RB=e=>et(e)==="img"?1:Hh(e).fold(()=>Ht(e).length,t=>t.length),PB=e=>Hh(e).filter(t=>t.trim().length!==0||t.indexOf(Dt)>-1).isSome(),OB=e=>Ku(e)&&Pn(e,"contenteditable")==="false",BB=["img","br"],Zy=e=>PB(e)||Ve(BB,et(e))||OB(e),IB=e=>nA(e,Zy),FB=e=>LB(e,Zy),LB=(e,t)=>{const n=s=>{const o=Ht(s);for(let r=o.length-1;r>=0;r--){const a=o[r];if(t(a))return m.some(a);const i=n(a);if(i.isSome())return i}return m.none()};return n(e)},Qy="[data-mce-autocompleter]",$B=(e,t)=>{if(Jy(S.fromDom(e.getBody())).isNone()){const n=S.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',e.getDoc());bt(n,S.fromDom(t.extractContents())),t.insertNode(n.dom),Xn(n).each(s=>s.dom.normalize()),FB(n).map(s=>{e.selection.setCursorLocation(s.dom,RB(s))})}},MB=e=>Uo(e,Qy),Jy=e=>La(e,Qy),UB=(e,t)=>Jy(t).each(n=>{const s=e.selection.getBookmark();js(n),e.selection.moveToBookmark(s)}),zB={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},oc=(e,t,n)=>{const s=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[s])return e[s];if(e!==t){let r=e[o];if(r)return r;for(let a=e.parent;a&&a!==t;a=a.parent)if(r=a[o],r)return r}},HB=e=>{var t;const n=(t=e.value)!==null&&t!==void 0?t:"";if(!qo(n))return!1;const s=e.parent;return!(s&&(s.name!=="span"||s.attr("style"))&&/^[ ]+$/.test(n))},eC=e=>{const t=e.name==="a"&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class fn{static create(t,n){const s=new fn(t,zB[t]||1);return n&&Je(n,(o,r)=>{s.attr(r,o)}),s}constructor(t,n){this.name=t,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}replace(t){const n=this;return t.parent&&t.remove(),n.insert(t,n),n.remove(),n}attr(t,n){const s=this;if(!ce(t))return G(t)&&Je(t,(r,a)=>{s.attr(a,r)}),s;const o=s.attributes;if(o){if(n!==void 0){if(n===null){if(t in o.map){delete o.map[t];let r=o.length;for(;r--;)if(o[r].name===t)return o.splice(r,1),s}return s}if(t in o.map){let r=o.length;for(;r--;)if(o[r].name===t){o[r].value=n;break}}else o.push({name:t,value:n});return o.map[t]=n,s}return o.map[t]}}clone(){const t=this,n=new fn(t.name,t.type),s=t.attributes;if(s){const o=[];o.map={};for(let r=0,a=s.length;r<a;r++){const i=s[r];i.name!=="id"&&(o[o.length]={name:i.name,value:i.value},o.map[i.name]=i.value)}n.attributes=o}return n.value=t.value,n}wrap(t){const n=this;return n.parent&&(n.parent.insert(t,n),t.append(n)),n}unwrap(){const t=this;for(let n=t.firstChild;n;){const s=n.next;t.insert(n,t,!0),n=s}t.remove()}remove(){const t=this,n=t.parent,s=t.next,o=t.prev;return n&&(n.firstChild===t?(n.firstChild=s,s&&(s.prev=null)):o&&(o.next=s),n.lastChild===t?(n.lastChild=o,o&&(o.next=null)):s&&(s.prev=o),t.parent=t.next=t.prev=null),t}append(t){const n=this;t.parent&&t.remove();const s=n.lastChild;return s?(s.next=t,t.prev=s,n.lastChild=t):n.lastChild=n.firstChild=t,t.parent=n,t}insert(t,n,s){t.parent&&t.remove();const o=n.parent||this;return s?(n===o.firstChild?o.firstChild=t:n.prev&&(n.prev.next=t),t.prev=n.prev,t.next=n,n.prev=t):(n===o.lastChild?o.lastChild=t:n.next&&(n.next.prev=t),t.next=n.next,t.prev=n,n.next=t),t.parent=o,t}getAll(t){const n=this,s=[];for(let o=n.firstChild;o;o=oc(o,n))o.name===t&&s.push(o);return s}children(){const t=this,n=[];for(let s=t.firstChild;s;s=s.next)n.push(s);return n}empty(){const t=this;if(t.firstChild){const n=[];for(let o=t.firstChild;o;o=oc(o,t))n.push(o);let s=n.length;for(;s--;){const o=n[s];o.parent=o.firstChild=o.lastChild=o.next=o.prev=null}}return t.firstChild=t.lastChild=null,t}isEmpty(t,n={},s){var o;const r=this;let a=r.firstChild;if(eC(r))return!1;if(a)do{if(a.type===1){if(a.attr("data-mce-bogus"))continue;if(t[a.name]||eC(a))return!1}if(a.type===8||a.type===3&&!HB(a)||a.type===3&&a.parent&&n[a.parent.name]&&qo((o=a.value)!==null&&o!==void 0?o:"")||s&&s(a))return!1}while(a=oc(a,r));return!0}walk(t){return oc(this,null,t)}}const WB=(e,t)=>/^\s*\[if [\w\W]+\]>.*<!\[endif\](--!?)?>/.test(e.substr(t)),tC=(e,t,n=0)=>{const s=e.toLowerCase();if(s.indexOf("[if ",n)!==-1&&WB(s,n)){const o=s.indexOf("[endif]",n);return s.indexOf(">",o)}else if(t){const o=s.indexOf(">",n);return o!==-1?o:s.length}else{const o=/--!?>/g;o.lastIndex=n;const r=o.exec(e);return r?r.index+r[0].length:s.length}},VB=(e,t,n)=>{const s=/<([!?\/])?([A-Za-z0-9\-_:.]+)/g,o=/(?:\s(?:[^'">]+(?:"[^"]*"|'[^']*'))*[^"'>]*(?:"[^">]*|'[^'>]*)?|\s*|\/)>/g,r=e.getVoidElements();let a=1,i=n;for(;a!==0;)for(s.lastIndex=i;;){const l=s.exec(t);if(l===null)return i;if(l[1]==="!"){Ut(l[2],"--")?i=tC(t,!1,l.index+3):i=tC(t,!0,l.index+1);break}else{o.lastIndex=s.lastIndex;const c=o.exec(t);if(Et(c)||c.index!==s.lastIndex)continue;l[1]==="/"?a-=1:Se(r,l[2])||(a+=1),i=s.lastIndex+c[0].length;break}}return i},qB=(e,t)=>{const n=new RegExp(["\\s?("+e.join("|")+')="[^"]+"'].join("|"),"gi");return t.replace(n,"")},nC=(e,t)=>{const n=/<(\w+) [^>]*data-mce-bogus="all"[^>]*>/g,s=e.schema;let o=qB(e.getTempAttrs(),t);const r=s.getVoidElements();let a;for(;a=n.exec(o);){const i=n.lastIndex,l=a[0].length;let c;r[a[1]]?c=i:c=VB(s,o,i),o=o.substring(0,i-l)+o.substring(c),n.lastIndex=i-l}return Gs(o)},jB=nC,sC=e=>{const t=Yt(e,"[data-mce-bogus]");M(t,n=>{Pn(n,"data-mce-bogus")==="all"?at(n):Vo(n)?(_n(n,S.fromText($r)),at(n)):js(n)})},oC=e=>{const t=Yt(e,"input");M(t,n=>{zt(n,"name")})},KB=(e,t)=>{const n=cn(e),s=new RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s||<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return t.replace(s,"")},GB=(e,t)=>{const n=e.getDoc(),s=ao(S.fromDom(e.getBody())),o=S.fromTag("div",n);It(o,"data-mce-bogus","all"),fl(o,{position:"fixed",left:"-9999999px",top:"0"}),ml(o,t.innerHTML),sC(o),oC(o);const r=XN(s);bt(r,o);const a=Gs(o.dom.innerText);return at(o),a},YB=(e,t,n)=>{let s;return t.format==="raw"?s=V.trim(jB(e.serializer,n.innerHTML)):t.format==="text"?s=GB(e,n):t.format==="tree"?s=e.serializer.serialize(n,t):s=KB(e,e.serializer.serialize(n,t)),t.format!=="text"&&!Cl(S.fromDom(n))&&ce(s)?V.trim(s):s},XB=(e,t)=>m.from(e.getBody()).fold(Y(t.format==="tree"?new fn("body",11):""),n=>YB(e,t,n)),rC=V.makeMap,aC=e=>{const t=[];e=e||{};const n=e.indent,s=rC(e.indent_before||""),o=rC(e.indent_after||""),r=mo.getEncodeFunc(e.entity_encoding||"raw",e.entities),a=e.element_format!=="xhtml";return{start:(i,l,c)=>{if(n&&s[i]&&t.length>0){const f=t[t.length-1];f.length>0&&f!==`
`&&t.push(`
`)}if(t.push("<",i),l)for(let f=0,u=l.length;f<u;f++){const d=l[f];t.push(" ",d.name,'="',r(d.value,!0),'"')}if(!c||a?t[t.length]=">":t[t.length]=" />",c&&n&&o[i]&&t.length>0){const f=t[t.length-1];f.length>0&&f!==`
`&&t.push(`
`)}},end:i=>{let l;t.push("</",i,">"),n&&o[i]&&t.length>0&&(l=t[t.length-1],l.length>0&&l!==`
`&&t.push(`
`))},text:(i,l)=>{i.length>0&&(t[t.length]=l?i:r(i))},cdata:i=>{t.push("<![CDATA[",i,"]]>")},comment:i=>{t.push("<!--",i,"-->")},pi:(i,l)=>{l?t.push("<?",i," ",r(l),"?>"):t.push("<?",i,"?>"),n&&t.push(`
`)},doctype:i=>{t.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},Co=(e={},t=po())=>{const n=aC(e);return e.validate="validate"in e?e.validate:!0,{serialize:o=>{const r=e.validate,a={3:l=>{var c;n.text((c=l.value)!==null&&c!==void 0?c:"",l.raw)},8:l=>{var c;n.comment((c=l.value)!==null&&c!==void 0?c:"")},7:l=>{n.pi(l.name,l.value)},10:l=>{var c;n.doctype((c=l.value)!==null&&c!==void 0?c:"")},4:l=>{var c;n.cdata((c=l.value)!==null&&c!==void 0?c:"")},11:l=>{let c=l;if(c=c.firstChild)do i(c);while(c=c.next)}};n.reset();const i=l=>{var c;const f=a[l.type];if(f)f(l);else{const u=l.name,d=u in t.getVoidElements();let v=l.attributes;if(r&&v&&v.length>1){const E=[];E.map={};const h=t.getElementRule(l.name);if(h){for(let C=0,w=h.attributesOrder.length;C<w;C++){const _=h.attributesOrder[C];if(_ in v.map){const x=v.map[_];E.map[_]=x,E.push({name:_,value:x})}}for(let C=0,w=v.length;C<w;C++){const _=v[C].name;if(!(_ in E.map)){const x=v.map[_];E.map[_]=x,E.push({name:_,value:x})}}v=E}}if(n.start(u,v,d),!d){let E=l.firstChild;if(E){(u==="pre"||u==="textarea")&&E.type===3&&((c=E.value)===null||c===void 0?void 0:c[0])===`
`&&n.text(`
`,!0);do i(E);while(E=E.next)}n.end(u)}}};return o.type===1&&!e.inner?i(o):o.type===3?a[3](o):a[11](o),n.getContent()}}},iC=new Set;M(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{iC.add(t)});const lC=["font","text-decoration","text-emphasis"],Rd=(e,t)=>wn(e.parseStyle(e.getAttrib(t,"style"))),ZB=e=>iC.has(e),QB=(e,t)=>oo(Rd(e,t),n=>!ZB(n)),JB=e=>ve(e,t=>ht(lC,n=>Ut(t,n))),eI=(e,t,n)=>{const s=Rd(e,t),o=Rd(e,n),r=a=>{var i,l;const c=(i=e.getStyle(t,a))!==null&&i!==void 0?i:"",f=(l=e.getStyle(n,a))!==null&&l!==void 0?l:"";return Cs(c)&&Cs(f)&&c!==f};return ht(s,a=>{const i=l=>ht(l,c=>c===a);if(!i(o)&&i(lC)){const l=JB(o);return ht(l,r)}else return r(a)})},cC=(e,t,n)=>m.from(n.container()).filter(z).exists(s=>{const o=e?0:-1;return t(s.data.charAt(n.offset()+o))}),Pd=ne(cC,!0,Yr),Od=ne(cC,!1,Yr),tI=e=>{const t=e.container();return z(t)&&(t.data.length===0||Sl(t.data)&&pi.isBookmarkNode(t.parentNode))},Eo=(e,t)=>n=>Kf(e?0:-1,n).filter(t).isSome(),uC=e=>Uh(e)&&_s(S.fromDom(e),"display")==="block",fC=e=>tt(e)&&!EA(e),nI=Eo(!0,uC),sI=Eo(!1,uC),bi=Eo(!0,xs),vi=Eo(!1,xs),dC=Eo(!0,Ks),mC=Eo(!1,Ks),So=Eo(!0,fC),wo=Eo(!1,fC),oI=e=>e.slice(0,-1),rI=(e,t,n)=>Ws(t,e)?oI(vh(e,s=>n(s)||ze(s,t))):[],pC=(e,t)=>rI(e,t,lt),Zs=(e,t)=>[e].concat(pC(e,t)),Bd=(e,t,n)=>Uv(e,t,n,tI),gC=(e,t)=>_t(Zs(S.fromDom(t.container()),e),On),hC=(e,t,n)=>Bd(e,t.dom,n).forall(s=>gC(t,n).fold(()=>!Ns(s,n,t.dom),o=>!Ns(s,n,t.dom)&&Ws(o,S.fromDom(s.container())))),bC=(e,t,n)=>gC(t,n).fold(()=>Bd(e,t.dom,n).forall(s=>!Ns(s,n,t.dom)),s=>Bd(e,s.dom,n).isNone()),Id=ne(bC,!1),vC=ne(bC,!0),aI=ne(hC,!1),iI=ne(hC,!0),lI=e=>zl(e).exists(Vo),rc=(e,t,n)=>{const s=ve(Zs(S.fromDom(n.container()),t),On),o=hn(s).getOr(t);return In(e,o.dom,n).filter(lI)},Fd=(e,t)=>zl(t).exists(Vo)||rc(!0,e,t).isSome(),Ld=(e,t)=>M1(t).exists(Vo)||rc(!1,e,t).isSome(),cI=ne(rc,!1),uI=ne(rc,!0),yC=e=>P.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),CC=(e,t)=>{const n=ve(Zs(S.fromDom(t.container()),e),On);return hn(n).getOr(e)},EC=(e,t)=>yC(t)?Od(t):Od(t)||un(CC(e,t).dom,t).exists(Od),SC=(e,t)=>yC(t)?Pd(t):Pd(t)||Qt(CC(e,t).dom,t).exists(Pd),fI=e=>Ve(["pre","pre-wrap"],e),$d=e=>zl(e).bind(t=>Mo(t,bn)).exists(t=>fI(_s(t,"white-space"))),dI=(e,t)=>un(e.dom,t).isNone(),mI=(e,t)=>Qt(e.dom,t).isNone(),pI=(e,t)=>dI(e,t)||mI(e,t)||Id(e,t)||vC(e,t)||Ld(e,t)||Fd(e,t),gI=e=>G(e)&&tt(e)&&Nv(e),wC=(e,t)=>n=>gI(new xt(n,e)[t]()),hI=(e,t)=>{const n=Qt(e.dom,t).getOr(t),s=wC(e.dom,"next");return t.isAtEnd()&&(s(t.container())||s(n.container()))},bI=(e,t)=>{const n=un(e.dom,t).getOr(t),s=wC(e.dom,"prev");return t.isAtStart()&&(s(t.container())||s(n.container()))},_C=(e,t)=>$d(t)?!1:pI(e,t)||EC(e,t)||SC(e,t),yi=(e,t)=>$d(t)?!1:Id(e,t)||aI(e,t)||Ld(e,t)||EC(e,t)||bI(e,t),vI=e=>{const t=e.container(),n=e.offset();return z(t)&&n<t.data.length?P(t,n+1):e},Ci=(e,t)=>$d(t)?!1:vC(e,t)||iI(e,t)||Fd(e,t)||SC(e,t)||hI(e,t),Md=(e,t)=>yi(e,t)||Ci(e,vI(t)),xC=(e,t)=>ql(e.charAt(t)),kC=(e,t)=>Yr(e.charAt(t)),yI=e=>{const t=e.container();return z(t)&&Gt(t.data,Dt)},CI=e=>{const t=e.split("");return Ue(t,(n,s)=>ql(n)&&s>0&&s<t.length-1&&ed(t[s-1])&&ed(t[s+1])?" ":n).join("")},NC=(e,t,n)=>{const s=t.data,o=P(t,0);return!n&&xC(s,0)&&!Md(e,o)?(t.data=" "+s.slice(1),!0):n&&kC(s,0)&&yi(e,o)?(t.data=Dt+s.slice(1),!0):!1},EI=e=>{const t=e.data,n=CI(t);return n!==t?(e.data=n,!0):!1},AC=(e,t,n)=>{const s=t.data,o=P(t,s.length-1);return!n&&xC(s,s.length-1)&&!Md(e,o)?(t.data=s.slice(0,-1)+" ",!0):n&&kC(s,s.length-1)&&Ci(e,o)?(t.data=s.slice(0,-1)+Dt,!0):!1},SI=(e,t)=>{const n=t.container();if(!z(n))return m.none();if(yI(t)){const s=NC(e,n,!1)||EI(n)||AC(e,n,!1);return Dr(s,t)}else if(Md(e,t)){const s=NC(e,n,!0)||AC(e,n,!0);return Dr(s,t)}else return m.none()},wI=e=>{const t=S.fromDom(e.getBody());e.selection.isCollapsed()&&SI(t,P.fromRangeStart(e.selection.getRng())).each(n=>{e.selection.setRng(n.toRange())})},TC=(e,t,n)=>{if(n===0)return;const s=S.fromDom(e),o=qs(s,On).getOr(s),r=e.data.slice(t,t+n),a=t+n>=e.data.length&&Ci(o,P(e,e.data.length)),i=t===0&&yi(o,P(e,0));e.replaceData(t,n,Xh(r,4,i,a))},ac=(e,t)=>{const n=e.data.slice(t),s=n.length-iN(n).length;TC(e,t,s)},Ud=(e,t)=>{const n=e.data.slice(0,t),s=n.length-Ig(n).length;TC(e,t-s,s)},zd=(e,t,n,s=!0)=>{const o=Ig(e.data).length,r=s?e:t,a=s?t:e;return s?r.appendData(a.data):r.insertData(0,a.data),at(S.fromDom(a)),n&&ac(r,o),r},_I=(e,t)=>{const n=e.container(),s=e.offset();return!P.isTextPosition(e)&&n===t.parentNode&&s>P.before(t).offset()},xI=(e,t)=>_I(t,e)?P(t.container(),t.offset()-1):t,kI=e=>z(e)?P(e,0):P.before(e),NI=e=>z(e)?P(e,e.data.length):P.after(e),DC=e=>Zn(e.previousSibling)?m.some(NI(e.previousSibling)):e.previousSibling?Qn(e.previousSibling):m.none(),RC=e=>Zn(e.nextSibling)?m.some(kI(e.nextSibling)):e.nextSibling?Jt(e.nextSibling):m.none(),AI=(e,t)=>m.from(t.previousSibling?t.previousSibling:t.parentNode).bind(n=>un(e,P.before(n))).orThunk(()=>Qt(e,P.after(t))),TI=(e,t)=>Qt(e,P.after(t)).orThunk(()=>un(e,P.before(t))),DI=(e,t)=>DC(t).orThunk(()=>RC(t)).orThunk(()=>AI(e,t)),RI=(e,t)=>RC(t).orThunk(()=>DC(t)).orThunk(()=>TI(e,t)),PI=(e,t,n)=>e?RI(t,n):DI(t,n),OI=(e,t,n)=>PI(e,t,n).map(ne(xI,n)),PC=(e,t,n)=>{n.fold(()=>{e.focus()},s=>{e.selection.setRng(s.toRange(),t)})},BI=e=>t=>t.dom===e,II=(e,t)=>t&&Se(e.schema.getBlockElements(),et(t)),FI=e=>{if(vt(e)){const t=S.fromHtml('<br data-mce-bogus="1">');return Fr(e),bt(e,t),m.some(P.before(t.dom))}else return m.none()},LI=(e,t,n)=>{const s=$o(e).filter(Rn),o=Ia(e).filter(Rn);return at(e),_N(s,o,t,(r,a,i)=>{const l=r.dom,c=a.dom,f=l.data.length;return zd(l,c,n),i.container()===c?P(l,f):i}).orThunk(()=>(n&&(s.each(r=>Ud(r.dom,r.dom.length)),o.each(r=>ac(r.dom,0))),t))},$I=(e,t)=>Se(e.schema.getTextInlineElements(),et(t)),lr=(e,t,n,s=!0)=>{const o=OI(t,e.getBody(),n.dom),r=qs(n,ne(II,e),BI(e.getBody())),a=LI(n,o,$I(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):r.bind(FI).fold(()=>{s&&PC(e,t,a)},i=>{s&&PC(e,t,m.some(i))})},MI=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,UI=e=>MI.test(e),cr=(e,t)=>ss(S.fromDom(t),CR(e))&&!jo(e.schema,t)&&e.dom.isEditable(t),OC=e=>{var t;return qe.DOM.getStyle(e,"direction",!0)==="rtl"||UI((t=e.textContent)!==null&&t!==void 0?t:"")},zI=(e,t,n)=>ve(qe.DOM.getParents(n.container(),"*",t),e),_o=(e,t,n)=>{const s=zI(e,t,n);return m.from(s[s.length-1])},HI=(e,t,n)=>{const s=vo(t,e),o=vo(n,e);return G(s)&&s===o},WI=e=>df(e)||mf(e),Mn=(e,t)=>{const n=t.container(),s=t.offset();return e?fo(n)?z(n.nextSibling)?P(n.nextSibling,0):P.after(n):df(t)?P(n,s+1):t:fo(n)?z(n.previousSibling)?P(n.previousSibling,n.previousSibling.data.length):P.before(n):mf(t)?P(n,s-1):t},BC=ne(Mn,!0),IC=ne(Mn,!1),FC=(e,t)=>{const n=s=>s.stopImmediatePropagation();e.on("beforeinput input",n,!0),e.getDoc().execCommand(t),e.off("beforeinput input",n)},VI=e=>{e.execCommand("delete")},Hd=e=>FC(e,"Delete"),qI=e=>FC(e,"ForwardDelete"),jI=e=>t=>Tr(Xn(t),e,ze),KI=e=>Wh(e)||za(e),ic=(e,t)=>Ws(e,t)?Mo(t,KI,jI(e)):m.none(),Wd=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},LC=(e,t,n)=>an(Jt(n),Qn(n),(s,o)=>{const r=Mn(!0,s),a=Mn(!1,o),i=Mn(!1,t);return e?Qt(n,i).exists(l=>l.isEqual(a)&&t.isEqual(r)):un(n,i).exists(l=>l.isEqual(r)&&t.isEqual(a))}).getOr(!0),$C=e=>(PN(e)?$o(e):Ju(e)).bind($C).orThunk(()=>m.some(e)),MC=(e,t,n,s=!0)=>{var o;t.deleteContents();const r=$C(n).getOr(n),a=S.fromDom((o=e.dom.getParent(r.dom,e.dom.isBlock))!==null&&o!==void 0?o:n.dom);if(a.dom===e.getBody()?Wd(e,s):vt(a)&&(uo(a),s&&e.selection.setCursorLocation(a.dom,0)),!ze(n,a)){const i=Tr(Xn(a),n)?[]:jN(a);M(i.concat(Ht(n)),l=>{!ze(l,a)&&!Ws(l,a)&&vt(l)&&at(l)})}},GI=e=>t=>ze(e,t),Vd=e=>Yt(e,"td,th"),YI=(e,t)=>{const n=c=>fi(S.fromDom(c),t),s=n(e.startContainer),o=n(e.endContainer),r=s.isSome(),a=o.isSome(),i=an(s,o,ze).getOr(!1);return{startTable:s,endTable:o,isStartInTable:r,isEndInTable:a,isSameTable:i,isMultiTable:!i&&r&&a}},qd=(e,t)=>({start:e,end:t}),XI=(e,t,n)=>({rng:e,table:t,cells:n}),Ei=ks.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),lc=(e,t)=>Uo(S.fromDom(e),"td,th",t),UC=e=>!ze(e.start,e.end),zC=(e,t)=>fi(e.start,t).bind(n=>fi(e.end,t).bind(s=>Dr(ze(n,s),n))),ZI=(e,t)=>!UC(e)&&zC(e,t).exists(n=>{const s=n.dom.rows;return s.length===1&&s[0].cells.length===1}),QI=(e,t)=>{const n=lc(e.startContainer,t),s=lc(e.endContainer,t);return an(n,s,qd)},JI=e=>t=>fi(t,e).bind(n=>Bo(Vd(n)).map(s=>qd(t,s))),eF=e=>t=>fi(t,e).bind(n=>hn(Vd(n)).map(s=>qd(s,t))),jd=e=>t=>zC(t,e).map(n=>XI(t,n,Vd(n))),HC=(e,t,n,s)=>{if(n.collapsed||!e.forall(UC))return m.none();if(t.isSameTable){const o=e.bind(jd(s));return m.some({start:o,end:o})}else{const o=lc(n.startContainer,s),r=lc(n.endContainer,s),a=o.bind(JI(s)).bind(jd(s)),i=r.bind(eF(s)).bind(jd(s));return m.some({start:a,end:i})}},WC=(e,t)=>xa(e,n=>ze(n,t)),Kd=e=>an(WC(e.cells,e.rng.start),WC(e.cells,e.rng.end),(t,n)=>e.cells.slice(t,n+1)),tF=(e,t,n)=>e.exists(s=>ZI(s,n)&&od(s.start,t)),VC=(e,t)=>{const{startTable:n,endTable:s}=t,o=e.cloneRange();return n.each(r=>o.setStartAfter(r.dom)),s.each(r=>o.setEndBefore(r.dom)),o},nF=(e,t,n,s)=>HC(e,t,n,s).bind(({start:o,end:r})=>o.or(r)).bind(o=>{const{isSameTable:r}=t,a=Kd(o).getOr([]);if(r&&o.cells.length===a.length)return m.some(Ei.fullTable(o.table));if(a.length>0){if(r)return m.some(Ei.partialTable(a,m.none()));{const i=VC(n,t);return m.some(Ei.partialTable(a,m.some({...t,rng:i})))}}else return m.none()}),sF=(e,t,n,s)=>HC(e,t,n,s).bind(({start:o,end:r})=>{const a=o.bind(Kd).getOr([]),i=r.bind(Kd).getOr([]);if(a.length>0&&i.length>0){const l=VC(n,t);return m.some(Ei.multiTable(a,i,l))}else return m.none()}),oF=(e,t)=>{const n=GI(e),s=QI(t,n),o=YI(t,n);return tF(s,t,n)?s.map(r=>Ei.singleCellTable(t,r.start)):o.isMultiTable?sF(s,o,t,n):nF(s,o,t,n)},qC=e=>M(e,t=>{zt(t,"contenteditable"),uo(t)}),rF=(e,t)=>m.from(e.dom.getParent(t,e.dom.isBlock)).map(S.fromDom),aF=(e,t,n)=>{n.each(s=>{t?at(s):(uo(s),e.selection.setCursorLocation(s.dom,0))})},Gd=(e,t,n,s)=>{const o=n.cloneRange();s?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),Yd(e,o,t,!1).each(r=>r())},jC=e=>{const t=Xr(e),n=S.fromDom(e.selection.getNode());bl(n.dom)&&vt(n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&ht(t,s=>ze(s,n))&&It(n,"data-mce-selected","1")},KC=(e,t,n)=>m.some(()=>{const s=e.selection.getRng(),o=n.bind(({rng:r,isStartInTable:a})=>{const i=rF(e,a?r.endContainer:r.startContainer);r.deleteContents(),aF(e,a,i.filter(vt));const l=a?t[0]:t[t.length-1];return Gd(e,l,s,a),vt(l)?m.none():m.some(a?t.slice(1):t.slice(0,-1))}).getOr(t);qC(o),jC(e)}),iF=(e,t,n,s)=>m.some(()=>{const o=e.selection.getRng(),r=t[0],a=n[n.length-1];Gd(e,r,o,!0),Gd(e,a,o,!1);const i=vt(r)?t:t.slice(1),l=vt(a)?n:n.slice(0,-1);qC(i.concat(l)),s.deleteContents(),jC(e)}),Yd=(e,t,n,s=!0)=>m.some(()=>{MC(e,t,n,s)}),lF=(e,t)=>m.some(()=>lr(e,!1,t)),cF=(e,t,n)=>oF(t,n).bind(s=>s.fold(ne(Yd,e),ne(lF,e),ne(KC,e),ne(iF,e))),uF=(e,t)=>cc(e,t),fF=(e,t,n,s)=>Xd(t,s).fold(()=>cF(e,t,n),o=>uF(e,o)),dF=(e,t,n)=>{const s=S.fromDom(e.getBody()),o=e.selection.getRng();return n.length!==0?KC(e,n,m.none()):fF(e,s,o,t)},GC=(e,t)=>_t(Zs(t,e),Ha),Xd=(e,t)=>_t(Zs(t,e),Gu("caption")),mF=(e,t,n,s,o)=>ui(n,e.getBody(),o).bind(r=>GC(t,S.fromDom(r.getNode())).bind(a=>ze(a,s)?m.none():m.some(Ee))),cc=(e,t)=>m.some(()=>{uo(t),e.selection.setCursorLocation(t.dom,0)}),pF=(e,t,n,s)=>Jt(e.dom).bind(o=>Qn(e.dom).map(r=>t?n.isEqual(o)&&s.isEqual(r):n.isEqual(r)&&s.isEqual(o))).getOr(!0),gF=(e,t)=>cc(e,t),hF=(e,t,n)=>Xd(e,S.fromDom(n.getNode())).fold(()=>m.some(Ee),s=>Dr(!ze(s,t),Ee)),bF=(e,t,n,s,o)=>ui(n,e.getBody(),o).fold(()=>m.some(Ee),r=>pF(s,n,o,r)?gF(e,s):hF(t,s,r)),vF=(e,t,n,s)=>{const o=P.fromRangeStart(e.selection.getRng());return GC(n,s).bind(r=>vt(r)?cc(e,r):mF(e,n,t,r,o))},yF=(e,t,n,s)=>{const o=P.fromRangeStart(e.selection.getRng());return vt(s)?cc(e,s):bF(e,n,t,s,o)},YC=(e,t)=>e?dC(t):mC(t),CF=(e,t)=>{const n=P.fromRangeStart(e.selection.getRng());return YC(t,n)||In(t,e.getBody(),n).exists(s=>YC(t,s))},EF=(e,t,n)=>{const s=S.fromDom(e.getBody());return Xd(s,n).fold(()=>vF(e,t,s,n).orThunk(()=>Dr(CF(e,t),Ee)),o=>yF(e,t,s,o))},Zd=(e,t)=>{const n=S.fromDom(e.selection.getStart(!0)),s=Xr(e);return e.selection.isCollapsed()&&s.length===0?EF(e,t,n):dF(e,n,s)},ur=(e,t)=>{let n=t;for(;n&&n!==e;){if(rs(n)||tt(n))return n;n=n.parentNode}return null},SF=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],wF=V.each,Qd=e=>{const t=e.dom,n=new Set(e.serializer.getTempAttrs()),s=(r,a)=>{if(r.nodeName!==a.nodeName||r.nodeType!==a.nodeType)return!1;const i=c=>{const f={};return wF(t.getAttribs(c),u=>{const d=u.nodeName.toLowerCase();d!=="style"&&!o(d)&&(f[d]=t.getAttrib(c,d))}),f},l=(c,f)=>{for(const u in c)if(Se(c,u)){const d=f[u];if(Ye(d)||c[u]!==d)return!1;delete f[u]}for(const u in f)if(Se(f,u))return!1;return!0};return Q(r)&&Q(a)&&(!l(i(r),i(a))||!l(t.parseStyle(t.getAttrib(r,"style")),t.parseStyle(t.getAttrib(a,"style"))))?!1:!Fn(r)&&!Fn(a)},o=r=>ht(SF,a=>Ut(r,a))||n.has(r);return{compare:s,isAttributeInternal:o}},_F=(e,t)=>{let n=e;for(;n=n.walk();)t(n)},XC=(e,t,n,s)=>{const o=n.name;for(let r=0,a=e.length;r<a;r++){const i=e[r];if(i.name===o){const l=s.nodes[o];l?l.nodes.push(n):s.nodes[o]={filter:i,nodes:[n]}}}if(n.attributes)for(let r=0,a=t.length;r<a;r++){const i=t[r],l=i.name;if(l in n.attributes.map){const c=s.attributes[l];c?c.nodes.push(n):s.attributes[l]={filter:i,nodes:[n]}}}},xF=(e,t,n)=>{const s={nodes:{},attributes:{}};return n.firstChild&&_F(n,o=>{XC(e,t,o,s)}),s},ZC=(e,t)=>{const n=(s,o)=>{Je(s,r=>{const a=rn(r.nodes);M(r.filter.callbacks,i=>{for(let l=a.length-1;l>=0;l--){const c=a[l];(!(o?c.attr(r.filter.name)!==void 0:c.name===r.filter.name)||rt(c.parent))&&a.splice(l,1)}a.length>0&&i(a,r.filter.name,t)})})};n(e.nodes,!1),n(e.attributes,!0)},QC=(e,t,n,s={})=>{const o=xF(e,t,n);ZC(o,s)},Jd=(e,t,n)=>{if(e.insert&&t(n)){const s=new fn("br",1);s.attr("data-mce-bogus","1"),n.empty().append(s)}else n.empty().append(new fn("#text",3)).value=Dt},kF=e=>{var t;return JC(e,"#text")&&((t=e==null?void 0:e.firstChild)===null||t===void 0?void 0:t.value)===Dt},JC=(e,t)=>{const n=e==null?void 0:e.firstChild;return G(n)&&n===e.lastChild&&n.name===t},NF=(e,t)=>{const n=e.getElementRule(t.name);return(n==null?void 0:n.paddEmpty)===!0},Si=(e,t,n,s)=>s.isEmpty(t,n,o=>NF(e,o)),AF=(e,t)=>G(e)&&(t(e)||e.name==="br"),TF=e=>{let t;for(let n=e;n;n=n.parent){const s=n.attr("contenteditable");if(s==="false")break;s==="true"&&(t=n)}return m.from(t)},em=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{const s=e.children();for(const o of s)n&&!t.isValidChild(n.name,o.name)&&em(o,t,n);e.unwrap()}},tm=(e,t,n,s=Ee)=>{const o=t.getTextBlockElements(),r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=V.makeMap("tr,td,th,tbody,thead,tfoot,table"),l=new Set,c=f=>f!==n&&!i[f.name];for(let f=0;f<e.length;f++){const u=e[f];let d,v,E;if(!u.parent||l.has(u))continue;if(o[u.name]&&u.parent.name==="li"){let C=u.next;for(;C&&o[C.name];){C.name="li",l.add(C),u.parent.insert(C,u.parent);C=C.next}u.unwrap();continue}const h=[u];for(d=u.parent;d&&!t.isValidChild(d.name,u.name)&&c(d);d=d.parent)h.push(d);if(d&&h.length>1)if(t.isValidChild(d.name,u.name)){h.reverse(),v=h[0].clone(),s(v);let C=v;for(let w=0;w<h.length-1;w++){t.isValidChild(C.name,h[w].name)&&w>0?(E=h[w].clone(),s(E),C.append(E)):E=C;for(let _=h[w].firstChild;_&&_!==h[w+1];){const x=_.next;E.append(_),_=x}C=E}Si(t,r,a,v)?d.insert(u,h[0],!0):(d.insert(v,h[0],!0),d.insert(u,v)),d=h[0],(Si(t,r,a,d)||JC(d,"br"))&&d.empty().remove()}else em(u,t);else if(u.parent){if(u.name==="li"){let C=u.prev;if(C&&(C.name==="ul"||C.name==="ol")){C.append(u);continue}if(C=u.next,C&&(C.name==="ul"||C.name==="ol")&&C.firstChild){C.insert(u,C.firstChild,!0);continue}const w=new fn("ul",1);s(w),u.wrap(w);continue}if(t.isValidChild(u.parent.name,"div")&&t.isValidChild("div",u.name)){const C=new fn("div",1);s(C),u.wrap(C)}else em(u,t)}}},DF=(e,t)=>{let n=e;for(;n;){if(n.name===t)return!0;n=n.parent}return!1},eE=(e,t,n=t.parent)=>n&&e.children[t.name]&&!e.isValidChild(n.name,t.name)?!0:!!(n&&t.name==="a"&&DF(n,"a")),RF=(e,t,n,s)=>{const o=document.createRange();return o.setStart(e,t),o.setEnd(n,s),o},PF=e=>{const t=P.fromRangeStart(e),n=P.fromRangeEnd(e),s=e.commonAncestorContainer;return In(!1,s,n).map(o=>!Ns(t,n,s)&&Ns(t,o,s)?RF(t.container(),t.offset(),o.container(),o.offset()):e).getOr(e)},nm=e=>e.collapsed?e:PF(e),OF=e=>G(e.firstChild)&&e.firstChild===e.lastChild,BF=e=>e.name==="br"||e.value===Dt,IF=(e,t)=>e.getBlockElements()[t.name]&&OF(t)&&BF(t.firstChild),FF=(e,t)=>{const n=e.getNonEmptyElements();return G(t)&&(t.isEmpty(n)||IF(e,t))},LF=(e,t)=>{let n=t.firstChild,s=t.lastChild;return n&&n.name==="meta"&&(n=n.next),s&&s.attr("id")==="mce_marker"&&(s=s.prev),FF(e,s)&&(s=s==null?void 0:s.prev),!n||n!==s?!1:n.name==="ul"||n.name==="ol"},$F=e=>{var t,n;const s=e.firstChild,o=e.lastChild;return s&&s.nodeName==="META"&&((t=s.parentNode)===null||t===void 0||t.removeChild(s)),o&&o.id==="mce_marker"&&((n=o.parentNode)===null||n===void 0||n.removeChild(o)),e},MF=(e,t,n)=>{const s=t.serialize(n),o=e.createFragment(s);return $F(o)},UF=e=>{var t;return ve((t=e==null?void 0:e.childNodes)!==null&&t!==void 0?t:[],n=>n.nodeName==="LI")},zF=e=>e.data===Dt||dt(e),HF=e=>G(e==null?void 0:e.firstChild)&&e.firstChild===e.lastChild&&zF(e.firstChild),WF=e=>!e.firstChild||HF(e),VF=e=>e.length>0&&WF(e[e.length-1])?e.slice(0,-1):e,sm=(e,t)=>{const n=e.getParent(t,e.isBlock);return n&&n.nodeName==="LI"?n:null},qF=(e,t)=>!!sm(e,t),jF=(e,t)=>{const n=t.cloneRange(),s=t.cloneRange();return n.setStartBefore(e),s.setEndAfter(e),[n.cloneContents(),s.cloneContents()]},KF=(e,t)=>{const n=P.before(e),o=Ts(t).next(n);return o?o.toRange():null},tE=(e,t)=>{const n=P.after(e),o=Ts(t).prev(n);return o?o.toRange():null},GF=(e,t,n,s)=>{const o=jF(e,s),r=e.parentNode;return r&&(r.insertBefore(o[0],e),V.each(t,a=>{r.insertBefore(a,e)}),r.insertBefore(o[1],e),r.removeChild(e)),tE(t[t.length-1],n)},YF=(e,t,n)=>{const s=e.parentNode;return s&&V.each(t,o=>{s.insertBefore(o,e)}),KF(e,n)},XF=(e,t,n,s)=>(s.insertAfter(t.reverse(),e),tE(t[0],n)),ZF=(e,t,n,s)=>{const o=MF(t,e,s),r=sm(t,n.startContainer),a=VF(UF(o.firstChild)),i=1,l=2,c=t.getRoot(),f=u=>{const d=P.fromRangeStart(n),v=Ts(t.getRoot()),E=u===i?v.prev(d):v.next(d),h=E==null?void 0:E.getNode();return h?sm(t,h)!==r:!0};return r?f(i)?YF(r,a,c):f(l)?XF(r,a,c,t):GF(r,a,c,n):null},QF=["pre"],JF=(e,t,n,s)=>{var o;const r=t.firstChild,a=t.lastChild,i=a.attr("data-mce-type")==="bookmark"?a.prev:a,l=r===i,c=Ve(QF,r.name);if(l&&c){const f=r.attr("contenteditable")!=="false",u=((o=e.getParent(n,e.isBlock))===null||o===void 0?void 0:o.nodeName.toLowerCase())===r.name,d=m.from(ur(s,n)).forall(rs);return f&&u&&d}else return!1},om=bl,eL=(e,t,n)=>{if(G(n)){const s=e.getParent(t.endContainer,om);return n===s&&od(S.fromDom(n),t)}else return!1},tL=(e,t,n)=>{var s;if(n.getAttribute("data-mce-bogus")==="all")(s=n.parentNode)===null||s===void 0||s.insertBefore(e.dom.createFragment(t),n);else{const o=n.firstChild,r=n.lastChild;!o||o===r&&o.nodeName==="BR"?e.dom.setHTML(n,t):e.selection.setContent(t,{no_events:!0})}},nL=(e,t)=>{m.from(e.getParent(t,"td,th")).map(S.fromDom).each(VA)},sL=(e,t)=>{const n=e.schema.getTextInlineElements(),s=e.dom;if(t){const o=e.getBody(),r=Qd(e);V.each(s.select("*[data-mce-fragment]"),a=>{if(G(n[a.nodeName.toLowerCase()])&&QB(s,a)){for(let l=a.parentElement;G(l)&&l!==o&&!eI(s,a,l);l=l.parentElement)if(r.compare(l,a)){s.remove(a,!0);break}}})}},oL=e=>{let t=e;for(;t=t.walk();)t.type===1&&t.attr("data-mce-fragment","1")},rL=e=>{V.each(e.getElementsByTagName("*"),t=>{t.removeAttribute("data-mce-fragment")})},aL=e=>!!e.getAttribute("data-mce-fragment"),iL=(e,t)=>G(t)&&!e.schema.getVoidElements()[t.nodeName],lL=(e,t)=>{var n,s,o;let r;const a=e.dom,i=e.selection;if(!t)return;i.scrollIntoView(t);const l=ur(e.getBody(),t);if(l&&a.getContentEditable(l)==="false"){a.remove(t),i.select(l);return}let c=a.createRng();const f=t.previousSibling;if(z(f)){c.setStart(f,(s=(n=f.nodeValue)===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0);const v=t.nextSibling;z(v)&&(f.appendData(v.data),(o=v.parentNode)===null||o===void 0||o.removeChild(v))}else c.setStartBefore(t),c.setEndBefore(t);const u=v=>{let E=P.fromRangeStart(v);return E=Ts(e.getBody()).next(E),E==null?void 0:E.toRange()},d=a.getParent(t,a.isBlock);a.remove(t),d&&a.isEmpty(d)&&(Fr(S.fromDom(d)),c.setStart(d,0),c.setEnd(d,0),!om(d)&&!aL(d)&&(r=u(c))?(c=r,a.remove(d)):a.add(d,a.create("br",{"data-mce-bogus":"1"}))),i.setRng(c)},cL=e=>{const t=e.dom,n=nm(e.selection.getRng());e.selection.setRng(n);const s=t.getParent(n.startContainer,om);eL(t,n,s)?Yd(e,n,S.fromDom(s)):n.startContainer===n.endContainer&&n.endOffset-n.startOffset===1&&z(n.startContainer.childNodes[n.startOffset])?n.deleteContents():e.getDoc().execCommand("Delete",!1)},uL=e=>{for(let t=e;t;t=t.walk())if(t.attr("id")==="mce_marker")return m.some(t);return m.none()},fL=e=>{M(rn(e.getBody().querySelectorAll("details")),t=>{const n=ve(rn(t.children),s=>s.nodeName==="SUMMARY");n.length>1&&M(n.slice(1),s=>{const o=S.fromDom(s);Pr(o,"mce-accordion-summary"),Nb(o,"p")})})},dL=(e,t,n)=>{var s,o;const r=e.selection,a=e.dom,i=e.parser,l=n.merge,c=Co({validate:!0},e.schema),f='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';t.indexOf("{$caret}")===-1&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,f);let u=r.getRng();const d=u.startContainer,v=e.getBody();d===v&&r.isCollapsed()&&a.isBlock(v.firstChild)&&iL(e,v.firstChild)&&a.isEmpty(v.firstChild)&&(u=a.createRng(),u.setStart(v.firstChild,0),u.setEnd(v.firstChild,0),r.setRng(u)),r.isCollapsed()||cL(e);const E=r.getNode(),h={context:E.nodeName.toLowerCase(),data:n.data,insert:!0},C=i.parse(t,h);if(n.paste===!0&&LF(e.schema,C)&&qF(a,E))return u=ZF(c,a,r.getRng(),C),u&&r.setRng(u),t;n.paste===!0&&JF(a,C,E,e.getBody())&&((s=C.firstChild)===null||s===void 0||s.unwrap()),oL(C);let w=C.lastChild;if(w&&w.attr("id")==="mce_marker"){const _=w;for(w=w.prev;w;w=w.walk(!0))if(w.type===3||!a.isBlock(w.name)){w.parent&&e.schema.isValidChild(w.parent.name,"span")&&w.parent.insert(_,w,w.name==="br");break}}if(e._selectionOverrides.showBlockCaretContainer(E),!h.invalid)t=c.serialize(C),tL(e,t,E);else{e.selection.setContent(f);let _=r.getNode(),x;const N=e.getBody();for(Ua(_)?_=x=N:x=_;x&&x!==N;)_=x,x=x.parentNode;t=_===N?N.innerHTML:a.getOuterHTML(_);const I=i.parse(t),oe=uL(I),F=oe.bind(TF).getOr(I);oe.each(K=>K.replace(C));const D=C.children(),O=(o=C.parent)!==null&&o!==void 0?o:I;C.unwrap();const q=ve(D,K=>eE(e.schema,K,O));tm(q,e.schema,F),QC(i.getNodeFilters(),i.getAttributeFilters(),I),t=c.serialize(I),_===N?a.setHTML(N,t):a.setOuterHTML(_,t)}return sL(e,l),lL(e,a.get("mce_marker")),rL(e.getBody()),nL(a,r.getStart()),fL(e),ET(e.schema,e.getBody(),r.getStart()),t},uc=e=>e instanceof fn,mL=e=>{ir(e)&&Jt(e.getBody()).each(t=>{const n=t.getNode(),s=Ks(n)?Jt(n).getOr(t):t;e.selection.setRng(s.toRange())})},rm=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),n!==!0&&mL(e)},pL=(e,t,n,s)=>{if(n.length===0||/^\s+$/.test(n)){const o='<br data-mce-bogus="1">';t.nodeName==="TABLE"?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");const r=cn(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),r.toLowerCase())?(n=o,n=e.dom.createHTML(r,ni(e),n)):n||(n=o),rm(e,n,s.no_selection),{content:n,html:n}}else{s.format!=="raw"&&(n=Co({validate:!1},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0})));const o=Cl(S.fromDom(t))?n:V.trim(n);return rm(e,o,s.no_selection),{content:o,html:o}}},gL=(e,t,n,s)=>{QC(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);const o=Co({validate:!1},e.schema).serialize(n),r=Cl(S.fromDom(t))?o:V.trim(o);return rm(e,r,s.no_selection),{content:n,html:r}},hL=(e,t,n)=>m.from(e.getBody()).map(s=>uc(t)?gL(e,s,t,n):pL(e,s,t,n)).getOr({content:t,html:uc(n.content)?"":n.content}),bL=(e,t,n)=>qs(e,t,n).isSome(),vL=(e,t)=>eA(e,t).isSome(),nE=e=>Be(e)?e:lt,yL=(e,t,n)=>{let s=e.dom;const o=nE(n);for(;s.parentNode;){s=s.parentNode;const r=S.fromDom(s),a=t(r);if(a.isSome())return a;if(o(r))break}return m.none()},am=(e,t,n)=>{const s=t(e),o=nE(n);return s.orThunk(()=>o(e)?m.none():yL(e,t,o))},im=ud,sE=(e,t,n)=>{const s=e.formatter.get(n);if(s)for(let o=0;o<s.length;o++){const r=s[o];if(Ln(r)&&r.inherit===!1&&e.dom.is(t,r.selector))return!0}return!1},lm=(e,t,n,s,o)=>{const r=e.dom.getRoot();if(t===r)return!1;const a=e.dom.getParent(t,i=>sE(e,i,n)?!0:i.parentNode===r||!!Rs(e,i,n,s,!0));return!!Rs(e,a,n,s,o)},fc=(e,t,n)=>kt(n)&&im(t,n.inline)||Ds(n)&&im(t,n.block)?!0:Ln(n)?Q(t)&&e.is(t,n.selector):!1,oE=(e,t,n,s,o,r)=>{const a=n[s],i=s==="attributes";if(Be(n.onmatch))return n.onmatch(t,n,s);if(a){if(Tg(a)){for(let l=0;l<a.length;l++)if(i?e.getAttrib(t,a[l]):Gl(e,t,a[l]))return!0}else for(const l in a)if(Se(a,l)){const c=i?e.getAttrib(t,l):Gl(e,t,l),f=yo(a[l],r),u=rt(c)||Da(c);if(u&&rt(f))continue;if(o&&u&&!n.exact||(!o||n.exact)&&!im(c,fd(f,l)))return!1}}return!0},Rs=(e,t,n,s,o)=>{const r=e.formatter.get(n),a=e.dom;if(r&&Q(t))for(let i=0;i<r.length;i++){const l=r[i];if(fc(e.dom,t,l)&&oE(a,t,l,"attributes",o,s)&&oE(a,t,l,"styles",o,s)){const c=l.classes;if(c){for(let f=0;f<c.length;f++)if(!e.dom.hasClass(t,yo(c[f],s)))return}return l}}},cm=(e,t,n,s,o)=>{if(s)return lm(e,s,t,n,o);if(s=e.selection.getNode(),lm(e,s,t,n,o))return!0;const r=e.selection.getStart();return!!(r!==s&&lm(e,r,t,n,o))},CL=(e,t,n)=>{const s=[],o={},r=e.selection.getStart();return e.dom.getParent(r,a=>{for(let i=0;i<t.length;i++){const l=t[i];!o[l]&&Rs(e,a,l,n)&&(o[l]=!0,s.push(l))}},e.dom.getRoot()),s},EL=(e,t)=>{const n=o=>ze(o,S.fromDom(e.getBody())),s=(o,r)=>Rs(e,o.dom,r)?m.some(r):m.none();return m.from(e.selection.getStart(!0)).bind(o=>am(S.fromDom(o),r=>kr(t,a=>s(r,a)),n)).getOrNull()},SL=(e,t)=>{const n=e.formatter.get(t),s=e.dom;if(n&&e.selection.isEditable()){const o=e.selection.getStart(),r=Yl(s,o);for(let a=n.length-1;a>=0;a--){const i=n[a];if(!Ln(i))return!0;for(let l=r.length-1;l>=0;l--)if(s.is(r[l],i.selector))return!0}}return!1},wL=(e,t,n)=>Sn(n,(s,o)=>{const r=SP(e,o);return e.formatter.matchNode(t,o,{},r)?s.concat([o]):s},[]),ta=Wt,_L=(e,t)=>e.importNode(t,!0),xL=e=>{const t=[];let n=e;for(;n;){if(z(n)&&n.data!==ta||n.childNodes.length>1)return[];Q(n)&&t.push(n),n=n.firstChild}return t},rE=e=>xL(e).length>0,aE=e=>{if(e){const t=new xt(e,e);for(let n=t.current();n;n=t.next())if(z(n))return n}return null},um=e=>{const t=S.fromTag("span");return ro(t,{id:Qf,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&bt(t,S.fromText(ta)),t},kL=e=>{const t=aE(e);return t&&t.data.charAt(0)===ta&&t.deleteData(0,1),t},fm=(e,t,n=!0)=>{const s=e.dom,o=e.selection;if(rE(t))lr(e,!1,S.fromDom(t),n);else{const r=o.getRng(),a=s.getParent(t,s.isBlock),i=r.startContainer,l=r.startOffset,c=r.endContainer,f=r.endOffset,u=kL(t);s.remove(t,!0),i===u&&l>0&&r.setStart(u,l-1),c===u&&f>0&&r.setEnd(u,f-1),a&&s.isEmpty(a)&&uo(S.fromDom(a)),o.setRng(r)}},dm=(e,t,n=!0)=>{const s=e.dom,o=e.selection;if(t)fm(e,t,n);else if(t=nr(e.getBody(),o.getStart()),!t)for(;t=s.get(Qf);)fm(e,t,n)},NL=(e,t,n)=>{var s,o;const r=e.dom,a=r.getParent(n,ne(ld,e.schema));a&&r.isEmpty(a)?(s=n.parentNode)===null||s===void 0||s.replaceChild(t,n):(WA(S.fromDom(n)),r.isEmpty(n)?(o=n.parentNode)===null||o===void 0||o.replaceChild(t,n):r.insertAfter(t,n))},iE=(e,t)=>(e.appendChild(t),t),lE=(e,t)=>{var n;const s=_a(e,(r,a)=>iE(r,a.cloneNode(!1)),t),o=(n=s.ownerDocument)!==null&&n!==void 0?n:document;return iE(s,o.createTextNode(ta))},AL=(e,t,n,s,o,r)=>{const a=e.formatter,i=e.dom,l=ve(wn(a.get()),u=>u!==s&&!Gt(u,"removeformat")),c=wL(e,n,l);if(ve(c,u=>!wP(e,u,s)).length>0){const u=n.cloneNode(!1);return i.add(t,u),a.remove(s,o,u,r),i.remove(u),m.some(u)}else return m.none()},TL=(e,t,n)=>{let s;const o=e.selection,r=e.formatter.get(t);if(!r)return;const a=o.getRng();let i=a.startOffset;const c=a.startContainer.nodeValue;s=nr(e.getBody(),o.getStart());const f=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(c&&i>0&&i<c.length&&f.test(c.charAt(i))&&f.test(c.charAt(i-1))){const u=o.getBookmark();a.collapse(!0);let d=or(e.dom,a,r);d=nc(d),e.formatter.apply(t,n,d),o.moveToBookmark(u)}else{let u=s?aE(s):null;(!s||(u==null?void 0:u.data)!==ta)&&(s=_L(e.getDoc(),um(!0).dom),u=s.firstChild,a.insertNode(s),i=1),e.formatter.apply(t,n,s),o.setCursorLocation(u,i)}},DL=(e,t,n,s)=>{const o=e.dom,r=e.selection;let a=!1;const i=e.formatter.get(t);if(!i)return;const l=r.getRng(),c=l.startContainer,f=l.startOffset;let u=c;z(c)&&(f!==c.data.length&&(a=!0),u=u.parentNode);const d=[];let v;for(;u;){if(Rs(e,u,t,n,s)){v=u;break}u.nextSibling&&(a=!0),d.push(u),u=u.parentNode}if(v)if(a){const E=r.getBookmark();l.collapse(!0);let h=or(o,l,i,!0);h=nc(h),e.formatter.remove(t,n,h,s),r.moveToBookmark(E)}else{const E=nr(e.getBody(),v),h=um(!1).dom;NL(e,h,E??v);const C=AL(e,h,v,t,n,s),w=lE(d.concat(C.toArray()),h);E&&fm(e,E,!1),r.setCursorLocation(w,1),o.isEmpty(v)&&o.remove(v)}},RL=(e,t,n)=>{const s=e.selection,o=e.getBody();dm(e,null,n),(t===8||t===46)&&s.isCollapsed()&&s.getStart().innerHTML===ta&&dm(e,nr(o,s.getStart())),(t===37||t===39)&&dm(e,nr(o,s.getStart()))},PL=e=>z(e)&&Wu(e.data,Dt),OL=e=>{e.on("mouseup keydown",t=>{RL(e,t.keyCode,PL(e.selection.getRng().endContainer))})},cE=e=>{const t=um(!1),n=lE(e,t.dom);return{caretContainer:t,caretPosition:P(n,0)}},uE=(e,t)=>{const{caretContainer:n,caretPosition:s}=cE(t);return _n(S.fromDom(e),n),at(S.fromDom(e)),s},BL=(e,t)=>{const{caretContainer:n,caretPosition:s}=cE(t);return e.insertNode(n.dom),s},fE=(e,t)=>{const n=e.schema.getTextInlineElements();return Se(n,et(t))&&!Jn(t.dom)&&!Wo(t.dom)},dE=e=>Jn(e.dom)&&rE(e.dom),wi={},mE=os(["pre"]),IL=(e,t)=>{wi[e]||(wi[e]=[]),wi[e].push(t)},FL=(e,t)=>{Se(wi,e)&&M(wi[e],n=>{n(t)})};IL("pre",e=>{const t=e.selection.getRng(),n=o=>r=>{const a=r.previousSibling;return mE(a)&&Ve(o,a)},s=(o,r)=>{const a=S.fromDom(r),i=Vs(a).dom;at(a),zo(S.fromDom(o),[S.fromTag("br",i),S.fromTag("br",i),...Ht(a)])};if(!t.collapsed){const o=e.selection.getSelectedBlocks(),r=ve(ve(o,mE),n(o));M(r,a=>{s(a.previousSibling,a)})}});const pE=["fontWeight","fontStyle","color","fontSize","fontFamily"],LL=e=>Qe(e.styles)&&ht(wn(e.styles),t=>Ve(pE,t)),$L=e=>_t(e,t=>kt(t)&&t.inline==="span"&&LL(t)),gE=(e,t)=>{const n=e.get(t);return Ge(n)?$L(n):m.none()},hE=(e,t)=>un(t,P.fromRangeStart(e)).isNone(),bE=(e,t)=>Qt(t,P.fromRangeEnd(e)).exists(n=>!dt(n.getNode())||Qt(t,n).isSome())===!1,vE=e=>t=>xA(t)&&e.isEditable(t),ML=e=>{const t=e.getSelectedBlocks(),n=e.getRng();if(e.isCollapsed())return[];if(t.length===1)return hE(n,t[0])&&bE(n,t[0])?t:[];{const s=hn(t).filter(a=>hE(n,a)).toArray(),o=Bo(t).filter(a=>bE(n,a)).toArray(),r=t.slice(1,-1);return s.concat(r).concat(o)}},UL=e=>ve(ML(e),vE(e.dom)),yE=e=>ve(e.getSelectedBlocks(),vE(e.dom)),mm=V.each,pm=e=>Q(e)&&!Fn(e)&&!Jn(e)&&!Wo(e),CE=(e,t)=>{for(let n=e;n;n=n[t]){if(z(n)&&Cs(n.data))return e;if(Q(n)&&!Fn(n))return n}return e},EE=(e,t,n)=>{const s=Qd(e),o=Q(t)&&sr(t),r=Q(n)&&sr(n);if(o&&r){const a=CE(t,"previousSibling"),i=CE(n,"nextSibling");if(s.compare(a,i)){for(let l=a.nextSibling;l&&l!==i;){const c=l;l=l.nextSibling,a.appendChild(c)}return e.dom.remove(i),V.each(V.grep(i.childNodes),l=>{a.appendChild(l)}),a}}return n},SE=(e,t,n,s)=>{var o;if(s&&t.merge_siblings!==!1){const r=(o=EE(e,Jv(s),s))!==null&&o!==void 0?o:s;EE(e,r,Jv(r,!0))}},zL=(e,t,n)=>{if(t.clear_child_styles){const s=t.links?"*:not(a)":"*";mm(e.select(s,n),o=>{pm(o)&&sr(o)&&mm(t.styles,(r,a)=>{e.setStyle(o,a,"")})})}},gm=(e,t,n)=>{mm(e.childNodes,s=>{pm(s)&&(t(s)&&n(s),s.hasChildNodes()&&gm(s,t,n))})},HL=(e,t)=>{t.nodeName==="SPAN"&&e.getAttribs(t).length===0&&e.remove(t,!0)},wE=(e,t)=>n=>!!(n&&Gl(e,n,t)),_E=(e,t,n)=>s=>{e.setStyle(s,t,n),s.getAttribute("style")===""&&s.removeAttribute("style"),HL(e,s)},fr=ks.generate([{keep:[]},{rename:["name"]},{removed:[]}]),WL=/^(src|href|style)$/,hm=V.each,dc=ud,VL=e=>/^(TR|TH|TD)$/.test(e.nodeName),xE=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),kE=(e,t,n)=>{let s=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"];if(Q(s)){const r=s.childNodes.length-1;!n&&o&&o--,s=s.childNodes[o>r?r:o]}return z(s)&&n&&o>=s.data.length&&(s=new xt(s,e.getBody()).next()||s),z(s)&&!n&&o===0&&(s=new xt(s,e.getBody()).prev()||s),s},NE=(e,t)=>{const n=t?"firstChild":"lastChild",s=e[n];return VL(e)&&s?e.nodeName==="TR"&&s[n]||s:e},bm=(e,t,n,s)=>{var o;const r=e.create(n,s);return(o=t.parentNode)===null||o===void 0||o.insertBefore(r,t),r.appendChild(t),r},AE=(e,t,n,s,o)=>{const r=S.fromDom(t),a=S.fromDom(e.create(s,o)),i=n?Ch(r):yh(r);return zo(a,i),n?(_n(r,a),Th(a,r)):(io(r,a),bt(a,r)),a.dom},qL=(e,t)=>t.links&&e.nodeName==="A",TE=(e,t,n)=>{const s=t.parentNode;let o;const r=e.dom,a=cn(e);Ds(n)&&s===r.getRoot()&&(!n.list_block||!dc(t,n.list_block))&&M(rn(t.childNodes),i=>{Zr(e,a,i.nodeName.toLowerCase())?o?o.appendChild(i):(o=bm(r,i,a),r.setAttribs(o,ni(e))):o=null}),!(kP(n)&&!dc(n.inline,t))&&r.remove(t,!0)},DE=(e,t,n)=>Tt(e)?{name:t,value:null}:{name:e,value:yo(t,n)},RE=(e,t)=>{e.getAttrib(t,"style")===""&&(t.removeAttribute("style"),t.removeAttribute("data-mce-style"))},PE=(e,t,n,s,o)=>{let r=!1;hm(n.styles,(a,i)=>{const{name:l,value:c}=DE(i,a,s),f=fd(c,l);(n.remove_similar||Et(c)||!Q(o)||dc(Gl(e,o,l),f))&&e.setStyle(t,l,""),r=!0}),r&&RE(e,t)},jL=(e,t,n)=>{t==="removeformat"?M(yE(e.selection),s=>{M(pE,o=>e.dom.setStyle(s,o,"")),RE(e.dom,s)}):gE(e.formatter,t).each(s=>{M(yE(e.selection),o=>PE(e.dom,o,s,n,null))})},OE=(e,t,n,s,o)=>{const r=e.dom,a=Qd(e),i=e.schema;if(kt(t)&&kl(i,t.inline)&&jo(i,s)&&s.parentElement===e.getBody())return TE(e,s,t),fr.removed();if(!t.ceFalseOverride&&s&&r.getContentEditableParent(s)==="false"||s&&!fc(r,s,t)&&!qL(s,t))return fr.keep();const l=s,c=t.preserve_attributes;if(kt(t)&&t.remove==="all"&&Ge(c)){const f=ve(r.getAttribs(l),u=>Ve(c,u.name.toLowerCase()));if(r.removeAllAttribs(l),M(f,u=>r.setAttrib(l,u.name,u.value)),f.length>0)return fr.rename("span")}if(t.remove!=="all"){PE(r,l,t,n,o),hm(t.attributes,(u,d)=>{const{name:v,value:E}=DE(d,u,n);if(t.remove_similar||Et(E)||!Q(o)||dc(r.getAttrib(o,v),E)){if(v==="class"){const h=r.getAttrib(l,v);if(h){let C="";if(M(h.split(/\s+/),w=>{/mce\-\w+/.test(w)&&(C+=(C?" ":"")+w)}),C){r.setAttrib(l,v,C);return}}}if(WL.test(v)&&l.removeAttribute("data-mce-"+v),v==="style"&&os(["li"])(l)&&r.getStyle(l,"list-style-type")==="none"){l.removeAttribute(v),r.setStyle(l,"list-style-type","none");return}v==="class"&&l.removeAttribute("className"),l.removeAttribute(v)}}),hm(t.classes,u=>{u=yo(u,n),(!Q(o)||r.hasClass(o,u))&&r.removeClass(l,u)});const f=r.getAttribs(l);for(let u=0;u<f.length;u++){const d=f[u].nodeName;if(!a.isAttributeInternal(d))return fr.keep()}}return t.remove!=="none"?(TE(e,l,t),fr.removed()):fr.keep()},KL=(e,t,n,s,o)=>{let r;return t.parentNode&&M(Yl(e.dom,t.parentNode).reverse(),a=>{if(!r&&Q(a)&&a.id!=="_start"&&a.id!=="_end"){const i=Rs(e,a,n,s,o);i&&i.split!==!1&&(r=a)}}),r},GL=(e,t,n,s)=>OE(e,t,n,s,s).fold(Y(s),o=>(e.dom.createFragment().appendChild(s),e.dom.rename(s,o)),Y(null)),YL=(e,t,n,s,o,r,a,i)=>{var l,c;let f,u;const d=e.dom;if(n){const v=n.parentNode;for(let E=s.parentNode;E&&E!==v;E=E.parentNode){let h=d.clone(E,!1);for(let C=0;C<t.length&&(h=GL(e,t[C],i,h),h!==null);C++);h&&(f&&h.appendChild(f),u||(u=h),f=h)}r&&(!a.mixed||!d.isBlock(n))&&(s=(l=d.split(n,s))!==null&&l!==void 0?l:s),f&&u&&((c=o.parentNode)===null||c===void 0||c.insertBefore(f,o),u.appendChild(o),kt(a)&&SE(e,a,i,f))}return s},XL=(e,t,n,s,o)=>{const r=e.formatter.get(t),a=r[0],i=e.dom,l=e.selection,c=h=>{const C=KL(e,h,t,n,o);return YL(e,r,C,h,h,!0,a,n)},f=h=>Fn(h)&&Q(h)&&(h.id==="_start"||h.id==="_end"),u=h=>ht(r,C=>_i(e,C,n,h,h)),d=h=>{const C=rn(h.childNodes),_=u(h)||ht(r,I=>fc(i,h,I)),x=h.parentNode;if(!_&&G(x)&&md(a)&&u(x),a.deep&&C.length)for(let I=0;I<C.length;I++)d(C[I]);M(["underline","line-through","overline"],I=>{Q(h)&&e.dom.getStyle(h,"text-decoration")===I&&h.parentNode&&ty(i,h.parentNode)===I&&_i(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:I}},void 0,h)})},v=h=>{const C=i.get(h?"_start":"_end");if(C){let w=C[h?"firstChild":"lastChild"];return f(w)&&(w=w[h?"firstChild":"lastChild"]),z(w)&&w.data.length===0&&(w=h?C.previousSibling||C.nextSibling:C.nextSibling||C.previousSibling),i.remove(C,!0),w}else return null},E=h=>{let C,w,_=or(i,h,r,h.collapsed);if(a.split){if(_=nc(_),C=kE(e,_,!0),w=kE(e,_),C!==w){if(C=NE(C,!0),w=NE(w,!1),xE(i,C,w)){const N=m.from(C.firstChild).getOr(C);c(AE(i,N,!0,"span",{id:"_start","data-mce-type":"bookmark"})),v(!0);return}if(xE(i,w,C)){const N=m.from(w.lastChild).getOr(w);c(AE(i,N,!1,"span",{id:"_end","data-mce-type":"bookmark"})),v(!1);return}C=bm(i,C,"span",{id:"_start","data-mce-type":"bookmark"}),w=bm(i,w,"span",{id:"_end","data-mce-type":"bookmark"});const x=i.createRng();x.setStartAfter(C),x.setEndBefore(w),mi(i,x,N=>{M(N,I=>{!Fn(I)&&!Fn(I.parentNode)&&c(I)})}),c(C),c(w),C=v(!0),w=v()}else C=w=c(C);_.startContainer=C.parentNode?C.parentNode:C,_.startOffset=i.nodeIndex(C),_.endContainer=w.parentNode?w.parentNode:w,_.endOffset=i.nodeIndex(w)+1}mi(i,_,x=>{M(x,d)})};if(s){if(di(s)){const h=i.createRng();h.setStartBefore(s),h.setEndAfter(s),E(h)}else E(s);by(e,t,s,n);return}!l.isCollapsed()||!kt(a)||Xr(e).length?(Qv(e,()=>ad(e,E),h=>kt(a)&&cm(e,t,n,h)),e.nodeChanged()):DL(e,t,n,o),jL(e,t,n),by(e,t,s,n)},BE=(e,t,n,s,o)=>{(s||e.selection.isEditable())&&XL(e,t,n,s,o)},_i=(e,t,n,s,o)=>OE(e,t,n,s,o).fold(lt,r=>(e.dom.rename(s,r),!0),St),IE=V.each,ZL=(e,t,n,s)=>{const o=r=>{if(Q(r)&&Q(r.parentNode)&&sr(r)){const a=ty(e,r.parentNode);e.getStyle(r,"color")&&a?e.setStyle(r,"text-decoration",a):e.getStyle(r,"text-decoration")===a&&e.setStyle(r,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(V.walk(s,o,"childNodes"),o(s))},QL=(e,t,n,s)=>{if(t.styles&&t.styles.backgroundColor){const o=wE(e,"fontSize");gm(s,r=>o(r)&&sr(r),_E(e,"backgroundColor",yo(t.styles.backgroundColor,n)))}},JL=(e,t,n,s)=>{if(kt(t)&&(t.inline==="sub"||t.inline==="sup")){const o=wE(e,"fontSize");gm(s,a=>o(a)&&sr(a),_E(e,"fontSize",""));const r=ve(e.select(t.inline==="sup"?"sub":"sup",s),sr);e.remove(r,!0)}},e$=(e,t,n,s)=>{IE(t,o=>{kt(o)&&IE(e.dom.select(o.inline,s),r=>{pm(r)&&_i(e,o,n,r,o.exact?r:null)}),zL(e.dom,o,s)})},t$=(e,t,n,s,o)=>{const r=o.parentNode;Rs(e,r,n,s)&&_i(e,t,s,o)||t.merge_with_parents&&r&&e.dom.getParent(r,a=>Rs(e,a,n,s)?(_i(e,t,s,o),!0):!1)},mc=V.each,n$=(e,t,n,s)=>{if(AR(e)&&kt(t)&&n.parentNode){const o=db(e.schema),r=vL(S.fromDom(n),a=>Jn(a.dom));return Nr(o,s)&&vt(S.fromDom(n.parentNode),!1)&&!r}else return!1},FE=(e,t,n,s)=>{if(mc(n.styles,(o,r)=>{e.setStyle(t,r,yo(o,s))}),n.styles){const o=e.getAttrib(t,"style");o&&e.setAttrib(t,"data-mce-style",o)}},s$=(e,t,n,s)=>{const o=e.formatter.get(t),r=o[0],a=!s&&e.selection.isCollapsed(),i=e.dom,l=e.selection,c=(E,h=r)=>{Be(h.onformat)&&h.onformat(E,h,n,s),FE(i,E,h,n),mc(h.attributes,(C,w)=>{i.setAttrib(E,w,yo(C,n))}),mc(h.classes,C=>{const w=yo(C,n);i.hasClass(E,w)||i.addClass(E,w)})},f=(E,h)=>{let C=!1;return mc(E,w=>Ln(w)?i.getContentEditable(h)==="false"&&!w.ceFalseOverride||G(w.collapsed)&&w.collapsed!==a?!0:i.is(h,w.selector)&&!Jn(h)?(c(h,w),C=!0,!1):!0:!1),C},u=E=>{if(ce(E)){const h=i.create(E);return c(h),h}else return null},d=(E,h,C)=>{const w=[];let _=!0;const x=r.inline||r.block,N=u(x),I=D=>_P(r)&&Rs(e,D,t,n),oe=(D,O,q)=>{const K=xP(r)&&ld(e.schema,D)&&Zr(e,O,x);return q&&K},F=(D,O,q,K)=>{const ee=D.nodeName.toLowerCase(),ge=Zr(e,x,ee)&&Zr(e,O,x),me=!C&&z(D)&&Sl(D.data),Ne=Jn(D),Ie=!kt(r)||!E.isBlock(D);return(q||K)&&ge&&!me&&!Ne&&Ie};mi(E,h,D=>{let O;const q=K=>{let ee=!1,ge=_,me=!1;const Ne=K.parentNode,Ie=Ne.nodeName.toLowerCase(),it=E.getContentEditable(K);G(it)&&(ge=_,_=it==="true",ee=!0,me=ey(e,K));const Lt=_&&!ee;if(dt(K)&&!n$(e,r,K,Ie)){O=null,Ds(r)&&E.remove(K);return}if(I(K)){O=null;return}if(oe(K,Ie,Lt)){const yt=E.rename(K,x);c(yt),w.push(yt),O=null;return}if(Ln(r)){let yt=f(o,K);if(!yt&&G(Ne)&&md(r)&&(yt=f(o,Ne)),!kt(r)||yt){O=null;return}}G(N)&&F(K,Ie,Lt,me)?(O||(O=E.clone(N,!1),Ne.insertBefore(O,K),w.push(O)),me&&ee&&(_=ge),O.appendChild(K)):(O=null,M(rn(K.childNodes),q),ee&&(_=ge),O=null)};M(D,q)}),r.links===!0&&M(w,D=>{const O=q=>{q.nodeName==="A"&&c(q,r),M(rn(q.childNodes),O)};O(D)}),M(w,D=>{const O=ee=>{let ge=0;return M(ee.childNodes,me=>{!CP(me)&&!Fn(me)&&ge++}),ge},q=ee=>_t(ee.childNodes,id).filter(me=>E.getContentEditable(me)!=="false"&&fc(E,me,r)).map(me=>{const Ne=E.clone(me,!1);return c(Ne),E.replace(Ne,ee,!0),E.remove(me,!0),Ne}).getOr(ee),K=O(D);if((w.length>1||!E.isBlock(D))&&K===0){E.remove(D,!0);return}(kt(r)||Ds(r)&&r.wrapper)&&(!r.exact&&K===1&&(D=q(D)),e$(e,o,n,D),t$(e,r,t,n,D),QL(E,r,n,D),ZL(E,r,n,D),JL(E,r,n,D),SE(e,r,n,D))})},v=di(s)?s:l.getNode();if(i.getContentEditable(v)==="false"&&!ey(e,v)){s=v,f(o,s),hy(e,t,s,n);return}if(r){if(s)if(di(s)){if(!f(o,s)){const E=i.createRng();E.setStartBefore(s),E.setEndAfter(s),d(i,or(i,E,o),!0)}}else d(i,s,!0);else!a||!kt(r)||Xr(e).length?(l.setRng(nm(l.getRng())),Qv(e,()=>{ad(e,(E,h)=>{const C=h?E:or(i,E,o);d(i,C,!1)})},St),e.nodeChanged()):TL(e,t,n),gE(e.formatter,t).each(E=>{M(UL(e.selection),h=>FE(i,h,E,n))});FL(t,e)}hy(e,t,s,n)},LE=(e,t,n,s)=>{(s||e.selection.isEditable())&&s$(e,t,n,s)},$E=e=>Se(e,"vars"),o$=(e,t)=>{e.set({}),t.on("NodeChange",n=>{HE(t,n.element,e.get())}),t.on("FormatApply FormatRemove",n=>{const s=m.from(n.node).map(o=>di(o)?o:o.startContainer).bind(o=>Q(o)?m.some(o):m.from(o.parentElement)).getOrThunk(()=>ME(t));HE(t,s,e.get())})},ME=e=>e.selection.getStart(),UE=(e,t,n,s,o)=>xg(t,i=>{const l=e.formatter.matchNode(i,n,o??{},s);return!Ye(l)},i=>sE(e,i,n)?!0:s?!1:G(e.formatter.matchNode(i,n,o,!0))),zE=(e,t)=>{const n=t??ME(e);return ve(Yl(e.dom,n),s=>Q(s)&&!Wo(s))},HE=(e,t,n)=>{const s=zE(e,t);Je(n,(o,r)=>{const a=i=>{const l=UE(e,s,r,i.similar,$E(i)?i.vars:void 0),c=l.isSome();if(i.state.get()!==c){i.state.set(c);const f=l.getOr(t);$E(i)?i.callback(c,{node:f,format:r,parents:s}):M(i.callbacks,u=>u(c,{node:f,format:r,parents:s}))}};M([o.withSimilar,o.withoutSimilar],a),M(o.withVars,a)})},r$=(e,t,n,s,o,r)=>{const a=t.get();M(n.split(","),i=>{const l=st(a,i).getOrThunk(()=>{const f={withSimilar:{state:Rt(!1),similar:!0,callbacks:[]},withoutSimilar:{state:Rt(!1),similar:!1,callbacks:[]},withVars:[]};return a[i]=f,f}),c=()=>{const f=zE(e);return UE(e,f,i,o,r).isSome()};if(Ye(r)){const f=o?l.withSimilar:l.withoutSimilar;f.callbacks.push(s),f.callbacks.length===1&&f.state.set(c())}else l.withVars.push({state:Rt(c()),similar:o,vars:r,callback:s})}),t.set(a)},a$=(e,t,n)=>{const s=e.get();M(t.split(","),o=>st(s,o).each(r=>{s[o]={withSimilar:{...r.withSimilar,callbacks:ve(r.withSimilar.callbacks,a=>a!==n)},withoutSimilar:{...r.withoutSimilar,callbacks:ve(r.withoutSimilar.callbacks,a=>a!==n)},withVars:ve(r.withVars,a=>a.callback!==n)}})),e.set(s)},i$=(e,t,n,s,o,r)=>(r$(e,t,n,s,o,r),{unbind:()=>a$(t,n,s)}),l$=(e,t,n,s)=>{const o=e.formatter.get(t);o&&(cm(e,t,n,s)&&(!("toggle"in o[0])||o[0].toggle)?BE(e,t,n,s):LE(e,t,n,s))},WE=V.explode,VE=()=>{const e={};return{addFilter:(o,r)=>{M(WE(o),a=>{Se(e,a)||(e[a]={name:a,callbacks:[]}),e[a].callbacks.push(r)})},getFilters:()=>Mu(e),removeFilter:(o,r)=>{M(WE(o),a=>{if(Se(e,a))if(G(r)){const i=e[a],l=ve(i.callbacks,c=>c!==r);l.length>0?i.callbacks=l:delete e[a]}else delete e[a]})}}},c$=(e,t)=>{M(t,n=>{e.attr(n,null)})},u$=(e,t,n)=>{e.addNodeFilter("font",s=>{M(s,o=>{const r=t.parse(o.attr("style")),a=o.attr("color"),i=o.attr("face"),l=o.attr("size");a&&(r.color=a),i&&(r["font-family"]=i),l&&ll(l).each(c=>{r["font-size"]=n[c-1]}),o.name="span",o.attr("style",t.serialize(r)),c$(o,["color","face","size"])})})},f$=(e,t,n)=>{e.addNodeFilter("strike",s=>{const o=t.type!=="html4";M(s,r=>{if(o)r.name="s";else{const a=n.parse(r.attr("style"));a["text-decoration"]="line-through",r.name="span",r.attr("style",n.serialize(a))}})})},d$=(e,t,n)=>{var s;const o=xf();t.convert_fonts_to_spans&&u$(e,o,V.explode((s=t.font_size_legacy_values)!==null&&s!==void 0?s:"")),f$(e,n,o)},m$=(e,t,n)=>{t.inline_styles&&d$(e,t,n)},qE=(e,t)=>{e.addNodeFilter("br",(n,s,o)=>{const r=V.extend({},t.getBlockElements()),a=t.getNonEmptyElements(),i=t.getWhitespaceElements();r.body=1;const l=c=>c.name in r&&wT(t,c);for(let c=0,f=n.length;c<f;c++){let u=n[c],d=u.parent;if(d&&r[d.name]&&u===d.lastChild){let v=u.prev;for(;v;){const E=v.name;if(E!=="span"||v.attr("data-mce-type")!=="bookmark"){E==="br"&&(u=null);break}v=v.prev}if(u&&(u.remove(),Si(t,a,i,d))){const E=t.getElementRule(d.name);E&&(E.removeEmpty?d.remove():E.paddEmpty&&Jd(o,l,d))}}else{let v=u;for(;d&&d.firstChild===v&&d.lastChild===v&&(v=d,!r[d.name]);)d=d.parent;if(v===d){const E=new fn("#text",3);E.value=Dt,u.replace(E)}}}})},p$=e=>fetch(e).then(t=>t.ok?t.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})),g$=e=>{const t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},vm=e=>{const[t,...n]=e.split(","),s=n.join(","),o=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(o){const r=o[2]===";base64",a=r?g$(s):decodeURIComponent(s);return m.some({type:o[1],data:a,base64Encoded:r})}else return m.none()},jE=(e,t,n=!0)=>{let s=t;if(n)try{s=atob(t)}catch{return m.none()}const o=new Uint8Array(s.length);for(let r=0;r<o.length;r++)o[r]=s.charCodeAt(r);return m.some(new Blob([o],{type:e}))},h$=e=>new Promise((t,n)=>{vm(e).bind(({type:s,data:o,base64Encoded:r})=>jE(s,o,r)).fold(()=>n("Invalid data URI"),t)}),b$=e=>Ut(e,"blob:")?p$(e):Ut(e,"data:")?h$(e):Promise.reject("Unknown URI format"),KE=e=>new Promise((t,n)=>{const s=new FileReader;s.onloadend=()=>{t(s.result)},s.onerror=()=>{var o;n((o=s.error)===null||o===void 0?void 0:o.message)},s.readAsDataURL(e)});let v$=0;const y$=e=>(e||"blobid")+v$++,GE=(e,t,n)=>vm(e).bind(({data:s,type:o,base64Encoded:r})=>{if(t&&!r)return m.none();{const a=r?s:btoa(s);return n(a,o)}}),YE=(e,t,n)=>{const s=e.create(y$(),t,n);return e.add(s),s},XE=(e,t,n=!1)=>GE(t,n,(s,o)=>m.from(e.getByData(s,o)).orThunk(()=>jE(o,s).map(r=>YE(e,r,s)))),C$=(e,t)=>{const n=()=>Promise.reject("Invalid data URI");if(Ut(t,"blob:")){const s=e.getByUri(t);return G(s)?Promise.resolve(s):b$(t).then(o=>KE(o).then(r=>GE(r,!1,a=>m.some(YE(e,o,a))).getOrThunk(n)))}else return Ut(t,"data:")?XE(e,t).fold(n,s=>Promise.resolve(s)):Promise.reject("Unknown image data format")},E$=e=>G(e.attr("data-mce-bogus")),S$=e=>e.attr("src")===Fe.transparentSrc||G(e.attr("data-mce-placeholder")),w$=(e,t)=>{const{blob_cache:n}=t;if(n){const s=o=>{const r=o.attr("src");S$(o)||E$(o)||rt(r)||XE(n,r,!0).each(a=>{o.attr("src",a.blobUri())})};e.addAttributeFilter("src",o=>M(o,s))}},_$=(e,t)=>{const n=e.schema;t.remove_trailing_brs&&qE(e,n),e.addAttributeFilter("href",o=>{let r=o.length;const a=l=>l.split(" ").filter(f=>f.length>0).concat(["noopener"]).sort().join(" "),i=l=>{const c=l?V.trim(l):"";return/\b(noopener)\b/g.test(c)?c:a(c)};if(!t.allow_unsafe_link_target)for(;r--;){const l=o[r];l.name==="a"&&l.attr("target")==="_blank"&&l.attr("rel",i(l.attr("rel")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",o=>{let r=o.length,a,i,l,c;for(;r--;)if(c=o[r],c.name==="a"&&c.firstChild&&!c.attr("href"))for(l=c.parent,a=c.lastChild;a&&l;)i=a.prev,l.insert(a,c),a=i}),t.fix_list_elements&&e.addNodeFilter("ul,ol",o=>{let r=o.length,a,i;for(;r--;)if(a=o[r],i=a.parent,i&&(i.name==="ul"||i.name==="ol"))if(a.prev&&a.prev.name==="li")a.prev.append(a);else{const l=new fn("li",1);l.attr("style","list-style-type: none"),a.wrap(l)}});const s=n.getValidClasses();t.validate&&s&&e.addAttributeFilter("class",o=>{var r;let a=o.length;for(;a--;){const i=o[a],l=(r=i.attr("class"))!==null&&r!==void 0?r:"",c=V.explode(l," ");let f="";for(let u=0;u<c.length;u++){const d=c[u];let v=!1,E=s["*"];E&&E[d]&&(v=!0),E=s[i.name],!v&&E&&E[d]&&(v=!0),v&&(f&&(f+=" "),f+=d)}f.length||(f=null),i.attr("class",f)}}),w$(e,t)};function dr(e){"@babel/helpers - typeof";return dr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dr(e)}function ym(e,t){return ym=Object.setPrototypeOf||function(s,o){return s.__proto__=o,s},ym(e,t)}function x$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function pc(e,t,n){return x$()?pc=Reflect.construct:pc=function(o,r,a){var i=[null];i.push.apply(i,r);var l=Function.bind.apply(o,i),c=new l;return a&&ym(c,a.prototype),c},pc.apply(null,arguments)}function ls(e){return k$(e)||N$(e)||A$(e)||T$()}function k$(e){if(Array.isArray(e))return Cm(e)}function N$(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function A$(e,t){if(e){if(typeof e=="string")return Cm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Cm(e,t)}}function Cm(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function T$(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var D$=Object.hasOwnProperty,ZE=Object.setPrototypeOf,R$=Object.isFrozen,P$=Object.getPrototypeOf,O$=Object.getOwnPropertyDescriptor,vn=Object.freeze,Ps=Object.seal,B$=Object.create,QE=typeof Reflect<"u"&&Reflect,gc=QE.apply,Em=QE.construct;gc||(gc=function(t,n,s){return t.apply(n,s)}),vn||(vn=function(t){return t}),Ps||(Ps=function(t){return t}),Em||(Em=function(t,n){return pc(t,ls(n))});var I$=cs(Array.prototype.forEach),F$=cs(Array.prototype.pop),xi=cs(Array.prototype.push),hc=cs(String.prototype.toLowerCase),L$=cs(String.prototype.match),xo=cs(String.prototype.replace),$$=cs(String.prototype.indexOf),M$=cs(String.prototype.trim),yn=cs(RegExp.prototype.test),Sm=U$(TypeError);function cs(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return gc(e,t,s)}}function U$(e){return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return Em(e,n)}}function He(e,t){ZE&&ZE(e,null);for(var n=t.length;n--;){var s=t[n];if(typeof s=="string"){var o=hc(s);o!==s&&(R$(t)||(t[n]=o),s=o)}e[s]=!0}return e}function mr(e){var t=B$(null),n;for(n in e)gc(D$,e,[n])&&(t[n]=e[n]);return t}function bc(e,t){for(;e!==null;){var n=O$(e,t);if(n){if(n.get)return cs(n.get);if(typeof n.value=="function")return cs(n.value)}e=P$(e)}function s(o){return console.warn("fallback value for",o),null}return s}var JE=vn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),wm=vn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),_m=vn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),z$=vn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),xm=vn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),H$=vn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),eS=vn(["#text"]),tS=vn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),km=vn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),nS=vn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vc=vn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),W$=Ps(/\{\{[\w\W]*|[\w\W]*\}\}/gm),V$=Ps(/<%[\w\W]*|[\w\W]*%>/gm),q$=Ps(/^data-[\-\w.\u00B7-\uFFFF]/),j$=Ps(/^aria-[\-\w]+$/),K$=Ps(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),G$=Ps(/^(?:\w+script|data):/i),Y$=Ps(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),X$=Ps(/^html$/i),Z$=function(){return typeof window>"u"?null:window},Q$=function(t,n){if(dr(t)!=="object"||typeof t.createPolicy!="function")return null;var s=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(s=n.currentScript.getAttribute(o));var r="dompurify"+(s?"#"+s:"");try{return t.createPolicy(r,{createHTML:function(i){return i}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}};function sS(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Z$(),t=function(R){return sS(R)};if(t.version="2.3.8",t.removed=[],!e||!e.document||e.document.nodeType!==9)return t.isSupported=!1,t;var n=e.document,s=e.document,o=e.DocumentFragment,r=e.HTMLTemplateElement,a=e.Node,i=e.Element,l=e.NodeFilter,c=e.NamedNodeMap,f=c===void 0?e.NamedNodeMap||e.MozNamedAttrMap:c,u=e.HTMLFormElement,d=e.DOMParser,v=e.trustedTypes,E=i.prototype,h=bc(E,"cloneNode"),C=bc(E,"nextSibling"),w=bc(E,"childNodes"),_=bc(E,"parentNode");if(typeof r=="function"){var x=s.createElement("template");x.content&&x.content.ownerDocument&&(s=x.content.ownerDocument)}var N=Q$(v,n),I=N?N.createHTML(""):"",oe=s,F=oe.implementation,D=oe.createNodeIterator,O=oe.createDocumentFragment,q=oe.getElementsByTagName,K=n.importNode,ee={};try{ee=mr(s).documentMode?s.documentMode:{}}catch{}var ge={};t.isSupported=typeof _=="function"&&F&&typeof F.createHTMLDocument<"u"&&ee!==9;var me=W$,Ne=V$,Ie=q$,it=j$,Lt=G$,yt=Y$,H=K$,re=null,Ae=He({},[].concat(ls(JE),ls(wm),ls(_m),ls(xm),ls(eS))),xe=null,ae=He({},[].concat(ls(tS),ls(km),ls(nS),ls(vc))),le=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),U=null,pe=null,_e=!0,Me=!0,je=!1,he=!1,Re=!1,ft=!1,We=!1,ot=!1,ct=!1,Xe=!1,mt=!0,Hn=!0,$t=!1,ms={},Nn=null,Cr=He({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Er=null,ps=He({},["audio","video","img","source","image","track"]),es=null,gt=He({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Wn="http://www.w3.org/1998/Math/MathML",gs="http://www.w3.org/2000/svg",Vn="http://www.w3.org/1999/xhtml",qn=Vn,Fs=!1,qt,eo=["application/xhtml+xml","text/html"],Ls="text/html",ts,Ao=null,hu=s.createElement("form"),eg=function(R){return R instanceof RegExp||R instanceof Function},bu=function(R){Ao&&Ao===R||((!R||dr(R)!=="object")&&(R={}),R=mr(R),re="ALLOWED_TAGS"in R?He({},R.ALLOWED_TAGS):Ae,xe="ALLOWED_ATTR"in R?He({},R.ALLOWED_ATTR):ae,es="ADD_URI_SAFE_ATTR"in R?He(mr(gt),R.ADD_URI_SAFE_ATTR):gt,Er="ADD_DATA_URI_TAGS"in R?He(mr(ps),R.ADD_DATA_URI_TAGS):ps,Nn="FORBID_CONTENTS"in R?He({},R.FORBID_CONTENTS):Cr,U="FORBID_TAGS"in R?He({},R.FORBID_TAGS):{},pe="FORBID_ATTR"in R?He({},R.FORBID_ATTR):{},ms="USE_PROFILES"in R?R.USE_PROFILES:!1,_e=R.ALLOW_ARIA_ATTR!==!1,Me=R.ALLOW_DATA_ATTR!==!1,je=R.ALLOW_UNKNOWN_PROTOCOLS||!1,he=R.SAFE_FOR_TEMPLATES||!1,Re=R.WHOLE_DOCUMENT||!1,ot=R.RETURN_DOM||!1,ct=R.RETURN_DOM_FRAGMENT||!1,Xe=R.RETURN_TRUSTED_TYPE||!1,We=R.FORCE_BODY||!1,mt=R.SANITIZE_DOM!==!1,Hn=R.KEEP_CONTENT!==!1,$t=R.IN_PLACE||!1,H=R.ALLOWED_URI_REGEXP||H,qn=R.NAMESPACE||Vn,R.CUSTOM_ELEMENT_HANDLING&&eg(R.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(le.tagNameCheck=R.CUSTOM_ELEMENT_HANDLING.tagNameCheck),R.CUSTOM_ELEMENT_HANDLING&&eg(R.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(le.attributeNameCheck=R.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),R.CUSTOM_ELEMENT_HANDLING&&typeof R.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(le.allowCustomizedBuiltInElements=R.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),qt=eo.indexOf(R.PARSER_MEDIA_TYPE)===-1?qt=Ls:qt=R.PARSER_MEDIA_TYPE,ts=qt==="application/xhtml+xml"?function(se){return se}:hc,he&&(Me=!1),ct&&(ot=!0),ms&&(re=He({},ls(eS)),xe=[],ms.html===!0&&(He(re,JE),He(xe,tS)),ms.svg===!0&&(He(re,wm),He(xe,km),He(xe,vc)),ms.svgFilters===!0&&(He(re,_m),He(xe,km),He(xe,vc)),ms.mathMl===!0&&(He(re,xm),He(xe,nS),He(xe,vc))),R.ADD_TAGS&&(re===Ae&&(re=mr(re)),He(re,R.ADD_TAGS)),R.ADD_ATTR&&(xe===ae&&(xe=mr(xe)),He(xe,R.ADD_ATTR)),R.ADD_URI_SAFE_ATTR&&He(es,R.ADD_URI_SAFE_ATTR),R.FORBID_CONTENTS&&(Nn===Cr&&(Nn=mr(Nn)),He(Nn,R.FORBID_CONTENTS)),Hn&&(re["#text"]=!0),Re&&He(re,["html","head","body"]),re.table&&(He(re,["tbody"]),delete U.tbody),vn&&vn(R),Ao=R)},tg=He({},["mi","mo","mn","ms","mtext"]),ng=He({},["foreignobject","desc","title","annotation-xml"]),pk=He({},["title","style","font","a","script"]),hs=He({},wm);He(hs,_m),He(hs,z$);var ga=He({},xm);He(ga,H$);var A=function(R){var se=_(R);(!se||!se.tagName)&&(se={namespaceURI:Vn,tagName:"template"});var be=hc(R.tagName),ut=hc(se.tagName);return R.namespaceURI===gs?se.namespaceURI===Vn?be==="svg":se.namespaceURI===Wn?be==="svg"&&(ut==="annotation-xml"||tg[ut]):!!hs[be]:R.namespaceURI===Wn?se.namespaceURI===Vn?be==="math":se.namespaceURI===gs?be==="math"&&ng[ut]:!!ga[be]:R.namespaceURI===Vn?se.namespaceURI===gs&&!ng[ut]||se.namespaceURI===Wn&&!tg[ut]?!1:!ga[be]&&(pk[be]||!hs[be]):!1},T=function(R){xi(t.removed,{element:R});try{R.parentNode.removeChild(R)}catch{try{R.outerHTML=I}catch{R.remove()}}},W=function(R,se){try{xi(t.removed,{attribute:se.getAttributeNode(R),from:se})}catch{xi(t.removed,{attribute:null,from:se})}if(se.removeAttribute(R),R==="is"&&!xe[R])if(ot||ct)try{T(se)}catch{}else try{se.setAttribute(R,"")}catch{}},$=function(R){var se,be;if(We)R="<remove></remove>"+R;else{var ut=L$(R,/^[\r\n\t ]+/);be=ut&&ut[0]}qt==="application/xhtml+xml"&&(R='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+R+"</body></html>");var An=N?N.createHTML(R):R;if(qn===Vn)try{se=new d().parseFromString(An,qt)}catch{}if(!se||!se.documentElement){se=F.createDocument(qn,"template",null);try{se.documentElement.innerHTML=Fs?"":An}catch{}}var mn=se.body||se.documentElement;return R&&be&&mn.insertBefore(s.createTextNode(be),mn.childNodes[0]||null),qn===Vn?q.call(se,Re?"html":"body")[0]:Re?se.documentElement:mn},de=function(R){return D.call(R.ownerDocument||R,R,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT,null,!1)},ke=function(R){return R instanceof u&&(typeof R.nodeName!="string"||typeof R.textContent!="string"||typeof R.removeChild!="function"||!(R.attributes instanceof f)||typeof R.removeAttribute!="function"||typeof R.setAttribute!="function"||typeof R.namespaceURI!="string"||typeof R.insertBefore!="function")},Ke=function(R){return dr(a)==="object"?R instanceof a:R&&dr(R)==="object"&&typeof R.nodeType=="number"&&typeof R.nodeName=="string"},Nt=function(R,se,be){ge[R]&&I$(ge[R],function(ut){ut.call(t,se,be,Ao)})},Ot=function(R){var se;if(Nt("beforeSanitizeElements",R,null),ke(R)||yn(/[\u0080-\uFFFF]/,R.nodeName))return T(R),!0;var be=ts(R.nodeName);if(Nt("uponSanitizeElement",R,{tagName:be,allowedTags:re}),R.hasChildNodes()&&!Ke(R.firstElementChild)&&(!Ke(R.content)||!Ke(R.content.firstElementChild))&&yn(/<[/\w]/g,R.innerHTML)&&yn(/<[/\w]/g,R.textContent)||be==="select"&&yn(/<template/i,R.innerHTML))return T(R),!0;if(!re[be]||U[be]){if(!U[be]&&qi(be)&&(le.tagNameCheck instanceof RegExp&&yn(le.tagNameCheck,be)||le.tagNameCheck instanceof Function&&le.tagNameCheck(be)))return!1;if(Hn&&!Nn[be]){var ut=_(R)||R.parentNode,An=w(R)||R.childNodes;if(An&&ut)for(var mn=An.length,tn=mn-1;tn>=0;--tn)ut.insertBefore(h(An[tn],!0),C(R))}return T(R),!0}return R instanceof i&&!A(R)||(be==="noscript"||be==="noembed")&&yn(/<\/no(script|embed)/i,R.innerHTML)?(T(R),!0):(he&&R.nodeType===3&&(se=R.textContent,se=xo(se,me," "),se=xo(se,Ne," "),R.textContent!==se&&(xi(t.removed,{element:R.cloneNode()}),R.textContent=se)),Nt("afterSanitizeElements",R,null),!1)},Vi=function(R,se,be){if(mt&&(se==="id"||se==="name")&&(be in s||be in hu))return!1;if(!(Me&&!pe[se]&&yn(Ie,se))){if(!(_e&&yn(it,se))){if(!xe[se]||pe[se]){if(!(qi(R)&&(le.tagNameCheck instanceof RegExp&&yn(le.tagNameCheck,R)||le.tagNameCheck instanceof Function&&le.tagNameCheck(R))&&(le.attributeNameCheck instanceof RegExp&&yn(le.attributeNameCheck,se)||le.attributeNameCheck instanceof Function&&le.attributeNameCheck(se))||se==="is"&&le.allowCustomizedBuiltInElements&&(le.tagNameCheck instanceof RegExp&&yn(le.tagNameCheck,be)||le.tagNameCheck instanceof Function&&le.tagNameCheck(be))))return!1}else if(!es[se]){if(!yn(H,xo(be,yt,""))){if(!((se==="src"||se==="xlink:href"||se==="href")&&R!=="script"&&$$(be,"data:")===0&&Er[R])){if(!(je&&!yn(Lt,xo(be,yt,"")))){if(be)return!1}}}}}}return!0},qi=function(R){return R.indexOf("-")>0},gk=function(R){var se,be,ut,An;Nt("beforeSanitizeAttributes",R,null);var mn=R.attributes;if(mn){var tn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:xe};for(An=mn.length;An--;){se=mn[An];var vu=se,nn=vu.name,hk=vu.namespaceURI;be=nn==="value"?se.value:M$(se.value),ut=ts(nn);var j4=be;if(tn.attrName=ut,tn.attrValue=be,tn.keepAttr=!0,tn.forceKeepAttr=void 0,Nt("uponSanitizeAttribute",R,tn),be=tn.attrValue,!tn.forceKeepAttr){if(!tn.keepAttr){W(nn,R);continue}if(yn(/\/>/i,be)){W(nn,R);continue}he&&(be=xo(be,me," "),be=xo(be,Ne," "));var K4=ts(R.nodeName);if(!Vi(K4,ut,be)){W(nn,R);continue}if(be!==j4)try{hk?R.setAttributeNS(hk,nn,be):R.setAttribute(nn,be)}catch{W(nn,R)}}}Nt("afterSanitizeAttributes",R,null)}},q4=function we(R){var se,be=de(R);for(Nt("beforeSanitizeShadowDOM",R,null);se=be.nextNode();)Nt("uponSanitizeShadowNode",se,null),!Ot(se)&&(se.content instanceof o&&we(se.content),gk(se));Nt("afterSanitizeShadowDOM",R,null)};return t.sanitize=function(we,R){var se,be,ut,An,mn;if(Fs=!we,Fs&&(we="<!-->"),typeof we!="string"&&!Ke(we)){if(typeof we.toString!="function")throw Sm("toString is not a function");if(we=we.toString(),typeof we!="string")throw Sm("dirty is not a string, aborting")}if(!t.isSupported){if(dr(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof we=="string")return e.toStaticHTML(we);if(Ke(we))return e.toStaticHTML(we.outerHTML)}return we}if(ft||bu(R),t.removed=[],typeof we=="string"&&($t=!1),$t){if(we.nodeName){var tn=ts(we.nodeName);if(!re[tn]||U[tn])throw Sm("root node is forbidden and cannot be sanitized in-place")}}else if(we instanceof a)se=$("<!---->"),be=se.ownerDocument.importNode(we,!0),be.nodeType===1&&be.nodeName==="BODY"||be.nodeName==="HTML"?se=be:se.appendChild(be);else{if(!ot&&!he&&!Re&&we.indexOf("<")===-1)return N&&Xe?N.createHTML(we):we;if(se=$(we),!se)return ot?null:Xe?I:""}se&&We&&T(se.firstChild);for(var vu=de($t?we:se);ut=vu.nextNode();)ut.nodeType===3&&ut===An||Ot(ut)||(ut.content instanceof o&&q4(ut.content),gk(ut),An=ut);if(An=null,$t)return we;if(ot){if(ct)for(mn=O.call(se.ownerDocument);se.firstChild;)mn.appendChild(se.firstChild);else mn=se;return xe.shadowroot&&(mn=K.call(n,mn,!0)),mn}var nn=Re?se.outerHTML:se.innerHTML;return Re&&re["!doctype"]&&se.ownerDocument&&se.ownerDocument.doctype&&se.ownerDocument.doctype.name&&yn(X$,se.ownerDocument.doctype.name)&&(nn="<!DOCTYPE "+se.ownerDocument.doctype.name+`>
`+nn),he&&(nn=xo(nn,me," "),nn=xo(nn,Ne," ")),N&&Xe?N.createHTML(nn):nn},t.setConfig=function(we){bu(we),ft=!0},t.clearConfig=function(){Ao=null,ft=!1},t.isValidAttribute=function(we,R,se){Ao||bu({});var be=ts(we),ut=ts(R);return Vi(be,ut,se)},t.addHook=function(we,R){typeof R=="function"&&(ge[we]=ge[we]||[],xi(ge[we],R))},t.removeHook=function(we){if(ge[we])return F$(ge[we])},t.removeHooks=function(we){ge[we]&&(ge[we]=[])},t.removeAllHooks=function(){ge={}},t}var J$=sS();const oS=V.each,eM=V.trim,tM=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],nM={ftp:21,http:80,https:443,mailto:25},sM=["img","video"],oM=(e,t)=>G(e)?!e:G(t)?!Ve(sM,t):!0,rM=e=>{try{return decodeURIComponent(e)}catch{return unescape(e)}},rS=(e,t,n)=>{const s=rM(t).replace(/\s/g,"");return e.allow_script_urls?!1:/((java|vb)script|mhtml):/i.test(s)?!0:e.allow_html_data_urls?!1:/^data:image\//i.test(s)?oM(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(s):/^data:/i.test(s)};class us{static parseDataUri(t){let n;const s=decodeURIComponent(t).split(","),o=/data:([^;]+)/.exec(s[0]);return o&&(n=o[1]),{type:n,data:s[1]}}static isDomSafe(t,n,s={}){if(s.allow_script_urls)return!0;{const o=mo.decode(t).replace(/[\s\u0000-\u001F]+/g,"");return!rS(s,o,n)}}static getDocumentBaseUrl(t){var n;let s;return t.protocol.indexOf("http")!==0&&t.protocol!=="file:"?s=(n=t.href)!==null&&n!==void 0?n:"":s=t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/")),s}constructor(t,n={}){this.path="",this.directory="",t=eM(t),this.settings=n;const s=n.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t)){o.source=t;return}const r=t.indexOf("//")===0;if(t.indexOf("/")===0&&!r&&(t=(s&&s.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){const i=s?s.path:new us(document.location.href).directory;if((s==null?void 0:s.protocol)==="")t="//mce_host"+o.toAbsPath(i,t);else{const l=/([^#?]*)([#?]?.*)/.exec(t);l&&(t=(s&&s.protocol||"http")+"://mce_host"+o.toAbsPath(i,l[1])+l[2])}}t=t.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);a&&oS(tM,(i,l)=>{let c=a[l];c&&(c=c.replace(/\(mce_at\)/g,"@@")),o[i]=c}),s&&(o.protocol||(o.protocol=s.protocol),o.userInfo||(o.userInfo=s.userInfo),!o.port&&o.host==="mce_host"&&(o.port=s.port),(!o.host||o.host==="mce_host")&&(o.host=s.host),o.source=""),r&&(o.protocol="")}setPath(t){const n=/^(.*?)\/?(\w+)?$/.exec(t);n&&(this.path=n[0],this.directory=n[1],this.file=n[2]),this.source="",this.getURI()}toRelative(t){if(t==="./")return t;const n=new us(t,{base_uri:this});if(n.host!=="mce_host"&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&n.protocol!=="")return n.getURI();const s=this.getURI(),o=n.getURI();if(s===o||s.charAt(s.length-1)==="/"&&s.substr(0,s.length-1)===o)return s;let r=this.toRelPath(this.path,n.path);return n.query&&(r+="?"+n.query),n.anchor&&(r+="#"+n.anchor),r}toAbsolute(t,n){const s=new us(t,{base_uri:this});return s.getURI(n&&this.isSameOrigin(s))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;const n=this.protocol?nM[this.protocol]:null;if(n&&(this.port||n)==(t.port||n))return!0}return!1}toRelPath(t,n){let s=0,o="",r,a;const i=t.substring(0,t.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length){for(r=0,a=i.length;r<a;r++)if(r>=l.length||i[r]!==l[r]){s=r+1;break}}if(i.length<l.length){for(r=0,a=l.length;r<a;r++)if(r>=i.length||i[r]!==l[r]){s=r+1;break}}if(s===1)return n;for(r=0,a=i.length-(s-1);r<a;r++)o+="../";for(r=s-1,a=l.length;r<a;r++)r!==s-1?o+="/"+l[r]:o+=l[r];return o}toAbsPath(t,n){let s=0;const o=/\/$/.test(n)?"/":"",r=t.split("/"),a=n.split("/"),i=[];oS(r,u=>{u&&i.push(u)});const l=[];for(let u=a.length-1;u>=0;u--)if(!(a[u].length===0||a[u]===".")){if(a[u]===".."){s++;continue}if(s>0){s--;continue}l.push(a[u])}const c=i.length-s;let f;return c<=0?f=ka(l).join("/"):f=i.slice(0,c).join("/")+"/"+ka(l).join("/"),f.indexOf("/")!==0&&(f="/"+f),o&&f.lastIndexOf("/")!==f.length-1&&(f+=o),f}getURI(t=!1){let n;return(!this.source||t)&&(n="",t||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const aM=V.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),Nm="data-mce-type";let aS=0;const iS=(e,t,n,s)=>{var o,r,a,i;const l=t.validate,c=n.getSpecialElements();e.nodeType===oh&&!t.allow_conditional_comments&&/^\[if/i.test((o=e.nodeValue)!==null&&o!==void 0?o:"")&&(e.nodeValue=" "+e.nodeValue);const f=(r=s==null?void 0:s.tagName)!==null&&r!==void 0?r:e.nodeName.toLowerCase();if(e.nodeType!==Ra||f==="body")return;const u=S.fromDom(e),d=ul(u,Nm),v=Pn(u,"data-mce-bogus");if(!d&&ce(v)){v==="all"?at(u):js(u);return}const E=n.getElementRule(f);if(l&&!E){Se(c,f)?at(u):js(u);return}else G(s)&&(s.allowedTags[f]=!0);if(l&&E&&!d){if(M((a=E.attributesForced)!==null&&a!==void 0?a:[],h=>{It(u,h.name,h.value==="{$uid}"?`mce_${aS++}`:h.value)}),M((i=E.attributesDefault)!==null&&i!==void 0?i:[],h=>{ul(u,h.name)||It(u,h.name,h.value==="{$uid}"?`mce_${aS++}`:h.value)}),E.attributesRequired&&!ht(E.attributesRequired,h=>ul(u,h))){js(u);return}if(E.removeEmptyAttrs&&IN(u)){js(u);return}E.outputName&&E.outputName!==f&&Nb(u,E.outputName)}},lS=(e,t,n,s,o)=>!(s in aM&&rS(e,o,n))&&(!e.validate||t.isValid(n,s)||Ut(s,"data-")||Ut(s,"aria-")),cS=(e,t)=>e.hasAttribute(Nm)&&(t==="id"||t==="class"||t==="style"),uS=(e,t)=>e in t.getBoolAttrs(),iM=(e,t,n)=>{const{attributes:s}=e;for(let o=s.length-1;o>=0;o--){const r=s[o],a=r.name,i=r.value;!lS(t,n,e.tagName.toLowerCase(),a,i)&&!cS(e,a)?e.removeAttribute(a):uS(a,n)&&e.setAttribute(a,a)}},lM=(e,t)=>{const n=J$();return n.addHook("uponSanitizeElement",(s,o)=>{iS(s,e,t,o)}),n.addHook("uponSanitizeAttribute",(s,o)=>{const r=s.tagName.toLowerCase(),{attrName:a,attrValue:i}=o;o.keepAttr=lS(e,t,r,a,i),o.keepAttr?(o.allowedAttributes[a]=!0,uS(a,t)&&(o.attrValue=a),e.allow_svg_data_urls&&Ut(i,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):cS(s,a)&&(o.forceKeepAttr=!0)}),n},cM=(e,t)=>{const s={...{IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[]}};return s.PARSER_MEDIA_TYPE=t,e.allow_script_urls?s.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(s.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),s},uM=(e,t)=>{if(e.sanitize){const n=lM(e,t);return(s,o)=>{n.sanitize(s,cM(e,o)),n.removed=[]}}else return(n,s)=>{const o=document.createNodeIterator(n,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);let r;for(;r=o.nextNode();)iS(r,e,t),Q(r)&&iM(r,e,t)}},fS=V.makeMap,dS=V.extend,mS=(e,t,n)=>{const s=e.name,o=s in n&&s!=="title"&&s!=="textarea",r=t.childNodes;for(let a=0,i=r.length;a<i;a++){const l=r[a],c=new fn(l.nodeName.toLowerCase(),l.nodeType);if(Q(l)){const f=l.attributes;for(let u=0,d=f.length;u<d;u++){const v=f[u];c.attr(v.name,v.value)}}else z(l)?(c.value=l.data,o&&(c.raw=!0)):(lo(l)||SA(l)||wA(l))&&(c.value=l.data);mS(c,l,n),e.append(c)}},fM=(e,t,n)=>{const s=[];for(let o=e,r=o;o;r=o,o=o.walk()){const a=o;M(t,i=>i(a)),rt(a.parent)&&a!==e?o=r:s.push(a)}for(let o=s.length-1;o>=0;o--){const r=s[o];M(n,a=>a(r))}},dM=(e,t,n,s)=>{const o=n.validate,r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=dS(fS("script,style,head,html,body,title,meta,param"),t.getBlockElements()),l=db(t),c=/[ \t\r\n]+/g,f=/^[ \t\r\n]+/,u=/[ \t\r\n]+$/,d=_=>{let x=_.parent;for(;G(x);){if(x.name in a)return!0;x=x.parent}return!1},v=_=>{let x=_;for(;G(x);){if(x.name in l)return Si(t,r,a,x);x=x.parent}return!1},E=_=>_.name in i||eb(t,_),h=(_,x)=>{const N=x?_.prev:_.next;return G(N)||rt(_.parent)?!1:E(_.parent)&&(_.parent!==e||s.isRootContent===!0)};return[_=>{var x;if(_.type===3&&!d(_)){let N=(x=_.value)!==null&&x!==void 0?x:"";N=N.replace(c," "),(AF(_.prev,E)||h(_,!0))&&(N=N.replace(f,"")),N.length===0?_.remove():_.value=N}},_=>{var x;if(_.type===1){const N=t.getElementRule(_.name);if(o&&N){const I=Si(t,r,a,_);N.paddInEmptyBlock&&I&&v(_)?Jd(s,E,_):N.removeEmpty&&I?E(_)?_.remove():_.unwrap():N.paddEmpty&&(I||kF(_))&&Jd(s,E,_)}}else if(_.type===3&&!d(_)){let N=(x=_.value)!==null&&x!==void 0?x:"";(_.next&&E(_.next)||h(_,!1))&&(N=N.replace(u,"")),N.length===0?_.remove():_.value=N}}]},mM=(e,t)=>{var n;const s=(n=t.forced_root_block)!==null&&n!==void 0?n:e.forced_root_block;return s===!1?"":s===!0?"p":s},na=(e={},t=po())=>{const n=VE(),s=VE(),o={validate:!0,root_name:"body",sanitize:!0,...e},r=new DOMParser,a=uM(o,t),i=(x,N,I="html")=>{const oe=I==="xhtml"?"application/xhtml+xml":"text/html",F=Se(t.getSpecialElements(),N.toLowerCase()),D=F?`<${N}>${x}</${N}>`:x,O=I==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${D}</body></html>`:`<body>${D}</body>`,q=r.parseFromString(O,oe).body;return a(q,oe),F?q.firstChild:q},l=n.addFilter,c=n.getFilters,f=n.removeFilter,u=s.addFilter,d=s.getFilters,v=s.removeFilter,E=(x,N)=>{eE(t,x)&&N.push(x)},h=(x,N)=>{const I=ce(N.attr(Nm)),oe=N.type===1&&!Se(x,N.name)&&!eb(t,N);return N.type===3||oe&&!I},C=(x,N)=>{const I=dS(fS("script,style,head,html,body,title,meta,param"),t.getBlockElements()),oe=/^[ \t\r\n]+/,F=/[ \t\r\n]+$/;let D=x.firstChild,O=null;const q=K=>{var ee,ge;K&&(D=K.firstChild,D&&D.type===3&&(D.value=(ee=D.value)===null||ee===void 0?void 0:ee.replace(oe,"")),D=K.lastChild,D&&D.type===3&&(D.value=(ge=D.value)===null||ge===void 0?void 0:ge.replace(F,"")))};if(t.isValidChild(x.name,N.toLowerCase())){for(;D;){const K=D.next;h(I,D)?(O||(O=new fn(N,1),O.attr(o.forced_root_block_attrs),x.insert(O,D)),O.append(D)):(q(O),O=null),D=K}q(O)}},_={schema:t,addAttributeFilter:u,getAttributeFilters:d,removeAttributeFilter:v,addNodeFilter:l,getNodeFilters:c,removeNodeFilter:f,parse:(x,N={})=>{var I;const oe=o.validate,F=(I=N.context)!==null&&I!==void 0?I:o.root_name,D=i(x,F,N.format);bf(t,D);const O=new fn(F,11);mS(O,D,t.getSpecialElements()),D.innerHTML="";const[q,K]=dM(O,t,o,N),ee=[],ge=oe?it=>E(it,ee):Ee,me={nodes:{},attributes:{}},Ne=it=>XC(c(),d(),it,me);if(fM(O,[q,Ne],[K,ge]),ee.reverse(),oe&&ee.length>0)if(N.context){const{pass:it,fail:Lt}=wa(ee,yt=>yt.parent===O);tm(Lt,t,O,Ne),N.invalid=it.length>0}else tm(ee,t,O,Ne);const Ie=mM(o,N);return Ie&&(O.name==="body"||N.isRootContent)&&C(O,Ie),N.invalid||ZC(me,N),O}};return _$(_,o),m$(_,o,t),_},pM=e=>uc(e)?Co({validate:!1}).serialize(e):e,pS=(e,t,n)=>{const s=pM(e),o=t(s);if(o.isDefaultPrevented())return o;if(uc(e))if(o.content!==s){const r=na({validate:!1,forced_root_block:!1,sanitize:n}).parse(o.content,{context:e.name});return{...o,content:r}}else return{...o,content:e};else return o},gS=(e,t)=>{if(t.no_events)return ln.value(t);{const n=XP(e,t);return n.isDefaultPrevented()?ln.error(yy(e,{content:"",...n}).content):ln.value(n)}},hS=(e,t,n)=>n.no_events?t:pS(t,o=>yy(e,{...n,content:o}),qf(e)).content,Am=(e,t)=>{if(t.no_events)return ln.value(t);{const n=pS(t.content,s=>YP(e,{...t,content:s}),qf(e));return n.isDefaultPrevented()?(vy(e,n),ln.error(void 0)):ln.value(n)}},Tm=(e,t,n)=>{n.no_events||vy(e,{...n,content:t})},Dm=(e,t,n)=>({element:e,width:t,rows:n}),bS=(e,t)=>({element:e,cells:t}),gM=(e,t)=>({x:e,y:t}),vS=(e,t)=>Hs(e,t).bind(ll).getOr(1),hM=(e,t,n,s,o)=>{const r=vS(o,"rowspan"),a=vS(o,"colspan"),i=e.rows;for(let l=n;l<n+r;l++){i[l]||(i[l]=bS(kb(s),[]));for(let c=t;c<t+a;c++){const f=i[l].cells;f[c]=l===n&&c===t?o:Xo(o)}}},bM=(e,t,n)=>{const s=e.rows;return!!(s[n]?s[n].cells:[])[t]},vM=(e,t,n)=>{for(;bM(e,t,n);)t++;return t},yS=e=>Sn(e,(t,n)=>n.cells.length>t?n.cells.length:t,0),CS=(e,t)=>{const n=e.rows;for(let s=0;s<n.length;s++){const o=n[s].cells;for(let r=0;r<o.length;r++)if(ze(o[r],t))return m.some(gM(r,s))}return m.none()},ES=(e,t,n,s,o)=>{const r=[],a=e.rows;for(let i=n;i<=o;i++){const l=a[i].cells,c=t<s?l.slice(t,s+1):l.slice(s,t+1);r.push(bS(a[i].element,c))}return r},yM=(e,t,n)=>{const s=t.x,o=t.y,r=n.x,a=n.y,i=o<a?ES(e,s,o,r,a):ES(e,s,a,r,o);return Dm(e.element,yS(i),i)},CM=(e,t)=>{const n=Xo(e.element),s=S.fromTag("tbody");return zo(s,t),bt(n,s),n},EM=e=>Ue(e.rows,t=>{const n=Ue(t.cells,o=>{const r=kb(o);return zt(r,"colspan"),zt(r,"rowspan"),r}),s=Xo(t.element);return zo(s,n),s}),SM=e=>{const t=Dm(Xo(e),0,[]);return M(Yt(e,"tr"),(n,s)=>{M(Yt(n,"td,th"),(o,r)=>{hM(t,vM(t,r,s),s,n,o)})}),Dm(t.element,yS(t.rows),t.rows)},wM=e=>CM(e,EM(e)),_M=(e,t,n)=>CS(e,t).bind(s=>CS(e,n).map(o=>yM(e,s,o))),xM=e=>_t(e,t=>et(t)==="ul"||et(t)==="ol"),kM=(e,t)=>_t(e,n=>et(n)==="li"&&od(n,t)).fold(Y([]),n=>xM(e).map(s=>{const o=S.fromTag(et(s)),r=Na(Nh(s),(a,i)=>Ut(i,"list-style"));return fl(o,r),[S.fromTag("li"),o]}).getOr([])),NM=(e,t)=>{const n=Sn(t,(s,o)=>(bt(o,s),o),e);return t.length>0?bd([n]):n},AM=e=>za(e)?Xn(e).filter(ff).fold(Y([]),t=>[e,t]):ff(e)?[e]:[],TM=(e,t)=>{const n=S.fromDom(t.commonAncestorContainer),s=Zs(n,e),o=ve(s,zA),r=kM(s,t),a=o.concat(r.length?r:AM(n));return Ue(a,Xo)},SS=()=>bd([]),DM=(e,t)=>NM(S.fromDom(t.cloneContents()),TM(e,t)),RM=(e,t)=>Fa(t,"table",ne(ze,e)),PM=(e,t)=>RM(e,t[0]).bind(n=>{const s=t[0],o=t[t.length-1],r=SM(n);return _M(r,s,o).map(a=>bd([wM(a)]))}).getOrThunk(SS),OM=(e,t)=>t.length>0&&t[0].collapsed?SS():DM(e,t[0]),BM=(e,t)=>{const n=Yv(t,e);return n.length>0?PM(e,n):OM(e,t)},yc=(e,t)=>t>=0&&t<e.length&&Yr(e.charAt(t)),wS=e=>Gs(e.innerText),IM=e=>e.map(t=>t.nodeName).getOr("div").toLowerCase(),FM=e=>m.from(e.selection.getRng()).map(t=>{var n;const s=m.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),o=e.getBody(),r=IM(s),a=S.fromDom(t.cloneContents());sC(a),oC(a);const i=e.dom.add(o,r,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},a.dom),l=wS(i),c=Gs((n=i.textContent)!==null&&n!==void 0?n:"");if(e.dom.remove(i),yc(c,0)||yc(c,c.length-1)){const f=s.getOr(o),u=wS(f),d=u.indexOf(l);if(d===-1)return l;{const v=yc(u,d-1),E=yc(u,d+l.length);return(v?" ":"")+l+(E?" ":"")}}else return l}).getOr(""),LM=(e,t)=>{const n=e.selection.getRng(),s=e.dom.create("body"),o=e.selection.getSel(),r=Dd(e,nd(o)),a=t.contextual?BM(S.fromDom(e.getBody()),r).dom:n.cloneContents();return a&&s.appendChild(a),e.selection.serializer.serialize(s,t)},$M=(e,t)=>{if(t.format==="text")return FM(e);{const n=LM(e,t);return t.format==="tree"?n:e.selection.isCollapsed()?"":n}},MM=(e,t)=>({...e,format:t,get:!0,selection:!0,getInner:!0}),UM=(e,t,n={})=>{const s=MM(n,t);return gS(e,s).fold(Kt,o=>{const r=$M(e,o);return hS(e,r,o)})},Rm=0,_S=1,xS=2,zM=(e,t)=>{const n=e.length+t.length+2,s=new Array(n),o=new Array(n),r=(f,u,d)=>({start:f,end:u,diag:d}),a=(f,u,d,v,E)=>{const h=l(f,u,d,v);if(h===null||h.start===u&&h.diag===u-v||h.end===f&&h.diag===f-d){let C=f,w=d;for(;C<u||w<v;)C<u&&w<v&&e[C]===t[w]?(E.push([Rm,e[C]]),++C,++w):u-f>v-d?(E.push([xS,e[C]]),++C):(E.push([_S,t[w]]),++w)}else{a(f,h.start,d,h.start-h.diag,E);for(let C=h.start;C<h.end;++C)E.push([Rm,e[C]]);a(h.end,u,h.end-h.diag,v,E)}},i=(f,u,d,v)=>{let E=f;for(;E-u<v&&E<d&&e[E]===t[E-u];)++E;return r(f,E,u)},l=(f,u,d,v)=>{const E=u-f,h=v-d;if(E===0||h===0)return null;const C=E-h,w=h+E,_=(w%2===0?w:w+1)/2;s[1+_]=f,o[1+_]=u+1;let x,N,I,oe,F;for(x=0;x<=_;++x){for(N=-x;N<=x;N+=2){for(I=N+_,N===-x||N!==x&&s[I-1]<s[I+1]?s[I]=s[I+1]:s[I]=s[I-1]+1,oe=s[I],F=oe-f+d-N;oe<u&&F<v&&e[oe]===t[F];)s[I]=++oe,++F;if(C%2!==0&&C-x<=N&&N<=C+x&&o[I-C]<=s[I])return i(o[I-C],N+f-d,u,v)}for(N=C-x;N<=C+x;N+=2){for(I=N+_-C,N===C-x||N!==C+x&&o[I+1]<=o[I-1]?o[I]=o[I+1]-1:o[I]=o[I-1],oe=o[I]-1,F=oe-f+d-N;oe>=f&&F>=d&&e[oe]===t[F];)o[I]=oe--,F--;if(C%2===0&&-x<=N&&N<=x&&o[I]<=s[I+C])return i(o[I],N+f-d,u,v)}}return null},c=[];return a(0,e.length,0,t.length,c),c},kS=e=>Q(e)?e.outerHTML:z(e)?mo.encodeRaw(e.data,!1):lo(e)?"<!--"+e.data+"-->":"",HM=e=>{let t;const n=document.createElement("div"),s=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)s.appendChild(t);return s},WM=(e,t,n)=>{const s=HM(t);if(e.hasChildNodes()&&n<e.childNodes.length){const o=e.childNodes[n];e.insertBefore(s,o)}else e.appendChild(s)},VM=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){const n=e.childNodes[t];e.removeChild(n)}},qM=(e,t)=>{let n=0;M(e,s=>{s[0]===Rm?n++:s[0]===_S?(WM(t,s[1],n),n++):s[0]===xS&&VM(t,n)})},jM=e=>ve(Ue(rn(e.childNodes),kS),t=>t.length>0),KM=(e,t)=>{const n=Ue(rn(t.childNodes),kS);return qM(zM(n,e),t),t},GM=Fo(()=>document.implementation.createHTMLDocument("undo")),YM=e=>e.indexOf("</iframe>")!==-1,XM=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),ZM=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),Cc=e=>{const t=jM(e.getBody()),n=ys(t,o=>{const r=nC(e.serializer,o);return r.length>0?[r]:[]}),s=n.join("");return YM(s)?XM(n):ZM(s)},Pm=(e,t,n)=>{const s=n?t.beforeBookmark:t.bookmark;t.type==="fragmented"?KM(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:G(s)&&Hv(s)?!s.isFakeCaret:!0}),s&&(e.selection.moveToBookmark(s),e.selection.scrollIntoView())},Om=e=>e.type==="fragmented"?e.fragments.join(""):e.content,NS=e=>{const t=S.fromTag("body",GM());return ml(t,Om(e)),M(Yt(t,"*[data-mce-bogus]"),js),Rh(t)},QM=(e,t)=>Om(e)===Om(t),JM=(e,t)=>NS(e)===NS(t),Bm=(e,t)=>!e||!t?!1:QM(e,t)?!0:JM(e,t),Im=e=>e.get()===0,Ec=(e,t,n)=>{Im(n)&&(e.typing=t)},AS=(e,t)=>{e.typing&&(Ec(e,!1,t),e.add())},eU=e=>{e.typing&&(e.typing=!1,e.add())},tU=(e,t,n)=>{Im(t)&&n.set(Mf(e.selection))},nU=(e,t,n,s,o,r,a)=>{const i=Cc(e),l=V.extend(r||{},i);if(!Im(s)||e.removed)return null;const c=t.data[n.get()];if(e.dispatch("BeforeAddUndo",{level:l,lastLevel:c,originalEvent:a}).isDefaultPrevented()||c&&Bm(c,l))return null;t.data[n.get()]&&o.get().each(d=>{t.data[n.get()].beforeBookmark=d});const f=IR(e);if(f&&t.data.length>f){for(let d=0;d<t.data.length-1;d++)t.data[d]=t.data[d+1];t.data.length--,n.set(t.data.length)}l.bookmark=Mf(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(l),n.set(t.data.length-1);const u={level:l,lastLevel:c,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",u),e.dispatch("change",u)):e.dispatch("AddUndo",u),l},sU=(e,t,n)=>{t.data=[],n.set(0),t.typing=!1,e.dispatch("ClearUndos")},oU=(e,t,n,s,o)=>{if(t.transact(s)){const r=t.data[n.get()].bookmark,a=t.data[n.get()-1];Pm(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=r)}},rU=(e,t,n)=>{let s;return t.get()<n.length-1&&(t.set(t.get()+1),s=n[t.get()],Pm(e,s,!1),e.setDirty(!0),e.dispatch("Redo",{level:s})),s},aU=(e,t,n,s)=>{let o;return t.typing&&(t.add(),t.typing=!1,Ec(t,!1,n)),s.get()>0&&(s.set(s.get()-1),o=t.data[s.get()],Pm(e,o,!0),e.setDirty(!0),e.dispatch("Undo",{level:o})),o},iU=e=>{e.clear(),e.add()},lU=(e,t,n)=>n.get()>0||t.typing&&t.data[0]&&!Bm(Cc(e),t.data[0]),cU=(e,t)=>t.get()<e.data.length-1&&!e.typing,uU=(e,t,n)=>(AS(e,t),e.beforeChange(),e.ignore(n),e.add()),fU=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},dU=(e,t)=>{const n=e.dom,s=G(t)?t:e.getBody();M(n.select("table,a",s),o=>{switch(o.nodeName){case"TABLE":const r=zR(e),a=n.getAttrib(o,"border");(!a||a==="0")&&e.hasVisual?n.addClass(o,r):n.removeClass(o,r);break;case"A":if(!n.getAttrib(o,"href")){const i=n.getAttrib(o,"name")||o.id,l=bv(e);i&&e.hasVisual?n.addClass(o,l):n.removeClass(o,l)}break}}),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},TS=e=>({init:{bindEvents:Ee},undoManager:{beforeChange:(t,n)=>tU(e,t,n),add:(t,n,s,o,r,a)=>nU(e,t,n,s,o,r,a),undo:(t,n,s)=>aU(e,t,n,s),redo:(t,n)=>rU(e,t,n),clear:(t,n)=>sU(e,t,n),reset:t=>iU(t),hasUndo:(t,n)=>lU(e,t,n),hasRedo:(t,n)=>cU(t,n),transact:(t,n,s)=>uU(t,n,s),ignore:(t,n)=>fU(t,n),extra:(t,n,s,o)=>oU(e,t,n,s,o)},formatter:{match:(t,n,s,o)=>cm(e,t,n,s,o),matchAll:(t,n)=>CL(e,t,n),matchNode:(t,n,s,o)=>Rs(e,t,n,s,o),canApply:t=>SL(e,t),closest:t=>EL(e,t),apply:(t,n,s)=>LE(e,t,n,s),remove:(t,n,s,o)=>BE(e,t,n,s,o),toggle:(t,n,s)=>l$(e,t,n,s),formatChanged:(t,n,s,o,r)=>i$(e,t,n,s,o,r)},editor:{getContent:t=>XB(e,t),setContent:(t,n)=>hL(e,t,n),insertContent:(t,n)=>dL(e,t,n),addVisual:t=>dU(e,t)},selection:{getContent:(t,n)=>UM(e,t,n)},autocompleter:{addDecoration:t=>$B(e,t),removeDecoration:()=>UB(e,S.fromDom(e.getBody()))},raw:{getModel:()=>m.none()}}),mU=e=>{const t=c=>Qe(c)?c:{},{init:n,undoManager:s,formatter:o,editor:r,selection:a,autocompleter:i,raw:l}=e;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:s.beforeChange,add:s.add,undo:s.undo,redo:s.redo,clear:s.clear,reset:s.reset,hasUndo:s.hasUndo,hasRedo:s.hasRedo,transact:(c,f,u)=>s.transact(u),ignore:(c,f)=>s.ignore(f),extra:(c,f,u,d)=>s.extra(u,d)},formatter:{match:(c,f,u,d)=>o.match(c,t(f),d),matchAll:o.matchAll,matchNode:o.matchNode,canApply:c=>o.canApply(c),closest:c=>o.closest(c),apply:(c,f,u)=>o.apply(c,t(f)),remove:(c,f,u,d)=>o.remove(c,t(f)),toggle:(c,f,u)=>o.toggle(c,t(f)),formatChanged:(c,f,u,d,v)=>o.formatChanged(f,u,d,v)},editor:{getContent:c=>r.getContent(c),setContent:(c,f)=>({content:r.setContent(c,f),html:""}),insertContent:(c,f)=>(r.insertContent(c),""),addVisual:r.addVisual},selection:{getContent:(c,f)=>a.getContent(f)},autocompleter:{addDecoration:i.addDecoration,removeDecoration:i.removeDecoration},raw:{getModel:()=>m.some(l.getRawModel())}}},pU=()=>{const e=Y(null),t=Y("");return{init:{bindEvents:Ee},undoManager:{beforeChange:Ee,add:e,undo:e,redo:e,clear:Ee,reset:Ee,hasUndo:lt,hasRedo:lt,transact:e,ignore:Ee,extra:Ee},formatter:{match:lt,matchAll:Y([]),matchNode:Y(void 0),canApply:lt,closest:t,apply:Ee,remove:Ee,toggle:Ee,formatChanged:Y({unbind:Ee})},editor:{getContent:t,setContent:Y({content:"",html:""}),insertContent:Y(""),addVisual:Ee},selection:{getContent:t},autocompleter:{addDecoration:Ee,removeDecoration:Ee},raw:{getModel:Y(m.none())}}},Os=e=>Se(e.plugins,"rtc"),gU=e=>st(e.plugins,"rtc").bind(t=>m.from(t.setup)),hU=e=>{const t=e;return gU(e).fold(()=>(t.rtcInstance=TS(e),m.none()),n=>(t.rtcInstance=pU(),m.some(()=>n().then(s=>(t.rtcInstance=mU(s),s.rtc.isRemote)))))},Fm=e=>e.rtcInstance?e.rtcInstance:TS(e),pt=e=>{const t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},bU=(e,t,n)=>{pt(e).undoManager.beforeChange(t,n)},vU=(e,t,n,s,o,r,a)=>pt(e).undoManager.add(t,n,s,o,r,a),yU=(e,t,n,s)=>pt(e).undoManager.undo(t,n,s),CU=(e,t,n)=>pt(e).undoManager.redo(t,n),EU=(e,t,n)=>{pt(e).undoManager.clear(t,n)},SU=(e,t)=>{pt(e).undoManager.reset(t)},wU=(e,t,n)=>pt(e).undoManager.hasUndo(t,n),_U=(e,t,n)=>pt(e).undoManager.hasRedo(t,n),xU=(e,t,n,s)=>pt(e).undoManager.transact(t,n,s),kU=(e,t,n)=>{pt(e).undoManager.ignore(t,n)},NU=(e,t,n,s,o)=>{pt(e).undoManager.extra(t,n,s,o)},AU=(e,t,n,s,o)=>pt(e).formatter.match(t,n,s,o),TU=(e,t,n)=>pt(e).formatter.matchAll(t,n),DU=(e,t,n,s,o)=>pt(e).formatter.matchNode(t,n,s,o),RU=(e,t)=>pt(e).formatter.canApply(t),PU=(e,t)=>pt(e).formatter.closest(t),OU=(e,t,n,s)=>{pt(e).formatter.apply(t,n,s)},BU=(e,t,n,s,o)=>{pt(e).formatter.remove(t,n,s,o)},IU=(e,t,n,s)=>{pt(e).formatter.toggle(t,n,s)},FU=(e,t,n,s,o,r)=>pt(e).formatter.formatChanged(t,n,s,o,r),LU=(e,t)=>Fm(e).editor.getContent(t),$U=(e,t,n)=>Fm(e).editor.setContent(t,n),MU=(e,t,n)=>Fm(e).editor.insertContent(t,n),UU=(e,t,n)=>pt(e).selection.getContent(t,n),zU=(e,t)=>pt(e).editor.addVisual(t),DS=e=>pt(e).init.bindEvents(),HU=(e,t)=>pt(e).autocompleter.addDecoration(t),WU=e=>pt(e).autocompleter.removeDecoration(),VU=(e,t={})=>{const n=t.format?t.format:"html";return UU(e,n,t)},RS=e=>e.dom.length===0?(at(e),m.none()):m.some(e),qU=(e,t)=>e.filter(n=>pi.isBookmarkNode(n.dom)).bind(t?Ia:$o),jU=(e,t,n,s)=>{const o=e.dom,r=t.dom,a=s?o.length:r.length;s?(zd(o,r,!1,!s),n.setStart(r,a)):(zd(r,o,!1,!s),n.setEnd(r,a))},KU=(e,t)=>{Xn(e).each(n=>{const s=e.dom;t&&yi(n,P(s,0))?ac(s,0):!t&&Ci(n,P(s,s.length))&&Ud(s,s.length)})},PS=(e,t,n,s)=>{e.bind(o=>((s?Ud:ac)(o.dom,s?o.dom.length:0),t.filter(Rn).map(a=>jU(o,a,n,s)))).orThunk(()=>qU(t,s).or(t).filter(Rn).map(r=>KU(r,s)))},GU=(e,t)=>{const n=m.from(t.firstChild).map(S.fromDom),s=m.from(t.lastChild).map(S.fromDom);e.deleteContents(),e.insertNode(t);const o=n.bind($o).filter(Rn).bind(RS),r=s.bind(Ia).filter(Rn).bind(RS);PS(o,n,e,!0),PS(r,s,e,!1),e.collapse(!1)},YU=(e,t)=>({format:"html",...e,set:!0,selection:!0,content:t}),XU=(e,t)=>{if(t.format!=="raw"){const n=e.selection.getRng(),s=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=s?{context:s.nodeName.toLowerCase()}:{},r=e.parser.parse(t.content,{forced_root_block:!1,...o,...t});return Co({validate:!1},e.schema).serialize(r)}else return t.content},ZU=(e,t,n={})=>{const s=YU(n,t);Am(e,s).each(o=>{const r=XU(e,o),a=e.selection.getRng();GU(a,a.createContextualFragment(r)),e.selection.setRng(a),hi(e,a),Tm(e,r,o)})},OS=(e,t,n)=>{if(Se(e,t)){const s=ve(e[t],o=>o!==n);s.length===0?delete e[t]:e[t]=s}};var QU=(e,t)=>{let n,s;const o=(i,l)=>_t(l,c=>e.is(c,i)),r=i=>e.getParents(i,void 0,e.getRoot()),a=()=>{n={},s={},t.on("NodeChange",i=>{const l=i.element,c=r(l),f={};Je(n,(u,d)=>{o(d,c).each(v=>{s[d]||(M(u,E=>{E(!0,{node:v,selector:d,parents:c})}),s[d]=u),f[d]=u})}),Je(s,(u,d)=>{f[d]||(delete s[d],M(u,v=>{v(!1,{node:l,selector:d,parents:c})}))})})};return{selectorChangedWithUnbind:(i,l)=>(n||a(),n[i]||(n[i]=[]),n[i].push(l),o(i,r(t.selection.getStart())).each(()=>{s[i]=n[i]}),{unbind:()=>{OS(n,i,l),OS(s,i,l)}})}};const BS=e=>!!(e&&e.ownerDocument)&&Ws(S.fromDom(e.ownerDocument),S.fromDom(e)),JU=e=>e?BS(e.startContainer)&&BS(e.endContainer):!1,IS=(e,t,n,s)=>{let o,r;const{selectorChangedWithUnbind:a}=QU(e,s),i=(H,re)=>{const Ae=e.createRng();G(H)&&G(re)?(Ae.setStart(H,re),Ae.setEnd(H,re),N(Ae),w(!1)):(rd(e,Ae,s.getBody(),!0),N(Ae))},l=H=>VU(s,H),c=(H,re)=>ZU(s,H,re),f=H=>Gy(s.getBody(),x(),H),u=H=>Yy(s.getBody(),x(),H),d=(H,re)=>Lt.getBookmark(H,re),v=H=>Lt.moveToBookmark(H),E=(H,re)=>(DB(e,H,re).each(N),H),h=()=>{const H=x(),re=_();return!H||H.item?!1:H.compareEndPoints?H.compareEndPoints("StartToEnd",H)===0:!re||H.collapsed},C=()=>{const H=x(),re=s.getBody().querySelectorAll('[data-mce-selected="1"]');return re.length>0?oo(re,Ae=>e.isEditable(Ae.parentElement)):H.startContainer===H.endContainer?e.isEditable(H.startContainer):e.isEditable(H.startContainer)&&e.isEditable(H.endContainer)},w=H=>{const re=x();re.collapse(!!H),N(re)},_=()=>t.getSelection?t.getSelection():t.document.selection,x=()=>{let H;const re=(xe,ae,le)=>{try{return ae.compareBoundaryPoints(xe,le)}catch{return-1}},Ae=t.document;if(G(s.bookmark)&&!ir(s)){const xe=_d(s);if(xe.isSome())return xe.map(ae=>Dd(s,[ae])[0]).getOr(Ae.createRange())}try{const xe=_();xe&&!gl(xe.anchorNode)&&(xe.rangeCount>0?H=xe.getRangeAt(0):H=Ae.createRange(),H=Dd(s,[H])[0])}catch{}if(H||(H=Ae.createRange()),Ua(H.startContainer)&&H.collapsed){const xe=e.getRoot();H.setStart(xe,0),H.setEnd(xe,0)}return o&&r&&(re(H.START_TO_START,H,o)===0&&re(H.END_TO_END,H,o)===0?H=r:(o=null,r=null)),H},N=(H,re)=>{if(!JU(H))return;const Ae=_();if(H=s.dispatch("SetSelectionRange",{range:H,forward:re}).range,Ae){r=H;try{Ae.removeAllRanges(),Ae.addRange(H)}catch{}re===!1&&Ae.extend&&(Ae.collapse(H.endContainer,H.endOffset),Ae.extend(H.startContainer,H.startOffset)),o=Ae.rangeCount>0?Ae.getRangeAt(0):null}if(!H.collapsed&&H.startContainer===H.endContainer&&(Ae!=null&&Ae.setBaseAndExtent)&&H.endOffset-H.startOffset<2&&H.startContainer.hasChildNodes()){const ae=H.startContainer.childNodes[H.startOffset];ae&&ae.nodeName==="IMG"&&(Ae.setBaseAndExtent(H.startContainer,H.startOffset,H.endContainer,H.endOffset),(Ae.anchorNode!==H.startContainer||Ae.focusNode!==H.endContainer)&&Ae.setBaseAndExtent(ae,0,ae,1))}s.dispatch("AfterSetSelectionRange",{range:H,forward:re})},I=H=>(c(e.getOuterHTML(H)),H),oe=()=>AB(s.getBody(),x()),F=(H,re)=>TB(e,x(),H,re),D=()=>{const H=_(),re=H==null?void 0:H.anchorNode,Ae=H==null?void 0:H.focusNode;if(!H||!re||!Ae||gl(re)||gl(Ae))return!0;const xe=e.createRng(),ae=e.createRng();try{xe.setStart(re,H.anchorOffset),xe.collapse(!0),ae.setStart(Ae,H.focusOffset),ae.collapse(!0)}catch{return!0}return xe.compareBoundaryPoints(xe.START_TO_START,ae)<=0},it={dom:e,win:t,serializer:n,editor:s,expand:(H={type:"word"})=>N(ar(e).expand(x(),H)),collapse:w,setCursorLocation:i,getContent:l,setContent:c,getBookmark:d,moveToBookmark:v,select:E,isCollapsed:h,isEditable:C,isForward:D,setNode:I,getNode:oe,getSel:_,setRng:N,getRng:x,getStart:f,getEnd:u,getSelectedBlocks:F,normalize:()=>{const H=x(),re=_();if(!mP(re)&&Kl(s)){const Ae=ec(e,H);return Ae.each(xe=>{N(xe,D())}),Ae.getOr(H)}return H},selectorChanged:(H,re)=>(a(H,re),it),selectorChangedWithUnbind:a,getScrollContainer:()=>{let H,re=e.getRoot();for(;re&&re.nodeName!=="BODY";){if(re.scrollHeight>re.clientHeight){H=re;break}re=re.parentNode}return H},scrollIntoView:(H,re)=>{G(H)?ZO(s,H,re):hi(s,x(),re)},placeCaretAt:(H,re)=>N(Ny(H,re,s.getDoc())),getBoundingClientRect:()=>{const H=x();return H.collapsed?P.fromRangeStart(H).getClientRects()[0]:H.getBoundingClientRect()},destroy:()=>{t=o=r=null,yt.destroy()}},Lt=pi(it),yt=Sy(it,s);return it.bookmarkManager=Lt,it.controlSelection=yt,it},ez=(e,t,n)=>{e.addAttributeFilter("data-mce-tabindex",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.attr("tabindex",a.attr("data-mce-tabindex")),a.attr(o,null)}}),e.addAttributeFilter("src,href,style",(s,o)=>{const r="data-mce-"+o,a=t.url_converter,i=t.url_converter_scope;let l=s.length;for(;l--;){const c=s[l];let f=c.attr(r);f!==void 0?(c.attr(o,f.length>0?f:null),c.attr(r,null)):(f=c.attr(o),o==="style"?f=n.serializeStyle(n.parseStyle(f),c.name):a&&(f=a.call(i,f,o,c.name)),c.attr(o,f.length>0?f:null))}}),e.addAttributeFilter("class",s=>{let o=s.length;for(;o--;){const r=s[o];let a=r.attr("class");a&&(a=a.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),r.attr("class",a.length>0?a:null))}}),e.addAttributeFilter("data-mce-type",(s,o,r)=>{let a=s.length;for(;a--;){const i=s[a];i.attr("data-mce-type")==="bookmark"&&!r.cleanup&&(m.from(i.firstChild).exists(c=>{var f;return!Sl((f=c.value)!==null&&f!==void 0?f:"")})?i.unwrap():i.remove())}}),e.addNodeFilter("noscript",s=>{var o;let r=s.length;for(;r--;){const a=s[r].firstChild;a&&(a.value=mo.decode((o=a.value)!==null&&o!==void 0?o:""))}}),e.addNodeFilter("script,style",(s,o)=>{var r;const a=l=>l.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let i=s.length;for(;i--;){const l=s[i],c=l.firstChild,f=(r=c==null?void 0:c.value)!==null&&r!==void 0?r:"";if(o==="script"){const u=l.attr("type");u&&l.attr("type",u==="mce-no/type"?null:u.replace(/^mce\-/,"")),t.element_format==="xhtml"&&c&&f.length>0&&(c.value=`// <![CDATA[
`+a(f)+`
// ]]>`)}else t.element_format==="xhtml"&&c&&f.length>0&&(c.value=`<!--
`+a(f)+`
-->`)}}),e.addNodeFilter("#comment",s=>{let o=s.length;for(;o--;){const r=s[o],a=r.value;t.preserve_cdata&&(a==null?void 0:a.indexOf("[CDATA["))===0?(r.name="#cdata",r.type=4,r.value=n.decode(a.replace(/^\[CDATA\[|\]\]$/g,""))):(a==null?void 0:a.indexOf("mce:protected "))===0&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(a).substr(14))}}),e.addNodeFilter("xml:namespace,input",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.type===7?a.remove():a.type===1&&o==="input"&&!a.attr("type")&&a.attr("type","text")}}),e.addAttributeFilter("data-mce-type",s=>{M(s,o=>{o.attr("data-mce-type")==="format-caret"&&(o.isEmpty(e.schema.getNonEmptyElements())?o.remove():o.unwrap())})}),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.remove_trailing_brs&&qE(e,e.schema)},tz=e=>{const t=s=>(s==null?void 0:s.name)==="br",n=e.lastChild;if(t(n)){const s=n.prev;t(s)&&(n.remove(),s.remove())}},nz=(e,t,n)=>{let s;const o=e.dom;let r=t.cloneNode(!0);const a=document.implementation;if(a.createHTMLDocument){const i=a.createHTMLDocument("");V.each(r.nodeName==="BODY"?r.childNodes:[r],l=>{i.body.appendChild(i.importNode(l,!0))}),r.nodeName!=="BODY"?r=i.body.firstChild:r=i.body,s=o.doc,o.doc=i}return $P(e,{...n,node:r}),s&&(o.doc=s),r},sz=(e,t)=>G(e)&&e.hasEventListeners("PreProcess")&&!t.no_events,oz=(e,t,n)=>sz(e,n)?nz(e,t,n):t,rz=(e,t,n)=>{V.inArray(t,n)===-1&&(e.addAttributeFilter(n,(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.push(n))},az=(e,t,n)=>!t.no_events&&e?MP(e,{...t,content:n}).content:n,iz=(e,t,n)=>{const s=Gs(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||Cl(S.fromDom(t))?s:V.trim(s)},lz=(e,t,n)=>{const s=n.selection?{forced_root_block:!1,...n}:n,o=e.parse(t,s);return tz(o),o},cz=(e,t,n)=>Co(e,t).serialize(n),uz=(e,t,n,s,o)=>{const r=cz(t,n,s);return az(e,o,r)},fz=(e,t)=>{const n=["data-mce-selected"],s={entity_encoding:"named",remove_trailing_brs:!0,...e},o=t&&t.dom?t.dom:qe.DOM,r=t&&t.schema?t.schema:po(s),a=na(s,r);ez(a,s,o);const i=(l,c={})=>{const f={format:"html",...c},u=oz(t,l,f),d=iz(o,u,f),v=lz(a,d,f);return f.format==="tree"?v:uz(t,s,r,v,f)};return{schema:r,addNodeFilter:a.addNodeFilter,addAttributeFilter:a.addAttributeFilter,serialize:i,addRules:r.addValidElements,setRules:r.setValidElements,addTempAttr:ne(rz,a,n),getTempAttrs:Y(n),getNodeFilters:a.getNodeFilters,getAttributeFilters:a.getAttributeFilters,removeNodeFilter:a.removeNodeFilter,removeAttributeFilter:a.removeAttributeFilter}},FS=(e,t)=>{const n=fz(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},dz="html",mz=(e,t)=>({...e,format:t,get:!0,getInner:!0}),pz=(e,t={})=>{const n=t.format?t.format:dz,s=mz(t,n);return gS(e,s).fold(Kt,o=>{const r=LU(e,o);return hS(e,r,o)})},gz="html",hz=(e,t)=>({format:gz,...e,set:!0,content:t}),Lm=(e,t,n={})=>{const s=hz(n,t);return Am(e,s).map(o=>{const r=$U(e,o.content,o);return Tm(e,r.html,o),r.content}).getOr(t)},bz="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists".split(","),vz="template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),yz="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor".split(","),LS=[{name:"template",replacedWith:"Advanced Template"},{name:"rtc"}],$S=(e,t)=>{const n=ve(t,s=>Se(e,s));return Oo(n)},Cz=e=>{const t=$S(e,bz),n=e.forced_root_block;return(n===!1||n==="")&&t.push("forced_root_block (false only)"),Oo(t)},Ez=e=>$S(e,vz),MS=(e,t)=>{const n=V.makeMap(e.plugins," "),o=ve(t,r=>Se(n,r));return Oo(o)},Sz=e=>MS(e,yz),wz=e=>MS(e,LS.map(t=>t.name)),_z=(e,t)=>{const n=Cz(e),s=Sz(t),o=s.length>0,r=n.length>0,a=t.theme==="mobile";if(o||r||a){const i=`
- `,l=a?`

Themes:${i}mobile`:"",c=o?`

Plugins:${i}${s.join(i)}`:"",f=r?`

Options:${i}${n.join(i)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 6.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/6/migration-from-5x/ for more information."+l+c+f)}},xz=e=>_t(LS,t=>t.name===e).fold(()=>e,t=>t.replacedWith?`${e}, replaced by ${t.replacedWith}`:e),kz=(e,t)=>{const n=Ez(e),s=wz(t),o=s.length>0,r=n.length>0;if(o||r){const a=`
- `,i=o?`

Plugins:${a}${s.map(xz).join(a)}`:"",l=r?`

Options:${a}${n.join(a)}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+i+l)}},Nz=(e,t)=>{_z(e,t),kz(e,t)},Sc=qe.DOM,Az=e=>{Sc.setStyle(e.id,"display",e.orgDisplay)},wc=e=>m.from(e).each(t=>t.destroy()),Tz=e=>{const t=e;t.contentAreaContainer=t.formElement=t.container=t.editorContainer=null,t.bodyElement=t.contentDocument=t.contentWindow=null,t.iframeElement=t.targetElm=null;const n=e.selection;if(n){const s=n.dom;t.selection=n.win=n.dom=s.doc=null}},Dz=e=>{const t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,delete t._mceOldSubmit),Sc.unbind(t,"submit reset",e.formEventDelegate))},Rz=e=>{if(!e.removed){const{_selectionOverrides:t,editorUpload:n}=e,s=e.getBody(),o=e.getElement();s&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&G(o==null?void 0:o.nextSibling)&&Sc.remove(o.nextSibling),UP(e),e.editorManager.remove(e),!e.inline&&s&&Az(e),zP(e),Sc.remove(e.getContainer()),wc(t),wc(n),e.destroy()}},Pz=(e,t)=>{const{selection:n,dom:s}=e;if(!e.destroyed){if(!t&&!e.removed){e.remove();return}t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),wc(n),wc(s)),Dz(e),Tz(e),e.destroyed=!0}},_c=(()=>{const e={};return{add:(o,r)=>{e[o]=r},get:o=>e[o]?e[o]:{icons:{}},has:o=>Se(e,o)}})(),sa=Zt.ModelManager,US=(e,t)=>t.dom[e],zS=(e,t)=>parseInt(_s(t,e),10),Oz=ne(US,"clientWidth"),Bz=ne(US,"clientHeight"),Iz=ne(zS,"margin-top"),Fz=ne(zS,"margin-left"),Lz=e=>e.dom.getBoundingClientRect(),$z=(e,t,n)=>{const s=Oz(e),o=Bz(e);return t>=0&&n>=0&&t<=s&&n<=o},Mz=(e,t,n,s)=>{const o=Lz(t),r=e?o.left+t.dom.clientLeft+Fz(t):0,a=e?o.top+t.dom.clientTop+Iz(t):0,i=n-r,l=s-a;return{x:i,y:l}},Uz=(e,t,n)=>{const s=S.fromDom(e.getBody()),o=e.inline?s:qN(s),r=Mz(e.inline,o,t,n);return $z(o,r.x,r.y)},zz=e=>m.from(e).map(S.fromDom),Hz=e=>{const t=e.inline?e.getBody():e.getContentAreaContainer();return zz(t).map(Br).getOr(!1)};var Wz=()=>{const e=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,getArgs:e}};const HS=e=>{const t=[],n=()=>{const d=e.theme;return d&&d.getNotificationManagerImpl?d.getNotificationManagerImpl():Wz()},s=()=>m.from(t[0]),o=(d,v)=>d.type===v.type&&d.text===v.text&&!d.progressBar&&!d.timeout&&!v.progressBar&&!v.timeout,r=()=>{M(t,d=>{d.reposition()})},a=d=>{t.push(d)},i=d=>{xa(t,v=>v===d).each(v=>{t.splice(v,1)})},l=(d,v=!0)=>e.removed||!Hz(e)?{}:(v&&e.dispatch("BeforeOpenNotification",{notification:d}),_t(t,E=>o(n().getArgs(E),d)).getOrThunk(()=>{e.editorManager.setActive(e);const E=n().open(d,()=>{i(E),r(),s().fold(()=>e.focus(),h=>Uy(S.fromDom(h.getEl())))});return a(E),r(),e.dispatch("OpenNotification",{notification:{...E}}),E})),c=()=>{s().each(d=>{n().close(d),i(d),r()})},f=Y(t);return(d=>{d.on("SkinLoaded",()=>{const v=wR(d);v&&l({text:v,type:"warning",timeout:0},!1),r()}),d.on("show ResizeEditor ResizeWindow NodeChange",()=>{requestAnimationFrame(r)}),d.on("remove",()=>{M(t.slice(),v=>{n().close(v)})})})(e),{open:l,close:c,getNotifications:f}},oa=Zt.PluginManager,pr=Zt.ThemeManager;var Vz=()=>{const e=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e}};const WS=e=>{let t=[];const n=()=>{const h=e.theme;return h&&h.getWindowManagerImpl?h.getWindowManagerImpl():Vz()},s=(h,C)=>(...w)=>C?C.apply(h,w):void 0,o=h=>{e.dispatch("OpenWindow",{dialog:h})},r=h=>{e.dispatch("CloseWindow",{dialog:h})},a=h=>{t.push(h),o(h)},i=h=>{r(h),t=ve(t,C=>C!==h),t.length===0&&e.focus()},l=()=>m.from(t[t.length-1]),c=h=>{e.editorManager.setActive(e),wd(e),e.ui.show();const C=h();return a(C),C},f=(h,C)=>c(()=>n().open(h,C,i)),u=h=>c(()=>n().openUrl(h,i)),d=(h,C,w)=>{const _=n();_.alert(h,s(w||_,C))},v=(h,C,w)=>{const _=n();_.confirm(h,s(w||_,C))},E=()=>{l().each(h=>{n().close(h),i(h)})};return e.on("remove",()=>{M(t,h=>{n().close(h)})}),{open:f,openUrl:u,alert:d,confirm:v,close:E}},VS=(e,t)=>{e.notificationManager.open({type:"error",text:t})},xc=(e,t)=>{e._skinLoaded?VS(e,t):e.on("SkinLoaded",()=>{VS(e,t)})},qz=(e,t)=>{xc(e,as.translate(["Failed to upload image: {0}",t]))},ki=(e,t,n)=>{gy(e,t,{message:n}),console.error(n)},Ni=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,jz=(e,t,n)=>{ki(e,"PluginLoadError",Ni("plugin",t,n))},Kz=(e,t,n)=>{ki(e,"IconsLoadError",Ni("icons",t,n))},Gz=(e,t,n)=>{ki(e,"LanguageLoadError",Ni("language",t,n))},Yz=(e,t,n)=>{ki(e,"ThemeLoadError",Ni("theme",t,n))},Xz=(e,t,n)=>{ki(e,"ModelLoadError",Ni("model",t,n))},Zz=(e,t,n)=>{const s=as.translate(["Failed to initialize plugin: {0}",t]);gy(e,"PluginLoadError",{message:s}),kc(s,n),xc(e,s)},kc=(e,...t)=>{const n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},Qz=e=>/^[a-z0-9\-]+$/i.test(e),Jz=e=>qS(e,bR(e)),eH=e=>qS(e,dv(e)),qS=(e,t)=>{const n=e.editorManager.baseURL+"/skins/content",o=`content${e.editorManager.suffix}.css`;return Ue(t,r=>Qz(r)&&!e.inline?`${n}/${r}/${o}`:e.documentBaseURI.toAbsolute(r))},tH=e=>{e.contentCSS=e.contentCSS.concat(Jz(e),eH(e))},nH=e=>e?rn(e.getElementsByTagName("img")):[],sH=(e,t)=>{const n={};return{findAll:(o,r=St)=>{const a=ve(nH(o),l=>{const c=l.src;return l.hasAttribute("data-mce-bogus")||l.hasAttribute("data-mce-placeholder")||!c||c===Fe.transparentSrc?!1:Ut(c,"blob:")?!e.isUploaded(c)&&r(l):Ut(c,"data:")?r(l):!1}),i=Ue(a,l=>{const c=l.src;if(Se(n,c))return n[c].then(f=>ce(f)?f:{image:l,blobInfo:f.blobInfo});{const f=C$(t,c).then(u=>(delete n[c],{image:l,blobInfo:u})).catch(u=>(delete n[c],u));return n[c]=f,f}});return Promise.all(i)}}},jS=()=>{let n={};const s=(d,v)=>({status:d,resultUri:v}),o=d=>d in n;return{hasBlobUri:o,getResultUri:d=>{const v=n[d];return v?v.resultUri:null},isPending:d=>o(d)?n[d].status===1:!1,isUploaded:d=>o(d)?n[d].status===2:!1,markPending:d=>{n[d]=s(1,null)},markUploaded:(d,v)=>{n[d]=s(2,v)},removeFailed:d=>{delete n[d]},destroy:()=>{n={}}}};let oH=0;const rH=()=>{const e=()=>Math.round(Math.random()*4294967295).toString(36);return"s"+new Date().getTime().toString(36)+e()+e()+e()},aH=e=>e+oH+++rH(),iH=()=>{let e=[];const t=u=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[u.toLowerCase()]||"dat",n=(u,d,v,E,h)=>{if(ce(u))return s({id:u,name:E,filename:h,blob:d,base64:v});if(Qe(u))return s(u);throw new Error("Unknown input type")},s=u=>{if(!u.blob||!u.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const d=u.id||aH("blobid"),v=u.name||d,E=u.blob;return{id:Y(d),name:Y(v),filename:Y(u.filename||v+"."+t(E.type)),blob:Y(E),base64:Y(u.base64),blobUri:Y(u.blobUri||URL.createObjectURL(E)),uri:Y(u.uri)}},o=u=>{a(u.id())||e.push(u)},r=u=>_t(e,u).getOrUndefined(),a=u=>r(d=>d.id()===u);return{create:n,add:o,get:a,getByUri:u=>r(d=>d.blobUri()===u),getByData:(u,d)=>r(v=>v.base64()===u&&v.blob().type===d),findFirst:r,removeByUri:u=>{e=ve(e,d=>d.blobUri()===u?(URL.revokeObjectURL(d.blobUri()),!1):!0)},destroy:()=>{M(e,u=>{URL.revokeObjectURL(u.blobUri())}),e=[]}}},lH=(e,t)=>{const n={},s=(h,C)=>h?h.replace(/\/$/,"")+"/"+C.replace(/^\//,""):C,o=(h,C)=>new Promise((w,_)=>{const x=new XMLHttpRequest;x.open("POST",t.url),x.withCredentials=t.credentials,x.upload.onprogress=I=>{C(I.loaded/I.total*100)},x.onerror=()=>{_("Image upload failed due to a XHR Transport error. Code: "+x.status)},x.onload=()=>{if(x.status<200||x.status>=300){_("HTTP Error: "+x.status);return}const I=JSON.parse(x.responseText);if(!I||!ce(I.location)){_("Invalid JSON: "+x.responseText);return}w(s(t.basePath,I.location))};const N=new FormData;N.append("file",h.blob(),h.filename()),x.send(N)}),r=Be(t.handler)?t.handler:o,a=()=>new Promise(h=>{h([])}),i=(h,C)=>({url:C,blobInfo:h,status:!0}),l=(h,C)=>({url:"",blobInfo:h,status:!1,error:C}),c=(h,C)=>{V.each(n[h],w=>{w(C)}),delete n[h]},f=(h,C,w)=>(e.markPending(h.blobUri()),new Promise(_=>{let x,N;try{const I=()=>{x&&(x.close(),N=Ee)},oe=D=>{I(),e.markUploaded(h.blobUri(),D),c(h.blobUri(),i(h,D)),_(i(h,D))},F=D=>{I(),e.removeFailed(h.blobUri()),c(h.blobUri(),l(h,D)),_(l(h,D))};N=D=>{D<0||D>100||m.from(x).orThunk(()=>m.from(w).map(Bu)).each(O=>{x=O,O.progressBar.value(D)})},C(h,N).then(oe,D=>{F(ce(D)?{message:D}:D)})}catch(I){_(l(h,I))}})),u=h=>h===o,d=h=>{const C=h.blobUri();return new Promise(w=>{n[C]=n[C]||[],n[C].push(w)})},v=(h,C)=>(h=V.grep(h,w=>!e.isUploaded(w.blobUri())),Promise.all(V.map(h,w=>e.isPending(w.blobUri())?d(w):f(w,r,C))));return{upload:(h,C)=>!t.url&&u(r)?a():v(h,C)}},KS=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),GS=(e,t)=>lH(t,{url:uR(e),basePath:fR(e),credentials:dR(e),handler:mR(e)}),cH=e=>{const t=jS(),n=GS(e,t);return{upload:(s,o=!0)=>n.upload(s,o?KS(e):void 0)}},uH=(e,t)=>e.dom.isEmpty(t.dom)&&G(e.schema.getTextBlockElements()[et(t)]),fH=e=>t=>{uH(e,t)&&bt(t,S.fromHtml('<br data-mce-bogus="1" />'))},dH=e=>{const t=iH();let n,s;const o=jS(),r=[],a=x=>N=>e.selection?x(N):[],i=x=>x+(x.indexOf("?")===-1?"?":"&")+new Date().getTime(),l=(x,N,I)=>{let oe=0;do oe=x.indexOf(N,oe),oe!==-1&&(x=x.substring(0,oe)+I+x.substr(oe+N.length),oe+=I.length-N.length+1);while(oe!==-1);return x},c=(x,N,I)=>{const oe=`src="${I}"${I===Fe.transparentSrc?' data-mce-placeholder="1"':""}`;return x=l(x,`src="${N}"`,oe),x=l(x,'data-mce-src="'+N+'"','data-mce-src="'+I+'"'),x},f=(x,N)=>{M(e.undoManager.data,I=>{I.type==="fragmented"?I.fragments=Ue(I.fragments,oe=>c(oe,x,N)):I.content=c(I.content,x,N)})},u=(x,N)=>{const I=e.convertURL(N,"src");f(x.src,N),ro(S.fromDom(x),{src:lv(e)?i(N):N,"data-mce-src":I})},d=()=>(n||(n=GS(e,o)),C().then(a(x=>{const N=Ue(x,I=>I.blobInfo);return n.upload(N,KS(e)).then(a(I=>{const oe=[];let F=!1;const D=Ue(I,(O,q)=>{const{blobInfo:K,image:ee}=x[q];let ge=!1;return O.status&&lR(e)?(O.url&&!Gt(ee.src,O.url)&&(F=!0),t.removeByUri(ee.src),Os(e)||u(ee,O.url)):O.error&&(O.error.remove&&(f(ee.src,Fe.transparentSrc),oe.push(ee),ge=!0),qz(e,O.error.message)),{element:ee,status:O.status,uploadUri:O.url,blobInfo:K,removed:ge}});return oe.length>0&&!Os(e)?e.undoManager.transact(()=>{M(sf(oe),O=>{const q=Xn(O);at(O),q.each(fH(e)),t.removeByUri(O.dom.src)})}):F&&e.undoManager.dispatchChange(),D}))}))),v=()=>iv(e)?d():Promise.resolve([]),E=x=>oo(r,N=>N(x)),h=x=>{r.push(x)},C=()=>(s||(s=sH(o,t)),s.findAll(e.getBody(),E).then(a(x=>{const N=ve(x,I=>ce(I)?(xc(e,I),!1):I.uriType!=="blob");return Os(e)||M(N,I=>{f(I.image.src,I.blobInfo.blobUri()),I.image.src=I.blobInfo.blobUri(),I.image.removeAttribute("data-mce-src")}),N}))),w=()=>{t.destroy(),o.destroy(),s=n=null},_=x=>x.replace(/src="(blob:[^"]+)"/g,(N,I)=>{const oe=o.getResultUri(I);if(oe)return'src="'+oe+'"';let F=t.getByUri(I);return F||(F=Sn(e.editorManager.get(),(D,O)=>D||O.editorUpload&&O.editorUpload.blobCache.getByUri(I),void 0)),F?'src="data:'+F.blob().type+";base64,"+F.base64()+'"':N});return e.on("SetContent",()=>{iv(e)?v():C()}),e.on("RawSaveContent",x=>{x.content=_(x.content)}),e.on("GetContent",x=>{x.source_view||x.format==="raw"||x.format==="tree"||(x.content=_(x.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",x=>{M(x,N=>{const I=N.attr("src");if(!I||t.getByUri(I))return;const oe=o.getResultUri(I);oe&&N.attr("src",oe)})})}),{blobCache:t,addFilter:h,uploadImages:d,uploadImagesAuto:v,scanForImages:C,destroy:w}},mH=e=>{const t=e.dom,n=e.schema.type,s={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const o={inline:"span",styles:{textDecoration:"line-through"},exact:!0},r={inline:"strike",remove:"all",preserve_attributes:["class","style"]},a={inline:"s",remove:"all",preserve_attributes:["class","style"]};return n!=="html4"?[a,o,r]:[o,a,r]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(o,r,a)=>Q(o)&&o.hasAttribute("href"),onformat:(o,r,a)=>{V.each(a,(i,l)=>{t.setAttrib(o,l,i)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":o=>{var r;return(r=o==null?void 0:o.customValue)!==null&&r!==void 0?r:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return V.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd samp".split(/\s/),o=>{s[o]={block:o,remove:"all"}}),s},YS={remove_similar:!0,inherit:!1},ra={selector:"td,th",...YS},pH={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...ra},tablecellverticalalign:{styles:{"vertical-align":"%value"},...ra},tablecellbordercolor:{styles:{borderColor:"%value"},...ra},tablecellclass:{classes:["%value"],...ra},tableclass:{selector:"table",classes:["%value"],...YS},tablecellborderstyle:{styles:{borderStyle:"%value"},...ra},tablecellborderwidth:{styles:{borderWidth:"%value"},...ra}},gH=Y(pH),hH=e=>{const t={},n=a=>G(a)?t[a]:t,s=a=>Se(t,a),o=(a,i)=>{a&&(ce(a)?(Ge(i)||(i=[i]),M(i,l=>{Ye(l.deep)&&(l.deep=!Ln(l)),Ye(l.split)&&(l.split=!Ln(l)||kt(l)),Ye(l.remove)&&Ln(l)&&!kt(l)&&(l.remove="none"),Ln(l)&&kt(l)&&(l.mixed=!0,l.block_expand=!0),ce(l.classes)&&(l.classes=l.classes.split(/\s+/))}),t[a]=i):Je(a,(l,c)=>{o(c,l)}))},r=a=>(a&&t[a]&&delete t[a],t);return o(mH(e)),o(gH()),o(kR(e)),{get:n,has:s,register:o,unregister:r}},Nc=V.each,Un=qe.DOM,$m=e=>G(e)&&Qe(e),XS=(e,t)=>{const n=t&&t.schema||po({}),s=(l,c)=>{c.classes.length>0&&Un.addClass(l,c.classes.join(" ")),Un.setAttribs(l,c.attrs)},o=l=>{const c=ce(l)?{name:l,classes:[],attrs:{}}:l,f=Un.create(c.name);return s(f,c),f},r=(l,c)=>{const f=n.getElementRule(l.nodeName.toLowerCase()),u=f==null?void 0:f.parentsRequired;return u&&u.length?c&&Ve(u,c)?c:u[0]:!1},a=(l,c,f)=>{let u;const d=c[0],v=$m(d)?d.name:void 0,E=r(l,v);if(E)v===E?(u=d,c=c.slice(1)):u=E;else if(d)u=d,c=c.slice(1);else if(!f)return l;const h=u?o(u):Un.create("div");h.appendChild(l),f&&V.each(f,w=>{const _=o(w);h.insertBefore(_,l)});const C=$m(u)?u.siblings:void 0;return a(h,c,C)},i=Un.create("div");if(e.length>0){const l=e[0],c=o(l),f=$m(l)?l.siblings:void 0;i.appendChild(a(c,e.slice(1),f))}return i},bH=e=>{e=V.trim(e);let t="div";const n={name:t,classes:[],attrs:{},selector:e};return e!=="*"&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(s,o,r,a,i)=>{switch(o){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":V.inArray("checked disabled enabled read-only required".split(" "),r)!==-1&&(n.attrs[r]=r);break}if(a==="["){const l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=t||"div",n},vH=e=>ce(e)?(e=e.split(/\s*,\s*/)[0],e=e.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),V.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),t=>{const n=V.map(t.split(/(?:~\+|~|\+)/),bH),s=n.pop();return n.length&&(s.siblings=n),s}).reverse()):[],yH=(e,t)=>{let n="",s=NR(e);if(s==="")return"";const o=d=>ce(d)?d.replace(/%(\w+)/g,""):"",r=(d,v)=>Un.getStyle(v??e.getBody(),d,!0);if(ce(t)){const d=e.formatter.get(t);if(!d)return"";t=d[0]}if("preview"in t){const d=t.preview;if(d===!1)return"";s=d||s}let a=t.block||t.inline||"span",i;const l=vH(t.selector);l.length>0?(l[0].name||(l[0].name=a),a=t.selector,i=XS(l,e)):i=XS([a],e);const c=Un.select(a,i)[0]||i.firstChild;Nc(t.styles,(d,v)=>{const E=o(d);E&&Un.setStyle(c,v,E)}),Nc(t.attributes,(d,v)=>{const E=o(d);E&&Un.setAttrib(c,v,E)}),Nc(t.classes,d=>{const v=o(d);Un.hasClass(c,v)||Un.addClass(c,v)}),e.dispatch("PreviewFormats"),Un.setStyles(i,{position:"absolute",left:-65535}),e.getBody().appendChild(i);const f=r("fontSize"),u=/px$/.test(f)?parseInt(f,10):0;return Nc(s.split(" "),d=>{let v=r(d,c);if(!(d==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(v)&&(v=r(d),jl(v).toLowerCase()==="#ffffff"))&&!(d==="color"&&jl(v).toLowerCase()==="#000000")){if(d==="font-size"&&/em|%$/.test(v)){if(u===0)return;v=parseFloat(v)/(/%$/.test(v)?100:1)*u+"px"}d==="border"&&v&&(n+="padding:0 2px;"),n+=d+":"+v+";"}}),e.dispatch("AfterPreviewFormats"),Un.remove(i),n},CH=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},ZS=e=>{const t=hH(e),n=Rt({});return CH(e),OL(e),Os(e)||o$(n,e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(s,o,r)=>{OU(e,s,o,r)},remove:(s,o,r,a)=>{BU(e,s,o,r,a)},toggle:(s,o,r)=>{IU(e,s,o,r)},match:(s,o,r,a)=>AU(e,s,o,r,a),closest:s=>PU(e,s),matchAll:(s,o)=>TU(e,s,o),matchNode:(s,o,r,a)=>DU(e,s,o,r,a),canApply:s=>RU(e,s),formatChanged:(s,o,r,a)=>FU(e,n,s,o,r,a),getCssText:ne(yH,e)}},QS=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},EH=(e,t,n)=>{const s=Rt(!1),o=l=>{Ec(t,!1,n),t.add({},l)};e.on("init",()=>{t.add()}),e.on("BeforeExecCommand",l=>{const c=l.command;QS(c)||(AS(t,n),t.beforeChange())}),e.on("ExecCommand",l=>{const c=l.command;QS(c)||o(l)}),e.on("ObjectResizeStart cut",()=>{t.beforeChange()}),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",l=>{const c=l.keyCode;if(l.isDefaultPrevented())return;const f=Fe.os.isMacOS()&&l.key==="Meta";(c>=33&&c<=36||c>=37&&c<=40||c===45||l.ctrlKey||f)&&(o(),e.nodeChanged()),(c===46||c===8)&&e.nodeChanged(),s.get()&&t.typing&&!Bm(Cc(e),t.data[0])&&(e.isDirty()||e.setDirty(!0),e.dispatch("TypingUndo"),s.set(!1),e.nodeChanged())}),e.on("keydown",l=>{const c=l.keyCode;if(l.isDefaultPrevented())return;if(c>=33&&c<=36||c>=37&&c<=40||c===45){t.typing&&o(l);return}const f=l.ctrlKey&&!l.altKey||l.metaKey;if((c<16||c>20)&&c!==224&&c!==91&&!t.typing&&!f){t.beforeChange(),Ec(t,!0,n),t.add({},l),s.set(!0);return}(Fe.os.isMacOS()?l.metaKey:l.ctrlKey&&!l.altKey)&&t.beforeChange()}),e.on("mousedown",l=>{t.typing&&o(l)});const r=l=>l.inputType==="insertReplacementText",a=l=>l.inputType==="insertText"&&l.data===null,i=l=>l.inputType==="insertFromPaste"||l.inputType==="insertFromDrop";e.on("input",l=>{l.inputType&&(r(l)||a(l)||i(l))&&o(l)}),e.on("AddUndo Undo Redo ClearUndos",l=>{l.isDefaultPrevented()||e.nodeChanged()})},SH=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},JS=e=>{const t=go(),n=Rt(0),s=Rt(0),o={data:[],typing:!1,beforeChange:()=>{bU(e,n,t)},add:(r,a)=>vU(e,o,s,n,t,r,a),dispatchChange:()=>{e.setDirty(!0);const r=Cc(e);r.bookmark=Mf(e.selection),e.dispatch("change",{level:r,lastLevel:ol(o.data,s.get()).getOrUndefined()})},undo:()=>yU(e,o,n,s),redo:()=>CU(e,s,o.data),clear:()=>{EU(e,o,s)},reset:()=>{SU(e,o)},hasUndo:()=>wU(e,o,s),hasRedo:()=>_U(e,o,s),transact:r=>xU(e,o,n,r),ignore:r=>{kU(e,n,r)},extra:(r,a)=>{NU(e,o,s,r,a)}};return Os(e)||EH(e,o,n),SH(e),o},wH=[9,27,te.HOME,te.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,te.DOWN,te.UP,te.LEFT,te.RIGHT].concat(Fe.browser.isFirefox()?[224]:[]),e0="data-mce-placeholder",t0=e=>e.type==="keydown"||e.type==="keyup",n0=e=>{const t=e.keyCode;return t===te.BACKSPACE||t===te.DELETE},_H=e=>{if(t0(e)){const t=e.keyCode;return!n0(e)&&(te.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||Ve(wH,t))}else return!1},xH=e=>t0(e)&&!(n0(e)||e.type==="keyup"&&e.keyCode===229),kH=(e,t,n)=>{if(vt(S.fromDom(t),!1)){const s=t.firstElementChild;return s?e.getStyle(t.firstElementChild,"padding-left")||e.getStyle(t.firstElementChild,"padding-right")?!1:n===s.nodeName.toLowerCase():!0}else return!1},NH=e=>{var t;const n=e.dom,s=cn(e),o=(t=SR(e))!==null&&t!==void 0?t:"",r=(a,i)=>{if(_H(a))return;const l=e.getBody(),c=xH(a)?!1:kH(n,l,s);(n.getAttrib(l,e0)!==""!==c||i)&&(n.setAttrib(l,e0,c?o:null),n.setAttrib(l,"aria-placeholder",c?o:null),GP(e,c),e.on(c?"keydown":"keyup",r),e.off(c?"keyup":"keydown",r))};Cs(o)&&e.on("init",a=>{r(a,!0),e.on("change SetContent ExecCommand",r),e.on("paste",i=>$n.setEditorTimeout(e,()=>r(i)))})},AH=(e,t)=>({block:e,position:t}),TH=(e,t)=>({from:e,to:t}),Mm=(e,t)=>{const n=S.fromDom(e),s=S.fromDom(t.container());return ic(n,s).map(o=>AH(o,t))},DH=e=>!ze(e.from.block,e.to.block),s0=(e,t)=>Mo(t,o=>Ha(o)||rs(o.dom),o=>ze(o,e)).filter(bn).getOr(e),RH=(e,t)=>{const n=S.fromDom(e);return ze(s0(n,t.from.block),s0(n,t.to.block))},PH=e=>tt(e.from.block.dom)===!1&&tt(e.to.block.dom)===!1,OH=e=>{const t=n=>Wh(n)||vf(n.dom);return t(e.from.block)&&t(e.to.block)},BH=(e,t,n)=>dt(n.position.getNode())&&!vt(n.block)?Gr(!1,n.block.dom).bind(s=>s.isEqual(n.position)?In(t,e,s).bind(o=>Mm(e,o)):m.some(n)).getOr(n):n,IH=(e,t,n)=>{const s=Mm(e,P.fromRangeStart(n)),o=s.bind(r=>In(t,e,r.position).bind(a=>Mm(e,a).map(i=>BH(e,t,i))));return an(s,o,TH).filter(r=>DH(r)&&RH(e,r)&&PH(r)&&OH(r))},FH=(e,t,n)=>n.collapsed?IH(e,t,n):m.none(),LH=e=>{const t=Ht(e);return xa(t,On).fold(Y(t),n=>t.slice(0,n))},o0=e=>{const t=LH(e);return M(t,at),t},r0=(e,t)=>{const n=Zs(t,e);return _t(n.reverse(),s=>vt(s)).each(at)},$H=e=>ve(yh(e),t=>!vt(t)).length===0,MH=(e,t,n,s)=>{if(vt(n))return uo(n),Jt(n.dom);$H(s)&&vt(t)&&_n(s,S.fromTag("br"));const o=un(n.dom,P.before(s.dom));return M(o0(t),r=>{_n(s,r)}),r0(e,t),o},UH=(e,t,n)=>{if(vt(n)){if(vt(t)){const r=_a((a=>{const i=(l,c)=>Qu(l).fold(()=>c,f=>yl(f)?i(f,c.concat(Xo(f))):c);return i(a,[])})(n),(a,i)=>(Dh(a,i),i),El());Fr(t),bt(t,r)}return at(n),Jt(t.dom)}const s=Qn(n.dom);return M(o0(t),o=>{bt(n,o)}),r0(e,t),s},zH=(e,t)=>{const n=Zs(t,e);return m.from(n[n.length-1])},HH=(e,t)=>Ws(t,e)?zH(t,e):m.none(),a0=(e,t)=>{Gr(e,t.dom).bind(n=>m.from(n.getNode())).map(S.fromDom).filter(Vo).each(at)},i0=(e,t,n)=>(a0(!0,t),a0(!1,n),HH(t,n).fold(ne(UH,e,t,n),ne(MH,e,t,n))),l0=(e,t,n,s)=>t?i0(e,s,n):i0(e,n,s),Um=(e,t)=>{const n=S.fromDom(e.getBody());return FH(n.dom,t,e.selection.getRng()).map(o=>()=>{l0(n,t,o.from.block,o.to.block).each(r=>{e.selection.setRng(r.toRange())})})},WH=(e,t)=>{const n=t.getRng();return an(ic(e,S.fromDom(n.startContainer)),ic(e,S.fromDom(n.endContainer)),(s,o)=>ze(s,o)?m.none():m.some(()=>{n.deleteContents(),l0(e,!0,s,o).each(r=>{t.setRng(r.toRange())})})).getOr(m.none())},c0=(e,t)=>{const n=S.fromDom(t),s=ne(ze,e);return qs(n,Ha,s).isSome()},VH=(e,t)=>c0(e,t.startContainer)||c0(e,t.endContainer),qH=(e,t)=>{const n=un(e.dom,P.fromRangeStart(t)).isNone(),s=Qt(e.dom,P.fromRangeEnd(t)).isNone();return!VH(e,t)&&n&&s},jH=e=>m.some(()=>{e.setContent(""),e.selection.setCursorLocation()}),KH=e=>{const t=S.fromDom(e.getBody()),n=e.selection.getRng();return qH(t,n)?jH(e):WH(t,e.selection)},zm=(e,t)=>e.selection.isCollapsed()?m.none():KH(e),Qs=(e,t,n,s,o)=>m.from(t._selectionOverrides.showCaret(e,n,s,o)),GH=e=>{const t=e.ownerDocument.createRange();return t.selectNode(e),t},Ai=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?m.none():m.some(GH(t)),YH=(e,t,n)=>{const s=Gf(1,e.getBody(),t),o=P.fromRangeStart(s),r=o.getNode();if(oi(r))return Qs(1,e,r,!o.isAtEnd(),!1);const a=o.getNode(!0);if(oi(a))return Qs(1,e,a,!1,!1);const i=ur(e.dom.getRoot(),o.getNode());return oi(i)?Qs(1,e,i,!1,n):m.none()},Hm=(e,t,n)=>t.collapsed?YH(e,t,n).getOr(t):t,XH=e=>So(e)||bi(e),ZH=e=>wo(e)||vi(e),QH=(e,t)=>{z(t)&&t.data.length===0&&e.remove(t)},u0=(e,t,n,s,o,r)=>{Qs(s,e,r.getNode(!o),o,!0).each(a=>{if(t.collapsed){const i=t.cloneRange();o?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else t.deleteContents();e.selection.setRng(a)}),QH(e.dom,n)},JH=(e,t)=>{const n=e.selection.getRng();if(!z(n.commonAncestorContainer))return m.none();const s=t?Pt.Forwards:Pt.Backwards,o=Ts(e.getBody()),r=ne(Yf,t?o.next:o.prev),a=t?XH:ZH,i=ci(s,e.getBody(),n),l=r(i),c=l&&Mn(t,l);if(!c||!Hl(i,c))return m.none();if(a(c))return m.some(()=>u0(e,n,i.getNode(),s,t,c));const f=r(c);return f&&a(f)&&Hl(c,f)?m.some(()=>u0(e,n,i.getNode(),s,t,f)):m.none()},Wm=(e,t)=>JH(e,t),Vm=(e,t)=>{const n=e.getBody();return t?Jt(n).filter(So):Qn(n).filter(wo)},qm=e=>{const t=e.selection.getRng();return!t.collapsed&&(Vm(e,!0).exists(n=>n.isEqual(P.fromRangeStart(t)))||Vm(e,!1).exists(n=>n.isEqual(P.fromRangeEnd(t))))},e2=e=>G(e)&&(Ha(S.fromDom(e))||za(S.fromDom(e))),xn=ks.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),t2=(e,t)=>{const n=t.getNode(!e),s=e?"after":"before";return Q(n)&&n.getAttribute("data-mce-caret")===s},n2=(e,t,n,s)=>{const o=r=>yl(S.fromDom(r))&&!Ns(n,s,e);return Pv(!t,n).fold(()=>Pv(t,s).fold(lt,o),o)},f0=(e,t,n,s)=>{const o=s.getNode(!t);return ic(S.fromDom(e),S.fromDom(n.getNode())).map(r=>vt(r)?xn.remove(r.dom):xn.moveToElement(o)).orThunk(()=>m.some(xn.moveToElement(o)))},d0=(e,t,n)=>In(t,e,n).bind(s=>e2(s.getNode())||n2(e,t,n,s)?m.none():t&&tt(s.getNode())||!t&&tt(s.getNode(!0))?f0(e,t,n,s):t&&wo(n)||!t&&So(n)?m.some(xn.moveToPosition(s)):m.none()),s2=(e,t)=>rt(t)?m.none():e&&tt(t.nextSibling)?m.some(xn.moveToElement(t.nextSibling)):!e&&tt(t.previousSibling)?m.some(xn.moveToElement(t.previousSibling)):m.none(),o2=(e,t,n)=>n.fold(s=>m.some(xn.remove(s)),s=>m.some(xn.moveToElement(s)),s=>Ns(t,s,e)?m.none():m.some(xn.moveToPosition(s))),r2=(e,t,n)=>t2(t,n)?s2(t,n.getNode(!t)).orThunk(()=>d0(e,t,n)):d0(e,t,n).bind(s=>o2(e,n,s)),a2=(e,t,n)=>{const s=Gf(t?1:-1,e,n),o=P.fromRangeStart(s),r=S.fromDom(e);return!t&&wo(o)?m.some(xn.remove(o.getNode(!0))):t&&So(o)?m.some(xn.remove(o.getNode())):!t&&So(o)&&Ld(r,o)?cI(r,o).map(a=>xn.remove(a.getNode())):t&&wo(o)&&Fd(r,o)?uI(r,o).map(a=>xn.remove(a.getNode())):r2(e,t,o)},i2=(e,t)=>n=>(e._selectionOverrides.hideFakeCaret(),lr(e,t,S.fromDom(n)),!0),l2=(e,t)=>n=>{const s=t?P.before(n):P.after(n);return e.selection.setRng(s.toRange()),!0},c2=e=>t=>(e.selection.setRng(t.toRange()),!0),m0=(e,t)=>m.from(ur(e.getBody(),t)),u2=(e,t)=>{const n=e.selection.getNode();return m0(e,n).filter(tt).fold(()=>a2(e.getBody(),t,e.selection.getRng()).map(s=>()=>s.fold(i2(e,t),l2(e,t),c2(e))),()=>m.some(Ee))},f2=e=>{M(Yt(e,".mce-offscreen-selection"),at)},d2=(e,t)=>{const n=e.selection.getNode();return tt(n)&&!bl(n)?m0(e,n.parentNode).filter(tt).fold(()=>m.some(()=>{f2(S.fromDom(e.getBody())),lr(e,t,S.fromDom(e.selection.getNode())),Wd(e)}),()=>m.some(Ee)):qm(e)?m.some(()=>{MC(e,e.selection.getRng(),S.fromDom(e.getBody()))}):m.none()},p0=e=>{const t=e.dom,n=e.selection,s=ur(e.getBody(),n.getNode());if(rs(s)&&t.isBlock(s)&&t.isEmpty(s)){const o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(s,""),s.appendChild(o),n.setRng(P.before(o).toRange())}return!0},jm=(e,t)=>e.selection.isCollapsed()?u2(e,t):d2(e,t),m2=(e,t)=>{const n=P.fromRangeStart(e.selection.getRng());return In(t,e.getBody(),n).filter(s=>t?nI(s):sI(s)).bind(s=>Kf(t?0:-1,s)).map(s=>()=>e.selection.select(s))},Km=(e,t)=>e.selection.isCollapsed()?m2(e,t):m.none(),aa=z,g0=e=>aa(e)&&e.data[0]===Wt,h0=e=>aa(e)&&e.data[e.data.length-1]===Wt,b0=e=>{var t;return((t=e.ownerDocument)!==null&&t!==void 0?t:document).createTextNode(Wt)},p2=e=>{var t;if(aa(e.previousSibling))return h0(e.previousSibling)||e.previousSibling.appendData(Wt),e.previousSibling;if(aa(e))return g0(e)||e.insertData(0,Wt),e;{const n=b0(e);return(t=e.parentNode)===null||t===void 0||t.insertBefore(n,e),n}},g2=e=>{var t,n;if(aa(e.nextSibling))return g0(e.nextSibling)||e.nextSibling.insertData(0,Wt),e.nextSibling;if(aa(e))return h0(e)||e.appendData(Wt),e;{const s=b0(e);return e.nextSibling?(t=e.parentNode)===null||t===void 0||t.insertBefore(s,e.nextSibling):(n=e.parentNode)===null||n===void 0||n.appendChild(s),s}},Ac=(e,t)=>e?p2(t):g2(t),h2=ne(Ac,!0),b2=ne(Ac,!1),v0=(e,t)=>z(e.container())?Ac(t,e.container()):Ac(t,e.getNode()),y0=(e,t)=>{const n=t.get();return n&&e.container()===n&&fo(n)},Gm=(e,t)=>t.fold(n=>{er(e.get());const s=h2(n);return e.set(s),m.some(P(s,s.length-1))},n=>Jt(n).map(s=>{if(y0(s,e)){const o=e.get();return P(o,1)}else{er(e.get());const o=v0(s,!0);return e.set(o),P(o,1)}}),n=>Qn(n).map(s=>{if(y0(s,e)){const o=e.get();return P(o,o.length-1)}else{er(e.get());const o=v0(s,!1);return e.set(o),P(o,o.length-1)}}),n=>{er(e.get());const s=b2(n);return e.set(s),m.some(P(s,1))}),C0=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n].apply(null,t);if(s.isSome())return s}return m.none()},en=ks.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),E0=(e,t)=>{const n=vo(t,e);return n||e},v2=(e,t,n)=>{const s=BC(n),o=E0(t,s.container());return _o(e,o,s).fold(()=>Qt(o,s).bind(ne(_o,e,o)).map(r=>en.before(r)),m.none)},y2=(e,t)=>nr(e,t)===null,S0=(e,t,n)=>_o(e,t,n).filter(ne(y2,t)),C2=(e,t,n)=>{const s=IC(n);return S0(e,t,s).bind(o=>un(o,s).isNone()?m.some(en.start(o)):m.none())},E2=(e,t,n)=>{const s=BC(n);return S0(e,t,s).bind(o=>Qt(o,s).isNone()?m.some(en.end(o)):m.none())},S2=(e,t,n)=>{const s=IC(n),o=E0(t,s.container());return _o(e,o,s).fold(()=>un(o,s).bind(ne(_o,e,o)).map(r=>en.after(r)),m.none)},w0=e=>!OC(Ym(e)),Bs=(e,t,n)=>C0([v2,C2,E2,S2],[e,t,n]).filter(w0),Ym=e=>e.fold(Kt,Kt,Kt,Kt),_0=e=>e.fold(Y("before"),Y("start"),Y("end"),Y("after")),Tc=e=>e.fold(en.before,en.before,en.after,en.after),Xm=e=>e.fold(en.start,en.start,en.end,en.end),w2=(e,t)=>_0(e)===_0(t)&&Ym(e)===Ym(t),_2=(e,t,n,s,o,r)=>an(_o(t,n,s),_o(t,n,o),(a,i)=>a!==i&&HI(n,a,i)?en.after(e?a:i):r).getOr(r),x2=(e,t)=>e.fold(St,n=>!w2(n,t)),k2=(e,t,n,s,o)=>{const r=Mn(e,o);return In(e,n,r).map(ne(Mn,e)).fold(()=>s.map(Tc),l=>Bs(t,n,l).map(ne(_2,e,t,n,r,l)).filter(ne(x2,s))).filter(w0)},N2=(e,t)=>e?t.fold(on(m.some,en.start),m.none,on(m.some,en.after),m.none):t.fold(m.none,on(m.some,en.before),m.none,on(m.some,en.end)),A2=(e,t,n,s)=>{const o=Mn(e,s),r=Bs(t,n,o);return Bs(t,n,o).bind(ne(N2,e)).orThunk(()=>k2(e,t,n,r,s))},T2=e=>Be(e.selection.getSel().modify),x0=(e,t,n)=>{const s=e?1:-1;return t.setRng(P(n.container(),n.offset()+s).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},D2=(e,t)=>{const n=t.selection.getRng(),s=e?P.fromRangeEnd(n):P.fromRangeStart(n);return T2(t)?e&&df(s)?x0(!0,t.selection,s):!e&&mf(s)?x0(!1,t.selection,s):!1:!1};var Is;(function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"})(Is||(Is={}));const Dc=(e,t)=>e===Pt.Backwards?ka(t):t,R2=(e,t,n)=>e===Pt.Forwards?t.next(n):t.prev(n),P2=(e,t,n,s)=>dt(s.getNode(t===Pt.Forwards))?Is.Br:Ns(n,s)===!1?Is.Block:Is.Wrap,k0=(e,t,n,s)=>{const o=Ts(n);let r=s;const a=[];for(;r;){const i=R2(t,o,r);if(!i)break;if(dt(i.getNode(!1)))return t===Pt.Forwards?{positions:Dc(t,a).concat([i]),breakType:Is.Br,breakAt:m.some(i)}:{positions:Dc(t,a),breakType:Is.Br,breakAt:m.some(i)};if(!i.isVisible()){r=i;continue}if(e(r,i)){const l=P2(n,t,r,i);return{positions:Dc(t,a),breakType:l,breakAt:m.some(i)}}a.push(i),r=i}return{positions:Dc(t,a),breakType:Is.Eol,breakAt:m.none()}},N0=(e,t,n,s)=>t(n,s).breakAt.map(o=>{const r=t(n,o).positions;return e===Pt.Backwards?r.concat(o):[o].concat(r)}).getOr([]),Zm=(e,t)=>Sn(e,(n,s)=>n.fold(()=>m.some(s),o=>an(hn(o.getClientRects()),hn(s.getClientRects()),(r,a)=>{const i=Math.abs(t-r.left);return Math.abs(t-a.left)<=i?s:o}).or(n)),m.none()),Rc=(e,t)=>hn(t.getClientRects()).bind(n=>Zm(e,n.left)),Ti=ne(k0,P.isAbove,-1),Di=ne(k0,P.isBelow,1),A0=ne(N0,-1,Ti),T0=ne(N0,1,Di),O2=(e,t)=>Ti(e,t).breakAt.isNone(),B2=(e,t)=>Di(e,t).breakAt.isNone(),I2=e=>Jt(e).map(t=>[t].concat(Di(e,t).positions)).getOr([]),F2=e=>Qn(e).map(t=>Ti(e,t).positions.concat(t)).getOr([]),L2=(e,t)=>Rc(A0(e,t),t),$2=(e,t)=>Rc(T0(e,t),t),M2=tt,D0=(e,t)=>Math.abs(e.left-t),R0=(e,t)=>Math.abs(e.right-t),U2=e=>Nr(e,"node"),P0=(e,t)=>il(e,(n,s)=>{const o=Math.min(D0(n,t),R0(n,t)),r=Math.min(D0(s,t),R0(s,t));return r===o&&U2(s)&&M2(s.node)||r<o?s:n}),z2=e=>{const t=n=>Ue(n,s=>{const o=Qo(s);return o.node=e,o});if(Q(e))return t(e.getClientRects());if(z(e)){const n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}else return[]},O0=e=>ys(e,z2);var Ri;(function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"})(Ri||(Ri={}));const H2=(e,t,n,s)=>{let o=s;for(;o=ai(o,e,Gh,t);)if(n(o))return},B0=(e,t,n,s,o,r)=>{let a=0;const i=[],l=u=>{let d=O0([u]);e===-1&&(d=d.reverse());for(let v=0;v<d.length;v++){const E=d[v];if(!n(E,c)){if(i.length>0&&t(E,Io(i))&&a++,E.line=a,o(E))return!0;i.push(E)}}return!1},c=Io(r.getClientRects());if(!c)return i;const f=r.getNode();return f&&(l(f),H2(e,s,l,f)),i},W2=(e,t)=>t.line>e,V2=(e,t)=>t.line===e,q2=ne(B0,Ri.Up,Qa,Ja),j2=ne(B0,Ri.Down,Ja,Qa),I0=e=>Io(e.getClientRects()),K2=(e,t,n,s)=>{const o=Ts(t);let r,a,i,l;const c=[];let f=0;e===1?(r=o.next,a=Ja,i=Qa,l=P.after(s)):(r=o.prev,a=Qa,i=Ja,l=P.before(s));const u=I0(l);do{if(!l.isVisible())continue;const d=I0(l);if(i(d,u))continue;c.length>0&&a(d,Io(c))&&f++;const v=Qo(d);if(v.position=l,v.line=f,n(v))return c;c.push(v)}while(l=r(l));return c},F0=e=>t=>W2(e,t),Qm=e=>t=>V2(e,t),Js=(e,t)=>{e.selection.setRng(t),hi(e,e.selection.getRng())},Jm=(e,t,n)=>m.some(Hm(e,t,n)),L0=(e,t,n,s,o,r)=>{const a=t===Pt.Forwards,i=Ts(e.getBody()),l=ne(Yf,a?i.next:i.prev),c=a?s:o;if(!n.collapsed){const E=Bl(n);if(r(E))return Qs(t,e,E,t===Pt.Backwards,!1);if(qm(e)){const h=n.cloneRange();return h.collapse(t===Pt.Backwards),m.from(h)}}const f=ci(t,e.getBody(),n);if(c(f))return Ai(e,f.getNode(!a));let u=l(f);const d=qh(n);if(u)u=Mn(a,u);else return d?m.some(n):m.none();if(c(u))return Qs(t,e,u.getNode(!a),a,!1);const v=l(u);return v&&c(v)&&Hl(u,v)?Qs(t,e,v.getNode(!a),a,!1):d?Jm(e,u.toRange(),!1):m.none()},$0=(e,t,n,s,o,r)=>{const a=ci(t,e.getBody(),n),i=Io(a.getClientRects()),l=t===Ri.Down,c=e.getBody();if(!i)return m.none();if(qm(e)){const C=l?P.fromRangeEnd(n):P.fromRangeStart(n);return(l?$2:L2)(c,C).orThunk(()=>m.from(C)).map(_=>_.toRange())}const u=(l?j2:q2)(c,F0(1),a),d=ve(u,Qm(1)),v=i.left,E=P0(d,v);if(E&&r(E.node)){const C=Math.abs(v-E.left),w=Math.abs(v-E.right);return Qs(t,e,E.node,C<w,!1)}let h;if(s(a)?h=a.getNode():o(a)?h=a.getNode(!0):h=Bl(n),h){const C=K2(t,c,F0(1),h);let w=P0(ve(C,Qm(1)),v);if(w||(w=Io(ve(C,Qm(0))),w))return Jm(e,w.position.toRange(),!1)}return d.length===0?ep(e,l).filter(l?o:s).map(C=>Hm(e,C.toRange(),!1)):m.none()},ep=(e,t)=>{const n=e.selection.getRng(),s=t?P.fromRangeEnd(n):P.fromRangeStart(n),o=L1(s.container(),e.getBody());if(t){const r=Di(o,s);return Bo(r.positions)}else{const r=Ti(o,s);return hn(r.positions)}},M0=(e,t,n)=>ep(e,t).filter(n).exists(s=>(e.selection.setRng(s.toRange()),!0)),Pc=(e,t)=>{const n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},U0=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},z0=(e,t,n)=>Gm(t,n).map(s=>(Pc(e,s),n)),G2=(e,t,n)=>{const s=P.fromRangeStart(e);if(e.collapsed)return s;{const o=P.fromRangeEnd(e);return n?un(t,o).getOr(o):Qt(t,s).getOr(s)}},Y2=(e,t,n)=>{const s=e.getBody(),o=G2(e.selection.getRng(),s,n),r=ne(cr,e);return A2(n,r,s,o).bind(i=>z0(e,t,i))},X2=(e,t,n)=>{const s=Ue(Yt(S.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),a=>a.dom),o=ve(s,e),r=ve(n,e);M(sl(o,r),ne(U0,!1)),M(sl(r,o),ne(U0,!0))},Z2=(e,t)=>{const n=t.get();if(e.selection.isCollapsed()&&!e.composing&&n){const s=P.fromRangeStart(e.selection.getRng());P.isTextPosition(s)&&!WI(s)&&(Pc(e,x1(n,s)),t.set(null))}},Q2=(e,t,n,s)=>{if(t.selection.isCollapsed()){const o=ve(s,e);M(o,r=>{const a=P.fromRangeStart(t.selection.getRng());Bs(e,t.getBody(),a).bind(i=>z0(t,n,i))})}},H0=(e,t,n)=>si(e)?Y2(e,t,n).isSome():!1,W0=(e,t,n)=>si(t)?D2(e,t):!1,J2=e=>{const t=Rt(null),n=ne(cr,e);return e.on("NodeChange",s=>{si(e)&&(X2(n,e.dom,s.parents),Z2(e,t),Q2(n,e,t,s.parents))}),t},eW=ne(W0,!0),tW=ne(W0,!1),Oc=(e,t,n)=>{if(si(e)){const s=ep(e,t).getOrThunk(()=>{const o=e.selection.getRng();return t?P.fromRangeEnd(o):P.fromRangeStart(o)});return Bs(ne(cr,e),e.getBody(),s).exists(o=>{const r=Tc(o);return Gm(n,r).exists(a=>(Pc(e,a),!0))})}else return!1},nW=(e,t)=>{const n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},sW=e=>an(Jt(e),Qn(e),(t,n)=>{const s=Mn(!0,t),o=Mn(!1,n);return Qt(e,s).forall(r=>r.isEqual(o))}).getOr(!0),V0=(e,t)=>n=>Gm(t,n).map(s=>()=>Pc(e,s)),q0=(e,t,n,s)=>{const o=e.getBody(),r=ne(cr,e);e.undoManager.ignore(()=>{e.selection.setRng(nW(n,s)),Hd(e),Bs(r,o,P.fromRangeStart(e.selection.getRng())).map(Xm).bind(V0(e,t)).each(Sa)}),e.nodeChanged()},oW=(e,t)=>{const n=vo(t,e);return n||e},rW=(e,t,n,s)=>{const o=oW(e.getBody(),s.container()),r=ne(cr,e),a=Bs(r,o,s);return a.bind(l=>n?l.fold(Y(m.some(Xm(l))),m.none,Y(m.some(Tc(l))),m.none):l.fold(m.none,Y(m.some(Tc(l))),m.none,Y(m.some(Xm(l))))).map(V0(e,t)).getOrThunk(()=>{const l=ui(n,o,s),c=l.bind(f=>Bs(r,o,f));return an(a,c,()=>_o(r,o,s).bind(f=>sW(f)?m.some(()=>{lr(e,n,S.fromDom(f))}):m.none())).getOrThunk(()=>c.bind(()=>l.map(f=>()=>{n?q0(e,t,s,f):q0(e,t,f,s)})))})},tp=(e,t,n)=>{if(e.selection.isCollapsed()&&si(e)){const s=P.fromRangeStart(e.selection.getRng());return rW(e,t,n,s)}return m.none()},aW=e=>ef(e)>1,j0=(e,t)=>{const n=S.fromDom(e.getBody()),s=S.fromDom(e.selection.getStart()),o=Zs(s,n);return xa(o,t).fold(Y(o),r=>o.slice(0,r))},iW=e=>ef(e)===1,lW=e=>j0(e,t=>On(t)||aW(t)),cW=e=>j0(e,On),K0=(e,t)=>{const n=ne(fE,e);return ys(t,s=>n(s)?[s.dom]:[])},G0=e=>{const t=cW(e);return K0(e,t)},uW=(e,t,n,s)=>{const o=K0(t,s);if(o.length===0)lr(t,e,n);else{const r=uE(n.dom,o);t.selection.setRng(r.toRange())}},fW=(e,t)=>{const n=ve(lW(e),iW);return Bo(n).bind(s=>{const o=P.fromRangeStart(e.selection.getRng());return LC(t,o,s.dom)&&!dE(s)?m.some(()=>uW(t,e,s,n)):m.none()})},dW=(e,t)=>{const n=t.parentElement;return dt(t)&&!Et(n)&&e.dom.isEmpty(n)},mW=e=>dE(S.fromDom(e)),Y0=(e,t)=>{const n=e.selection.getStart(),s=dW(e,n)||mW(n)?uE(n,t):BL(e.selection.getRng(),t);e.selection.setRng(s.toRange())},pW=(e,t)=>{const n=sl(t,G0(e));n.length>0&&Y0(e,n)},X0=e=>z(e.startContainer),gW=e=>e.startOffset===0&&X0(e),hW=(e,t)=>{const n=t.startContainer.parentElement;return!Et(n)&&fE(e,S.fromDom(n))},bW=e=>{const t=e.startContainer.parentNode,n=e.endContainer.parentNode;return!Et(t)&&!Et(n)&&t.isEqualNode(n)},vW=e=>{const t=e.endContainer;return e.endOffset===(z(t)?t.length:t.childNodes.length)},yW=e=>bW(e)&&vW(e),CW=e=>!e.endContainer.isEqualNode(e.commonAncestorContainer),EW=e=>yW(e)||CW(e),SW=e=>{const t=e.selection.getRng();return gW(t)&&hW(e,t)&&EW(t)},wW=e=>{if(SW(e)){const t=G0(e);return m.some(()=>{Hd(e),pW(e,t)})}else return m.none()},np=(e,t)=>e.selection.isCollapsed()?fW(e,t):wW(e),_W=e=>bL(e,t=>Jn(t.dom),On),xW=e=>_W(S.fromDom(e.selection.getStart())),kW=e=>{const t=e.selection.getRng();return t.collapsed&&(X0(t)||e.dom.isEmpty(t.startContainer))&&!xW(e)},Pi=e=>(kW(e)&&Y0(e,[]),!0),sp=(e,t,n)=>G(n)?m.some(()=>{e._selectionOverrides.hideFakeCaret(),lr(e,t,S.fromDom(n))}):m.none(),NW=(e,t)=>{const n=t?bi:vi,s=t?Pt.Forwards:Pt.Backwards,o=ci(s,e.getBody(),e.selection.getRng());return n(o)?sp(e,t,o.getNode(!t)):m.from(Mn(t,o)).filter(r=>n(r)&&Hl(o,r)).bind(r=>sp(e,t,r.getNode(!t)))},AW=(e,t)=>{const n=e.selection.getNode();return xs(n)?sp(e,t,n):m.none()},op=(e,t)=>e.selection.isCollapsed()?NW(e,t):AW(e,t),TW=e=>Mo(e,t=>rs(t.dom)||tt(t.dom)).exists(t=>rs(t.dom)),rp=e=>ll(e??"").getOr(0),Z0=(e,t)=>{const n=e||$A(t)?"margin":"padding",s=_s(t,"direction")==="rtl"?"-right":"-left";return n+s},DW=(e,t,n,s,o,r)=>{const a=Z0(n,S.fromDom(r)),i=rp(e.getStyle(r,a));if(t==="outdent"){const l=Math.max(0,i-s);e.setStyle(r,a,l?l+o:"")}else{const l=i+s+o;e.setStyle(r,a,l)}},RW=(e,t)=>oo(t,n=>{const s=Z0(fv(e),n),o=dl(n,s).map(rp).getOr(0);return e.dom.getContentEditable(n.dom)!=="false"&&o>0}),Q0=e=>{const t=ew(e);return!e.mode.isReadOnly()&&(t.length>1||RW(e,t))},J0=e=>ff(e)||za(e),PW=e=>Xn(e).exists(J0),ew=e=>ve(sf(e.selection.getSelectedBlocks()),t=>!J0(t)&&!PW(t)&&TW(t)),tw=(e,t)=>{var n,s;const{dom:o}=e,r=hR(e),a=(s=(n=/[a-z%]+$/i.exec(r))===null||n===void 0?void 0:n[0])!==null&&s!==void 0?s:"px",i=rp(r),l=fv(e);M(ew(e),c=>{DW(o,t,l,i,a,c.dom)})},OW=e=>tw(e,"indent"),nw=e=>tw(e,"outdent"),sw=e=>{if(e.selection.isCollapsed()&&Q0(e)){const t=e.dom,n=e.selection.getRng(),s=P.fromRangeStart(n),o=t.getParent(n.startContainer,t.isBlock);if(o!==null&&Id(S.fromDom(o),s))return m.some(()=>nw(e))}return m.none()},ow=(e,t,n)=>kr([sw,jm,Wm,(s,o)=>tp(s,t,o),Um,Zd,Km,op,zm,np],s=>s(e,n)).filter(s=>e.selection.isEditable()),BW=(e,t)=>{ow(e,t,!1).fold(()=>{Hd(e),Wd(e)},Sa)},IW=(e,t)=>{ow(e,t,!0).fold(()=>qI(e),Sa)},FW=(e,t)=>{e.addCommand("delete",()=>{BW(e,t)}),e.addCommand("forwardDelete",()=>{IW(e,t)})},rw=5,LW=400,aw=e=>e.touches===void 0||e.touches.length!==1?m.none():m.some(e.touches[0]),$W=(e,t)=>{const n=Math.abs(e.clientX-t.x),s=Math.abs(e.clientY-t.y);return n>rw||s>rw},MW=e=>{const t=go(),n=Rt(!1),s=Rf(o=>{e.dispatch("longpress",{...o,type:"longpress"}),n.set(!0)},LW);e.on("touchstart",o=>{aw(o).each(r=>{s.cancel();const a={x:r.clientX,y:r.clientY,target:o.target};s.throttle(o),n.set(!1),t.set(a)})},!0),e.on("touchmove",o=>{s.cancel(),aw(o).each(r=>{t.on(a=>{$W(r,a)&&(t.clear(),n.set(!1),e.dispatch("longpresscancel"))})})},!0),e.on("touchend touchcancel",o=>{s.cancel(),o.type!=="touchcancel"&&t.get().filter(r=>r.target.isEqualNode(o.target)).each(()=>{n.get()?o.preventDefault():e.dispatch("tap",{...o,type:"tap"})})},!0)},ap=(e,t)=>Se(e,t.nodeName),UW=(e,t)=>z(t)?!0:Q(t)?!ap(e.getBlockElements(),t)&&!Fn(t)&&!jo(e,t):!1,zW=(e,t,n)=>ht(pC(S.fromDom(n),S.fromDom(t)),s=>ap(e,s.dom)),HW=(e,t)=>{if(z(t)){if(t.data.length===0)return!0;if(/^\s+$/.test(t.data)&&(!t.nextSibling||ap(e,t.nextSibling)))return!0}return!1},iw=e=>e.dom.create(cn(e),ni(e)),WW=e=>{const t=e.dom,n=e.selection,s=e.schema,o=s.getBlockElements(),r=n.getStart(),a=e.getBody();let i,l,c=!1;const f=cn(e);if(!r||!Q(r))return;const u=a.nodeName.toLowerCase();if(!s.isValidChild(u,f.toLowerCase())||zW(o,a,r))return;const d=n.getRng(),{startContainer:v,startOffset:E,endContainer:h,endOffset:C}=d,w=ir(e);let _=a.firstChild;for(;_;)if(Q(_)&&CT(s,_),UW(s,_)){if(HW(o,_)){l=_,_=_.nextSibling,t.remove(l);continue}i||(i=iw(e),a.insertBefore(i,_),c=!0),l=_,_=_.nextSibling,i.appendChild(l)}else i=null,_=_.nextSibling;c&&w&&(d.setStart(v,E),d.setEnd(h,C),n.setRng(d),e.nodeChanged())},lw=(e,t,n)=>{const s=S.fromDom(iw(e)),o=El();bt(s,o),n(t,s);const r=document.createRange();return r.setStartBefore(o.dom),r.setEndBefore(o.dom),r},VW=e=>{e.on("NodeChange",ne(WW,e))},cw=e=>t=>(" "+t.attr("class")+" ").indexOf(e)!==-1,qW=(e,t,n)=>function(s){const o=arguments,r=o[o.length-2],a=r>0?t.charAt(r-1):"";if(a==='"')return s;if(a===">"){const i=t.lastIndexOf("<",r);if(i!==-1&&t.substring(i,r).indexOf('contenteditable="false"')!==-1)return s}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(o[0])+'">'+e.dom.encode(typeof o[1]=="string"?o[1]:o[0])+"</span>"},jW=(e,t,n)=>{let s=t.length,o=n.content;if(n.format!=="raw"){for(;s--;)o=o.replace(t[s],qW(e,o,vv(e)));n.content=o}},KW=e=>{const t="contenteditable",n=" "+V.trim(l1(e))+" ",s=" "+V.trim(vv(e))+" ",o=cw(n),r=cw(s),a=c1(e);a.length>0&&e.on("BeforeSetContent",i=>{jW(e,a,i)}),e.parser.addAttributeFilter("class",i=>{let l=i.length;for(;l--;){const c=i[l];o(c)?c.attr(t,"true"):r(c)&&c.attr(t,"false")}}),e.serializer.addAttributeFilter(t,i=>{let l=i.length;for(;l--;){const c=i[l];!o(c)&&!r(c)||(a.length>0&&c.attr("data-mce-content")?(c.name="#text",c.type=3,c.raw=!0,c.value=c.attr("data-mce-content")):c.attr(t,null))}})},GW=e=>La(S.fromDom(e.getBody()),"*[data-mce-caret]").map(t=>t.dom).getOrNull(),uw=(e,t)=>{t.hasAttribute("data-mce-caret")&&(pf(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},YW=(e,t)=>{const n=GW(e);if(n){if(t.type==="compositionstart"){t.preventDefault(),t.stopPropagation(),uw(e,n);return}Vh(n)&&(uw(e,n),e.undoManager.add())}},XW=e=>{e.on("keyup compositionstart",ne(YW,e))},fw=tt,ZW=(e,t,n)=>L0(t,e,n,So,wo,fw),QW=(e,t,n)=>$0(t,e,n,r=>So(r)||dC(r),r=>wo(r)||mC(r),fw),JW=e=>{const t=e.dom.create(cn(e));return t.innerHTML='<br data-mce-bogus="1">',t},dw=(e,t,n)=>{const s=Ts(e.getBody()),o=ne(Yf,t===1?s.next:s.prev);if(n.collapsed){const r=e.dom.getParent(n.startContainer,"PRE");if(!r)return;if(!o(P.fromRangeStart(n))){const i=S.fromDom(JW(e));t===1?io(S.fromDom(r),i):_n(S.fromDom(r),i),e.selection.select(i.dom,!0),e.selection.collapse()}}},e3=(e,t)=>{const n=t?Pt.Forwards:Pt.Backwards,s=e.selection.getRng();return ZW(n,e,s).orThunk(()=>(dw(e,n,s),m.none()))},t3=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return QW(n,e,s).orThunk(()=>(dw(e,n,s),m.none()))},n3=(e,t)=>{const n=t?e.getEnd(!0):e.getStart(!0);return OC(n)?!t:t},mw=(e,t)=>e3(e,n3(e.selection,t)).exists(n=>(Js(e,n),!0)),pw=(e,t)=>t3(e,t).exists(n=>(Js(e,n),!0)),gw=(e,t)=>M0(e,t,t?wo:So),Bc=(e,t)=>Vm(e,!t).map(n=>{const s=n.toRange(),o=e.selection.getRng();return t?s.setStart(o.startContainer,o.startOffset):s.setEnd(o.endContainer,o.endOffset),s}).exists(n=>(Js(e,n),!0)),s3=e=>Ve(["figcaption"],et(e)),o3=(e,t)=>{const n=ne(ze,t);return Mo(S.fromDom(e.container()),On,n).filter(s3)},r3=(e,t,n)=>t?B2(e.dom,n):O2(e.dom,n),a3=(e,t)=>{const n=S.fromDom(e.getBody()),s=P.fromRangeStart(e.selection.getRng());return o3(s,n).exists(()=>{if(r3(n,t,s)){const r=lw(e,n,t?bt:Th);return e.selection.setRng(r),!0}else return!1})},hw=(e,t)=>e.selection.isCollapsed()?a3(e,t):!1,bw={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},i3=e=>Ue(e,t=>({...bw,...t})),l3=e=>Ue(e,t=>({...bw,...t})),vw=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,c3=(e,t)=>ys(i3(e),n=>vw(n,t)?[n]:[]),u3=(e,t)=>ys(l3(e),n=>vw(n,t)?[n]:[]),ye=(e,...t)=>()=>e.apply(null,t),Oi=(e,t)=>_t(c3(e,t),n=>n.action()),yw=(e,t)=>kr(u3(e,t),n=>n.action()),Cw=(e,t)=>{const n=t?Pt.Forwards:Pt.Backwards,s=e.selection.getRng();return L0(e,n,s,bi,vi,xs).exists(o=>(Js(e,o),!0))},Ew=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return $0(e,n,s,bi,vi,xs).exists(o=>(Js(e,o),!0))},Sw=(e,t)=>M0(e,t,t?vi:bi),ww=ks.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),Bi={...ww,none:e=>ww.none(e)},f3=(e,t)=>_w(e,t,St),_w=(e,t,n)=>ys(Ht(e),s=>ss(s,t)?n(s)?[s]:[]:_w(s,t,n)),d3=(e,t,n=lt)=>{if(n(t))return m.none();if(Ve(e,et(t)))return m.some(t);const s=o=>ss(o,"table")||n(o);return Fa(t,e.join(","),s)},m3=(e,t)=>d3(["td","th"],e,t),p3=e=>f3(e,"th,td"),xw=(e,t)=>Uo(e,"table",t),ip=(e,t,n,s,o=St)=>{const r=s===1;if(!r&&n<=0)return Bi.first(e[0]);if(r&&n>=e.length-1)return Bi.last(e[e.length-1]);{const a=n+s,i=e[a];return o(i)?Bi.middle(t,i):ip(e,t,a,s,o)}},kw=(e,t)=>xw(e,t).bind(n=>{const s=p3(n);return xa(s,r=>ze(e,r)).map(r=>({index:r,all:s}))}),g3=(e,t,n)=>kw(e,n).fold(()=>Bi.none(e),o=>ip(o.all,e,o.index,1,t)),h3=(e,t,n)=>kw(e,n).fold(()=>Bi.none(),o=>ip(o.all,e,o.index,-1,t)),b3=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+t*2,bottom:e.bottom+t*2,width:e.width+t,height:e.height+t}),v3=(e,t)=>ys(t,n=>{const s=b3(Qo(n.getBoundingClientRect()),-1);return[{x:s.left,y:e(s),cell:n},{x:s.right,y:e(s),cell:n}]}),y3=(e,t,n)=>Sn(e,(s,o)=>s.fold(()=>m.some(o),r=>{const a=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n)),i=Math.sqrt(Math.abs(o.x-t)+Math.abs(o.y-n));return m.some(i<a?o:r)}),m.none()),Nw=(e,t,n,s,o)=>{const r=Yt(S.fromDom(n),"td,th,caption").map(i=>i.dom),a=ve(v3(e,r),i=>t(i,o));return y3(a,s,o).map(i=>i.cell)},C3=e=>e.bottom,E3=e=>e.top,S3=(e,t)=>e.y<t,w3=(e,t)=>e.y>t,_3=ne(Nw,C3,S3),x3=ne(Nw,E3,w3),k3=(e,t)=>hn(t.getClientRects()).bind(n=>_3(e,n.left,n.top)).bind(n=>Rc(F2(n),t)),N3=(e,t)=>Bo(t.getClientRects()).bind(n=>x3(e,n.left,n.top)).bind(n=>Rc(I2(n),t)),A3=(e,t,n)=>n.breakAt.exists(s=>e(t,s).breakAt.isSome()),T3=e=>e.breakType===Is.Wrap&&e.positions.length===0,D3=e=>e.breakType===Is.Br&&e.positions.length===1,Aw=(e,t,n)=>{const s=e(t,n);return T3(s)||!dt(n.getNode())&&D3(s)?!A3(e,t,s):s.breakAt.isNone()},R3=ne(Aw,Ti),P3=ne(Aw,Di),O3=(e,t,n)=>{const s=P.fromRangeStart(t);return Gr(!e,n).exists(o=>o.isEqual(s))},B3=(e,t,n,s)=>{const o=e.selection.getRng(),r=t?1:-1;return kv()&&O3(t,o,n)?(Qs(r,e,n,!t,!1).each(a=>{Js(e,a)}),!0):!1},I3=(e,t,n)=>k3(t,n).orThunk(()=>hn(n.getClientRects()).bind(s=>Zm(A0(e,P.before(t)),s.left))).getOr(P.before(t)),F3=(e,t,n)=>N3(t,n).orThunk(()=>hn(n.getClientRects()).bind(s=>Zm(T0(e,P.after(t)),s.left))).getOr(P.after(t)),Tw=(e,t)=>{const n=t.getNode(e);return Ks(n)?m.some(n):m.none()},L3=(e,t,n)=>{t.undoManager.transact(()=>{const s=e?io:_n,o=lw(t,S.fromDom(n),s);Js(t,o)})},Dw=(e,t,n)=>{const s=Tw(!!t,n),o=t===!1;s.fold(()=>Js(e,n.toRange()),r=>Gr(o,e.getBody()).filter(a=>a.isEqual(n)).fold(()=>Js(e,n.toRange()),a=>L3(t,e,r)))},$3=(e,t,n,s)=>{const o=e.selection.getRng(),r=P.fromRangeStart(o),a=e.getBody();if(!t&&R3(s,r)){const i=I3(a,n,r);return Dw(e,t,i),!0}else if(t&&P3(s,r)){const i=F3(a,n,r);return Dw(e,t,i),!0}else return!1},Rw=(e,t,n)=>m.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(s=>m.from(e.dom.getParent(s,"table")).map(o=>n(e,t,o,s))).getOr(!1),Pw=(e,t)=>Rw(e,t,B3),Ow=(e,t)=>Rw(e,t,$3),M3=e=>{const t=Jr.exact(e,0,e,0);return AO(t)},Bw=(e,t,n)=>n.fold(m.none,m.none,(s,o)=>IB(o).map(r=>M3(r)),s=>(e.execCommand("mceTableInsertRowAfter"),Iw(e,t,s))),Iw=(e,t,n)=>Bw(e,t,g3(n,Ir)),U3=(e,t,n)=>Bw(e,t,h3(n,Ir)),Fw=(e,t)=>{const n=["table","li","dl"],s=S.fromDom(e.getBody()),o=i=>{const l=et(i);return ze(i,s)||Ve(n,l)},r=e.selection.getRng(),a=S.fromDom(t?r.endContainer:r.startContainer);return m3(a,o).map(i=>(xw(i,o).each(f=>{e.model.table.clearSelectedCells(f.dom)}),e.selection.collapse(!t),(t?Iw:U3)(e,o,i).each(f=>{e.selection.setRng(f)}),!0)).getOr(!1)},z3=(e,t,n)=>{const s=Fe.os.isMacOS()||Fe.os.isiOS();Oi([{keyCode:te.RIGHT,action:ye(mw,e,!0)},{keyCode:te.LEFT,action:ye(mw,e,!1)},{keyCode:te.UP,action:ye(pw,e,!1)},{keyCode:te.DOWN,action:ye(pw,e,!0)},...s?[{keyCode:te.UP,action:ye(Bc,e,!1),metaKey:!0,shiftKey:!0},{keyCode:te.DOWN,action:ye(Bc,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:te.RIGHT,action:ye(Pw,e,!0)},{keyCode:te.LEFT,action:ye(Pw,e,!1)},{keyCode:te.UP,action:ye(Ow,e,!1)},{keyCode:te.DOWN,action:ye(Ow,e,!0)},{keyCode:te.RIGHT,action:ye(Cw,e,!0)},{keyCode:te.LEFT,action:ye(Cw,e,!1)},{keyCode:te.UP,action:ye(Ew,e,!1)},{keyCode:te.DOWN,action:ye(Ew,e,!0)},{keyCode:te.RIGHT,action:ye(H0,e,t,!0)},{keyCode:te.LEFT,action:ye(H0,e,t,!1)},{keyCode:te.RIGHT,ctrlKey:!s,altKey:s,action:ye(eW,e,t)},{keyCode:te.LEFT,ctrlKey:!s,altKey:s,action:ye(tW,e,t)},{keyCode:te.UP,action:ye(hw,e,!1)},{keyCode:te.DOWN,action:ye(hw,e,!0)}],n).each(o=>{n.preventDefault()})},H3=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||z3(e,t,n)})},fs=(e,t)=>({container:e,offset:t}),Ic=qe.DOM,Fc=e=>t=>e===t?-1:0,W3=e=>t=>e.isBlock(t)||Ve(["BR","IMG","HR","INPUT"],t.nodeName)||e.getContentEditable(t)==="false",lp=(e,t,n)=>{if(z(e)&&t>=0)return m.some(fs(e,t));{const s=Zo(Ic);return m.from(s.backwards(e,t,Fc(e),n)).map(o=>fs(o.container,o.container.data.length))}},V3=(e,t,n)=>{if(z(e)&&t>=e.length)return m.some(fs(e,t));{const s=Zo(Ic);return m.from(s.forwards(e,t,Fc(e),n)).map(o=>fs(o.container,0))}},cp=(e,t,n)=>{if(!z(e))return m.none();const s=e.data;if(t>=0&&t<=s.length)return m.some(fs(e,t));{const o=Zo(Ic);return m.from(o.backwards(e,t,Fc(e),n)).bind(r=>{const a=r.container.data;return cp(r.container,t+a.length,n)})}},Lw=(e,t,n)=>{if(!z(e))return m.none();const s=e.data;if(t<=s.length)return m.some(fs(e,t));{const o=Zo(Ic);return m.from(o.forwards(e,t,Fc(e),n)).bind(r=>Lw(r.container,t-s.length,n))}},up=(e,t,n,s,o)=>{const r=Zo(e,W3(e));return m.from(r.backwards(t,n,s,o))},q3=e=>e.collapsed&&z(e.startContainer),$w=e=>Gs(e.toString().replace(/\u00A0/g," ")),Mw=e=>e!==""&&` \f
\r	\v`.indexOf(e)!==-1,fp=(e,t)=>e.substring(t.length),j3=(e,t,n)=>{let s;const o=n.charAt(0);for(s=t-1;s>=0;s--){const r=e.charAt(s);if(Mw(r))return m.none();if(o===r&&Gt(e,n,s,t))break}return m.some(s)},K3=(e,t,n,s=0)=>{if(!q3(t))return m.none();const o={text:"",offset:0},r=(i,l,c)=>(o.text=c+o.text,o.offset+=l,j3(o.text,o.offset,n).getOr(l)),a=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return up(e,t.startContainer,t.startOffset,r,a).bind(i=>{const l=t.cloneRange();if(l.setStart(i.container,i.offset),l.setEnd(t.endContainer,t.endOffset),l.collapsed)return m.none();const c=$w(l);return c.lastIndexOf(n)!==0||fp(c,n).length<s?m.none():m.some({text:fp(c,n),range:l,trigger:n})})},Uw=(e,t,n,s=0)=>MB(S.fromDom(t.startContainer)).fold(()=>K3(e,t,n,s),o=>{const r=e.createRng();r.selectNode(o.dom);const a=$w(r);return m.some({range:r,text:fp(a,n),trigger:n})}),G3=e=>e.nodeType===ih,Y3=e=>e.nodeType===Ra,zw=e=>{if(G3(e))return fs(e,e.data.length);{const t=e.childNodes;return t.length>0?zw(t[t.length-1]):fs(e,t.length)}},Hw=(e,t)=>{const n=e.childNodes;return n.length>0&&t<n.length?Hw(n[t],0):n.length>0&&Y3(e)&&n.length===t?zw(n[n.length-1]):fs(e,t)},X3=(e,t)=>{var n;const s=(n=e.getParent(t.container,e.isBlock))!==null&&n!==void 0?n:e.getRoot();return up(e,t.container,t.offset,(o,r)=>r===0?-1:r,s).filter(o=>{const r=o.container.data.charAt(o.offset-1);return!Mw(r)}).isSome()},Z3=e=>t=>{const n=Hw(t.startContainer,t.startOffset);return!X3(e,n)},Q3=(e,t,n)=>kr(n.triggers,s=>Uw(e,t,s)),J3=(e,t)=>{const n=t(),s=e.selection.getRng();return Q3(e.dom,s,n).bind(o=>Ww(e,t,o))},Ww=(e,t,n,s={})=>{var o;const r=t(),i=(o=e.selection.getRng().startContainer.nodeValue)!==null&&o!==void 0?o:"",l=ve(r.lookupByTrigger(n.trigger),f=>n.text.length>=f.minChars&&f.matches.getOrThunk(()=>Z3(e.dom))(n.range,i,n.text));if(l.length===0)return m.none();const c=Promise.all(Ue(l,f=>f.fetch(n.text,f.maxResults,s).then(d=>({matchText:n.text,items:d,columns:f.columns,onAction:f.onAction,highlightOn:f.highlightOn}))));return m.some({lookupData:c,context:n})};var ds;(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(ds||(ds={}));const dp=(e,t,n)=>e.stype===ds.Error?t(e.serror):n(e.svalue),eV=e=>{const t=[],n=[];return M(e,s=>{dp(s,o=>n.push(o),o=>t.push(o))}),{values:t,errors:n}},tV=(e,t)=>e.stype===ds.Error?{stype:ds.Error,serror:t(e.serror)}:e,nV=(e,t)=>e.stype===ds.Value?{stype:ds.Value,svalue:t(e.svalue)}:e,sV=(e,t)=>e.stype===ds.Value?t(e.svalue):e,oV=(e,t)=>e.stype===ds.Error?t(e.serror):e,Vw=e=>({stype:ds.Value,svalue:e}),qw=e=>({stype:ds.Error,serror:e}),Ft={fromResult:e=>e.fold(qw,Vw),toResult:e=>dp(e,ln.error,ln.value),svalue:Vw,partition:eV,serror:qw,bind:sV,bindError:oV,map:nV,mapError:tV,fold:dp},mp=e=>Qe(e)&&wn(e).length>100?" removed due to size":JSON.stringify(e,null,2),rV=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:Y("... (only showing first ten failures)")}]):e;return Ue(t,n=>"Failed path: ("+n.path.join(" > ")+`)
`+n.getErrorInfo())},Lc=(e,t)=>Ft.serror([{path:e,getErrorInfo:t}]),aV=(e,t,n)=>Lc(e,()=>'Could not find valid *required* value for "'+t+'" in '+mp(n)),iV=(e,t)=>Lc(e,()=>'Choice schema did not contain choice key: "'+t+'"'),lV=(e,t,n)=>Lc(e,()=>'The chosen schema: "'+n+'" did not exist in branches: '+mp(t)),cV=(e,t)=>Lc(e,Y(t)),uV=(e,t,n,s)=>st(n,s).fold(()=>lV(e,n,s),r=>r.extract(e.concat(["branch: "+s]),t)),fV=(e,t)=>({extract:(o,r)=>st(r,e).fold(()=>iV(o,e),i=>uV(o,r,t,i)),toString:()=>"chooseOn("+e+"). Possible values: "+wn(t)}),dV=(e,t)=>t,mV=(e,t)=>vs(e)&&vs(t)?$c(e,t):t,jw=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const n={};for(let s=0;s<t.length;s++){const o=t[s];for(const r in o)Se(o,r)&&(n[r]=e(n[r],o[r]))}return n},$c=jw(mV),pV=jw(dV),Kw=()=>({tag:"required",process:{}}),gV=e=>({tag:"defaultedThunk",process:e}),Gw=e=>gV(Y(e)),hV=()=>({tag:"option",process:{}}),bV=(e,t)=>e.length>0?Ft.svalue($c(t,pV.apply(void 0,e))):Ft.svalue(t),Yw=e=>on(Ft.serror,kg)(e),vV={consolidateObj:(e,t)=>{const n=Ft.partition(e);return n.errors.length>0?Yw(n.errors):bV(n.values,t)},consolidateArr:e=>{const t=Ft.partition(e);return t.errors.length>0?Yw(t.errors):Ft.svalue(t.values)}},yV=(e,t,n,s)=>({tag:"field",key:e,newKey:t,presence:n,prop:s}),CV=(e,t)=>({tag:"custom",newKey:e,instantiator:t}),Xw=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},pp=e=>{const t=(s,o)=>Ft.bindError(e(o),r=>cV(s,r)),n=Y("val");return{extract:t,toString:n}},EV=pp(Ft.svalue),SV=(e,t,n,s)=>st(t,n).fold(()=>aV(e,n,t),s),Zw=(e,t,n,s)=>{const o=st(e,t).getOrThunk(()=>n(e));return s(o)},wV=(e,t,n)=>n(st(e,t)),_V=(e,t,n,s)=>{const o=st(e,t).map(r=>r===!0?n(e):r);return s(o)},xV=(e,t,n,s,o)=>{const r=i=>o.extract(t.concat([s]),i),a=i=>i.fold(()=>Ft.svalue(m.none()),l=>{const c=o.extract(t.concat([s]),l);return Ft.map(c,m.some)});switch(e.tag){case"required":return SV(t,n,s,r);case"defaultedThunk":return Zw(n,s,e.process,r);case"option":return wV(n,s,a);case"defaultedOptionThunk":return _V(n,s,e.process,a);case"mergeWithThunk":return Zw(n,s,Y({}),i=>{const l=$c(e.process(n),i);return r(l)})}},kV=(e,t,n)=>{const s={},o=[];for(const r of n)Xw(r,(a,i,l,c)=>{const f=xV(l,e,t,a,c);Ft.fold(f,u=>{o.push(...u)},u=>{s[i]=u})},(a,i)=>{s[a]=i(t)});return o.length>0?Ft.serror(o):Ft.svalue(s)},gp=e=>({extract:(s,o)=>kV(s,o,e),toString:()=>`obj{
`+Ue(e,o=>Xw(o,(r,a,i,l)=>r+" -> "+l.toString(),(r,a)=>"state("+r+")")).join(`
`)+"}"}),Qw=e=>({extract:(s,o)=>{const r=Ue(o,(a,i)=>e.extract(s.concat(["["+i+"]"]),a));return vV.consolidateArr(r)},toString:()=>"array("+e.toString()+")"}),NV=e=>pp(t=>e(t).fold(Ft.serror,Ft.svalue)),AV=(e,t,n)=>{const s=t.extract([e],n);return Ft.mapError(s,o=>({input:n,errors:o}))},TV=(e,t,n)=>Ft.toResult(AV(e,t,n)),DV=e=>`Errors: 
`+rV(e.errors).join(`
`)+`

Input object: `+mp(e.input),Jw=(e,t)=>fV(e,rl(t,gp)),RV=Y(EV),Mc=(e,t)=>pp(n=>{const s=typeof n;return e(n)?Ft.svalue(n):Ft.serror(`Expected type: ${t} but got: ${s}`)}),PV=Mc(Tt,"number"),Uc=Mc(ce,"string"),OV=Mc(Dn,"boolean"),hp=Mc(Be,"function"),Ii=yV,e_=CV,BV=e=>NV(t=>Ve(e,t)?ln.value(t):ln.error(`Unsupported value: "${t}", choose one of "${e.join(", ")}".`)),t_=(e,t)=>Ii(e,e,Kw(),t),n_=e=>t_(e,Uc),s_=e=>t_(e,hp),IV=(e,t)=>Ii(e,e,Kw(),Qw(t)),bp=(e,t)=>Ii(e,e,hV(),t),zc=e=>bp(e,Uc),FV=e=>bp(e,hp),LV=(e,t)=>Ii(e,e,Gw(t),RV()),ia=(e,t,n)=>Ii(e,e,Gw(t),n),o_=(e,t)=>ia(e,t,PV),$V=(e,t)=>ia(e,t,Uc),r_=(e,t,n)=>ia(e,t,BV(n)),vp=(e,t)=>ia(e,t,OV),yp=(e,t)=>ia(e,t,hp),MV=(e,t,n)=>ia(e,t,Qw(n)),UV=n_("type"),zV=s_("fetch"),Cp=s_("onAction"),HV=yp("onSetup",()=>Ee),WV=zc("text"),VV=zc("icon"),qV=zc("tooltip"),jV=zc("label"),KV=vp("active",!1),GV=vp("enabled",!0),a_=vp("primary",!1),YV=e=>LV("columns",e),Fi=e=>$V("type",e),XV=gp([UV,n_("trigger"),o_("minChars",1),YV(1),o_("maxResults",10),FV("matches"),zV,Cp,MV("highlightOn",[],Uc)]),ZV=e=>TV("Autocompleter",XV,{trigger:e.ch,...e}),Ep=[GV,qV,VV,WV,HV],i_=[KV].concat(Ep),QV=[yp("predicate",lt),r_("scope","node",["node","editor"]),r_("position","selection",["node","selection","line"])],JV=Ep.concat([Fi("contextformbutton"),a_,Cp,e_("original",Kt)]),eq=i_.concat([Fi("contextformbutton"),a_,Cp,e_("original",Kt)]),tq=Ep.concat([Fi("contextformbutton")]),nq=i_.concat([Fi("contextformtogglebutton")]),sq=Jw("type",{contextformbutton:JV,contextformtogglebutton:eq});gp([Fi("contextform"),yp("initValue",Y("")),jV,IV("commands",sq),bp("launch",Jw("type",{contextformbutton:tq,contextformtogglebutton:nq}))].concat(QV));const oq=e=>{const t=e.ui.registry.getAll().popups,n=rl(t,a=>ZV(a).fold(i=>{throw new Error(DV(i))},Kt)),s=Ag($u(n,a=>a.trigger)),o=Mu(n);return{dataset:n,triggers:s,lookupByTrigger:a=>ve(o,i=>i.trigger===a)}},rq=(e,t)=>{const n=Rf(t.load,50);e.on("keypress compositionend",s=>{s.which!==27&&n.throttle()}),e.on("keydown",s=>{const o=s.which;o===8?n.throttle():o===27&&t.cancelIfNecessary()}),e.on("remove",n.cancel)},aq=e=>{const t=go(),n=Rt(!1),s=t.isSet,o=()=>{s()&&(WU(e),JP(e),n.set(!1),t.clear())},r=c=>{s()||(HU(e,c.range),t.set({trigger:c.trigger,matchLength:c.text.length}))},a=Fo(()=>oq(e)),i=c=>t.get().map(f=>Uw(e.dom,e.selection.getRng(),f.trigger).bind(u=>Ww(e,a,u,c))).getOrThunk(()=>J3(e,a)),l=c=>{i(c).fold(o,f=>{r(f.context),f.lookupData.then(u=>{t.get().map(d=>{const v=f.context;d.trigger===v.trigger&&(v.text.length-d.matchLength>=10?o():(t.set({...d,matchLength:v.text.length}),n.get()?QP(e,{lookupData:u}):(n.set(!0),ZP(e,{lookupData:u}))))})})})};e.addCommand("mceAutocompleterReload",(c,f)=>{const u=Qe(f)?f.fetchOptions:{};l(u)}),e.addCommand("mceAutocompleterClose",o),rq(e,{cancelIfNecessary:o,load:l})},l_=e=>(t,n,s={})=>{const o=t.getBody(),r={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:o,currentTarget:o,eventPhase:Event.AT_TARGET,originalTarget:o,explicitOriginalTarget:o,isTrusted:!1,srcElement:o,cancelable:!1,preventDefault:Ee,inputType:n},a=mb(new InputEvent(e));return t.dispatch(e,{...a,...r,...s})},Hc=l_("input"),Wc=l_("beforeinput"),iq=(e,t,n)=>{const s=n.keyCode===te.BACKSPACE?"deleteContentBackward":"deleteContentForward";yw([{keyCode:te.BACKSPACE,action:ye(sw,e)},{keyCode:te.BACKSPACE,action:ye(jm,e,!1)},{keyCode:te.DELETE,action:ye(jm,e,!0)},{keyCode:te.BACKSPACE,action:ye(Wm,e,!1)},{keyCode:te.DELETE,action:ye(Wm,e,!0)},{keyCode:te.BACKSPACE,action:ye(tp,e,t,!1)},{keyCode:te.DELETE,action:ye(tp,e,t,!0)},{keyCode:te.BACKSPACE,action:ye(Zd,e,!1)},{keyCode:te.DELETE,action:ye(Zd,e,!0)},{keyCode:te.BACKSPACE,action:ye(Km,e,!1)},{keyCode:te.DELETE,action:ye(Km,e,!0)},{keyCode:te.BACKSPACE,action:ye(op,e,!1)},{keyCode:te.DELETE,action:ye(op,e,!0)},{keyCode:te.BACKSPACE,action:ye(zm,e,!1)},{keyCode:te.DELETE,action:ye(zm,e,!0)},{keyCode:te.BACKSPACE,action:ye(Um,e,!1)},{keyCode:te.DELETE,action:ye(Um,e,!0)},{keyCode:te.BACKSPACE,action:ye(np,e,!1)},{keyCode:te.DELETE,action:ye(np,e,!0)}],n).filter(o=>e.selection.isEditable()).each(o=>{n.preventDefault(),Wc(e,s).isDefaultPrevented()||(o(),Hc(e,s))})},lq=(e,t,n)=>{const s=Es(),o=s.os,r=s.browser,a=o.isMacOS()?[{keyCode:te.BACKSPACE,altKey:!0,action:ye(Pi,e)},{keyCode:te.DELETE,altKey:!0,action:ye(Pi,e)}]:[{keyCode:te.BACKSPACE,ctrlKey:!0,action:ye(Pi,e)},{keyCode:te.DELETE,ctrlKey:!0,action:ye(Pi,e)}];o.isMacOS()&&n&&a.push({keyCode:r.isFirefox()?224:91,action:ye(Pi,e)}),Oi([{keyCode:te.BACKSPACE,action:ye(p0,e)},{keyCode:te.DELETE,action:ye(p0,e)},...a],t)},cq=(e,t)=>{let n=!1;e.on("keydown",s=>{n=s.keyCode===te.BACKSPACE,s.isDefaultPrevented()||iq(e,t,s)}),e.on("keyup",s=>{s.isDefaultPrevented()||lq(e,s,n),n=!1})},uq=e=>{for(;e;){if(Q(e)||z(e)&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}return null},la=(e,t)=>{const n=e.dom,s=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){const r=uq(t.firstChild);r&&/^(UL|OL|DL)$/.test(r.nodeName)&&t.insertBefore(n.doc.createTextNode(Dt),t.firstChild)}const o=n.createRng();if(t.normalize(),t.hasChildNodes()){const r=new xt(t,t);let a=t,i;for(;i=r.current();){if(z(i)){o.setStart(i,0),o.setEnd(i,0);break}if(s[i.nodeName.toLowerCase()]){o.setStartBefore(i),o.setEndBefore(i);break}a=i,i=r.next()}i||(o.setStart(a,0),o.setEnd(a,0))}else dt(t)?t.nextSibling&&n.isBlock(t.nextSibling)?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)):(o.setStart(t,0),o.setEnd(t,0));e.selection.setRng(o),hi(e,o)},Vc=(e,t)=>{const n=e.getRoot();let s,o=t;for(;o!==n&&o&&e.getContentEditable(o)!=="false";)e.getContentEditable(o)==="true"&&(s=o),o=o.parentNode;return o!==n?s:n},Sp=e=>m.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),fq=e=>Sp(e).fold(Y(""),t=>t.nodeName.toUpperCase()),dq=e=>Sp(e).filter(t=>za(S.fromDom(t))).isSome(),mq=(e,t)=>e.dom.getParent(t,zh),pq=(e,t,n)=>{let s=t;for(;s&&s!==e&&Et(s.nextSibling);){const o=s.parentElement;if(!o||!n(o))return zh(o);s=o}return!1},gq=(e,t,n)=>!t&&n.nodeName.toLowerCase()===cn(e)&&e.dom.isEmpty(n)&&pq(e.getBody(),n,s=>Se(e.schema.getTextBlockElements(),s.nodeName.toLowerCase())),hq=(e,t,n)=>{var s,o,r;const a=t(cn(e)),i=mq(e,n);i&&(e.dom.insertAfter(a,i),la(e,a),((r=(o=(s=n.parentElement)===null||s===void 0?void 0:s.childNodes)===null||o===void 0?void 0:o.length)!==null&&r!==void 0?r:0)>1&&e.dom.remove(n))},bq=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,vq=e=>{var t;return((t=e.parentNode)===null||t===void 0?void 0:t.firstChild)===e},c_=(e,t)=>{const n=e==null?void 0:e.parentNode;return G(n)&&n.nodeName===t},u_=e=>G(e)&&/^(OL|UL|LI)$/.test(e.nodeName),yq=e=>G(e)&&/^(LI|DT|DD)$/.test(e.nodeName),Cq=e=>u_(e)&&u_(e.parentNode),qc=e=>{const t=e.parentNode;return yq(t)?t:e},jc=(e,t,n)=>{let s=e[n?"firstChild":"lastChild"];for(;s&&!Q(s);)s=s[n?"nextSibling":"previousSibling"];return s===t},Eq=(e,t,n,s,o)=>{const r=e.dom,a=e.selection.getRng(),i=n.parentNode;if(n===e.getBody()||!i)return;Cq(n)&&(o="LI");let l=t(o);if(jc(n,s,!0)&&jc(n,s,!1))if(c_(n,"LI")){const c=qc(n);r.insertAfter(l,c),vq(n)?r.remove(c):r.remove(n)}else r.replace(l,n);else if(jc(n,s,!0))c_(n,"LI")?(r.insertAfter(l,qc(n)),l.appendChild(r.doc.createTextNode(" ")),l.appendChild(n)):i.insertBefore(l,n),r.remove(s);else if(jc(n,s,!1))r.insertAfter(l,qc(n)),r.remove(s);else{n=qc(n);const c=a.cloneRange();c.setStartAfter(s),c.setEndAfter(n);const f=c.extractContents();o==="LI"&&bq(f,"LI")?(l=f.firstChild,r.insertAfter(f,n)):(r.insertAfter(f,n),r.insertAfter(l,n)),r.remove(s)}la(e,l)},Sq=e=>{M(Fh(S.fromDom(e),Rn),t=>{const n=t.dom;n.nodeValue=Gs(n.data)})},wq=(e,t)=>{const n=e.dom.getParent(t,"ol,ul,dl");return n!==null&&e.dom.getContentEditableParent(n)==="false"},_q=(e,t)=>t&&t.nodeName==="A"&&e.isEmpty(t),wp=e=>{e.innerHTML='<br data-mce-bogus="1">'},_p=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,xp=(e,t)=>G(t)&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.isEditable(t.parentNode)&&e.getContentEditable(t)!=="false",xq=(e,t,n)=>{var s;const o=[];if(!n)return;let r=n;for(;r=r.firstChild;){if(e.isBlock(r))return;Q(r)&&!t[r.nodeName.toLowerCase()]&&o.push(r)}let a=o.length;for(;a--;)r=o[a],(!r.hasChildNodes()||r.firstChild===r.lastChild&&((s=r.firstChild)===null||s===void 0?void 0:s.nodeValue)===""||_q(e,r))&&e.remove(r)},kp=(e,t,n)=>z(t)?e?n===1&&t.data.charAt(n-1)===Wt?0:n:n===t.data.length-1&&t.data.charAt(n)===Wt?t.data.length:n:n,kq=e=>{const t=e.cloneRange();return t.setStart(e.startContainer,kp(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,kp(!1,e.endContainer,e.endOffset)),t},Nq=e=>{let t=e;do z(t)&&(t.data=t.data.replace(/^[\r\n]+/,"")),t=t.firstChild;while(t)},Aq=(e,t,n)=>{const s=e.dom;m.from(n.style).map(s.parseStyle).each(l=>{const f={...Nh(S.fromDom(t)),...l};s.setStyles(t,f)});const o=m.from(n.class).map(l=>l.split(/\s+/)),r=m.from(t.className).map(l=>ve(l.split(/\s+/),c=>c!==""));an(o,r,(l,c)=>{const f=ve(c,d=>!Ve(l,d)),u=[...l,...f];s.setAttrib(t,"class",u.join(" "))});const a=["style","class"],i=Na(n,(l,c)=>!Ve(a,c));s.setAttribs(t,i)},Li=(e,t)=>{if(cn(e).toLowerCase()===t.tagName.toLowerCase()){const s=ni(e);Aq(e,t,s)}},Tq=(e,t,n,s,o)=>{var r,a;const i=e.dom,l=(r=Vc(i,s))!==null&&r!==void 0?r:i.getRoot();let c=i.getParent(s,i.isBlock);if(!c||!xp(i,c)){if(c=c||l,!c.hasChildNodes()){const v=i.create(t);return Li(e,v),c.appendChild(v),n.setStart(v,0),n.setEnd(v,0),v}let f=s;for(;f&&f.parentNode!==c;)f=f.parentNode;let u;for(;f&&!i.isBlock(f);)u=f,f=f.previousSibling;const d=(a=u==null?void 0:u.parentElement)===null||a===void 0?void 0:a.nodeName;if(u&&d&&e.schema.isValidChild(d,t.toLowerCase())){const v=u.parentNode,E=i.create(t);for(Li(e,E),v.insertBefore(E,u),f=u;f&&!i.isBlock(f);){const h=f.nextSibling;E.appendChild(f),f=h}n.setStart(s,o),n.setEnd(s,o)}}return s},Dq=(e,t)=>{t.normalize();const n=t.lastChild;(!n||Q(n)&&/^(left|right)$/gi.test(e.getStyle(n,"float",!0)))&&e.add(t,"br")},Rq=(e,t)=>{const n=iR(e);return rt(t)?!1:ce(n)?Ve(V.explode(n),t.nodeName.toLowerCase()):n},f_={insert:(e,t)=>{let n,s,o,r,a=!1;const i=e.dom,l=e.schema,c=l.getNonEmptyElements(),f=e.selection.getRng(),u=cn(e),d=f.collapsed&&f.startContainer===e.dom.getRoot(),v=S.fromDom(f.startContainer),E=Or(v,f.startOffset),h=E.exists(K=>Ku(K)&&!Ir(K)),C=d&&h,w=K=>{let ee=n;const ge=l.getTextInlineElements();let me;K||o==="TABLE"||o==="HR"?me=i.create(K||u):me=F.cloneNode(!1);let Ne=me;if(aR(e)===!1)i.setAttrib(me,"style",null),i.setAttrib(me,"class",null);else do if(ge[ee.nodeName]){if(Jn(ee)||Fn(ee))continue;const Ie=ee.cloneNode(!1);i.setAttrib(Ie,"id",""),me.hasChildNodes()?(Ie.appendChild(me.firstChild),me.appendChild(Ie)):(Ne=Ie,me.appendChild(Ie))}while((ee=ee.parentNode)&&ee!==oe);return Li(e,me),wp(Ne),me},_=K=>{const ee=kp(K,n,s);if(z(n)&&(K?ee>0:ee<n.data.length))return!1;if(n.parentNode===F&&a&&!K||K&&Q(n)&&n===F.firstChild)return!0;if(_p(n,"TABLE")||_p(n,"HR"))return a&&!K||!a&&K;const ge=new xt(n,F);z(n)&&(K&&ee===0?ge.prev():!K&&ee===n.data.length&&ge.next());let me;for(;me=ge.current();){if(Q(me)){if(!me.getAttribute("data-mce-bogus")){const Ne=me.nodeName.toLowerCase();if(c[Ne]&&Ne!=="br")return!1}}else if(z(me)&&!qo(me.data))return!1;K?ge.prev():ge.next()}return!0},x=()=>{let K;return/^(H[1-6]|PRE|FIGURE)$/.test(o)&&D!=="HGROUP"?K=w(u):K=w(),Rq(e,r)&&xp(i,r)&&i.isEmpty(F,void 0,{includeZwsp:!0})?K=i.split(r,F):i.insertAfter(K,F),la(e,K),K};ec(i,f).each(K=>{f.setStart(K.startContainer,K.startOffset),f.setEnd(K.endContainer,K.endOffset)}),n=f.startContainer,s=f.startOffset;const N=!!(t&&t.shiftKey),I=!!(t&&t.ctrlKey);Q(n)&&n.hasChildNodes()&&!C&&(a=s>n.childNodes.length-1,n=n.childNodes[Math.min(s,n.childNodes.length-1)]||n,a&&z(n)?s=n.data.length:s=0);const oe=Vc(i,n);if(!oe||wq(e,n))return;N||(n=Tq(e,u,f,n,s));let F=i.getParent(n,i.isBlock)||i.getRoot();r=G(F==null?void 0:F.parentNode)?i.getParent(F.parentNode,i.isBlock):null,o=F?F.nodeName.toUpperCase():"";const D=r?r.nodeName.toUpperCase():"";if(D==="LI"&&!I){const K=r;F=K,r=K.parentNode,o=D}if(Q(r)&&gq(e,N,F))return hq(e,w,F);if(/^(LI|DT|DD)$/.test(o)&&Q(r)&&i.isEmpty(F)){Eq(e,w,r,F,u);return}if(!C&&(F===e.getBody()||!xp(i,F)))return;const O=F.parentNode;let q;if(C)q=w(u),E.fold(()=>{bt(v,S.fromDom(q))},K=>{_n(K,S.fromDom(q))}),e.selection.setCursorLocation(q,0);else if(Ur(F))q=pf(F),i.isEmpty(F)&&wp(F),Li(e,q),la(e,q);else if(_(!1))q=x();else if(_(!0)&&O){q=O.insertBefore(w(),F);const K=KN(S.fromDom(f.startContainer))&&f.collapsed;la(e,_p(F,"HR")||K?q:F)}else{const K=kq(f).cloneRange();K.setEndAfter(F);const ee=K.extractContents();Sq(ee),Nq(ee),q=ee.firstChild,i.insertAfter(ee,F),xq(i,c,q),Dq(i,F),i.isEmpty(F)&&wp(F),q.normalize(),i.isEmpty(q)?(i.remove(q),x()):(Li(e,q),la(e,q))}i.setAttrib(q,"id",""),e.dispatch("NewBlock",{newBlock:q})},fakeEventName:"insertParagraph"},Pq=(e,t,n)=>{const s=new xt(t,n);let o;const r=e.getNonEmptyElements();for(;o=s.next();)if(r[o.nodeName.toLowerCase()]||z(o)&&o.length>0)return!0;return!1},d_=(e,t,n)=>{const s=e.dom.createRng();n?(s.setStartBefore(t),s.setEndBefore(t)):(s.setStartAfter(t),s.setEndAfter(t)),e.selection.setRng(s),hi(e,s)},Oq=(e,t)=>{const n=e.selection,s=e.dom,o=n.getRng();let r,a=!1;ec(s,o).each(v=>{o.setStart(v.startContainer,v.startOffset),o.setEnd(v.endContainer,v.endOffset)});let i=o.startOffset,l=o.startContainer;if(Q(l)&&l.hasChildNodes()){const v=i>l.childNodes.length-1;l=l.childNodes[Math.min(i,l.childNodes.length-1)]||l,v&&z(l)?i=l.data.length:i=0}let c=s.getParent(l,s.isBlock);const f=c&&c.parentNode?s.getParent(c.parentNode,s.isBlock):null,u=f?f.nodeName.toUpperCase():"",d=!!(t&&t.ctrlKey);u==="LI"&&!d&&(c=f),z(l)&&i>=l.data.length&&(Pq(e.schema,l,c||s.getRoot())||(r=s.create("br"),o.insertNode(r),o.setStartAfter(r),o.setEndAfter(r),a=!0)),r=s.create("br"),Ff(s,o,r),d_(e,r,a),e.undoManager.add()},Bq=(e,t)=>{const n=S.fromTag("br");_n(S.fromDom(t),n),e.undoManager.add()},Iq=(e,t)=>{Lq(e.getBody(),t)||io(S.fromDom(t),S.fromTag("br"));const n=S.fromTag("br");io(S.fromDom(t),n),d_(e,n.dom,!1),e.undoManager.add()},Fq=e=>dt(e.getNode()),Lq=(e,t)=>Fq(P.after(t))?!0:Qt(e,P.after(t)).map(n=>dt(n.getNode())).getOr(!1),m_=e=>e&&e.nodeName==="A"&&"href"in e,$q=e=>e.fold(lt,m_,m_,lt),Mq=e=>{const t=ne(cr,e),n=P.fromRangeStart(e.selection.getRng());return Bs(t,e.getBody(),n).filter($q)},Uq=(e,t)=>{t.fold(Ee,ne(Bq,e),ne(Iq,e),Ee)},p_={insert:(e,t)=>{const n=Mq(e);n.isSome()?n.each(ne(Uq,e)):Oq(e,t)},fakeEventName:"insertLineBreak"},g_=(e,t)=>Sp(e).filter(n=>t.length>0&&ss(S.fromDom(n),t)).isSome(),zq=e=>g_(e,oR(e)),Hq=e=>g_(e,rR(e)),kn=ks.generate([{br:[]},{block:[]},{none:[]}]),Wq=(e,t)=>Hq(e),h_=e=>(t,n)=>dq(t)===e,b_=(e,t)=>(n,s)=>fq(n)===e.toUpperCase()===t,Vq=e=>{const t=Vc(e.dom,e.selection.getStart());return rt(t)},$i=e=>b_("pre",e),qq=()=>b_("summary",!0),Kc=e=>(t,n)=>nR(t)===e,jq=(e,t)=>zq(e),Gc=(e,t)=>t,Kq=e=>{const t=cn(e),n=Vc(e.dom,e.selection.getStart());return G(n)&&e.schema.isValidChild(n.nodeName,t)},Gq=e=>{const t=e.selection.getRng(),n=t.collapsed&&t.startContainer===e.dom.getRoot(),s=S.fromDom(t.startContainer),r=Or(s,t.startOffset).map(a=>Ku(a)&&!Ir(a));return n&&r.getOr(!0)},zn=(e,t)=>(n,s)=>Sn(e,(r,a)=>r&&a(n,s),!0)?m.some(t):m.none(),Yq=(e,t)=>C0([zn([Wq],kn.none()),zn([$i(!0),Vq],kn.none()),zn([qq()],kn.br()),zn([$i(!0),Kc(!1),Gc],kn.br()),zn([$i(!0),Kc(!1)],kn.block()),zn([$i(!0),Kc(!0),Gc],kn.block()),zn([$i(!0),Kc(!0)],kn.br()),zn([h_(!0),Gc],kn.br()),zn([h_(!0)],kn.block()),zn([jq],kn.br()),zn([Gc],kn.br()),zn([Kq],kn.block()),zn([Gq],kn.block())],[e,!!(t&&t.shiftKey)]).getOr(kn.none()),Yc=(e,t,n)=>{t.selection.isCollapsed()||VI(t),!(G(n)&&Wc(t,e.fakeEventName).isDefaultPrevented())&&(e.insert(t,n),G(n)&&Hc(t,e.fakeEventName))},v_=(e,t)=>{const n=()=>Yc(p_,e,t),s=()=>Yc(f_,e,t),o=Yq(e,t);switch(sR(e)){case"linebreak":o.fold(n,n,Ee);break;case"block":o.fold(s,s,Ee);break;case"invert":o.fold(s,n,Ee);break;default:o.fold(n,s,Ee);break}},y_=Es(),Xq=y_.os.isiOS()&&y_.browser.isSafari(),C_=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),eU(e.undoManager),e.undoManager.transact(()=>{v_(e,t)}))},Zq=e=>{if(!e.collapsed)return!1;const t=e.startContainer;if(z(t)){const n=/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/,s=t.data.charAt(e.startOffset-1);return n.test(s)}else return!1},Qq=e=>{let t=m.none();const n=o=>{t=m.some(o.selection.getBookmark()),o.undoManager.add()},s=(o,r)=>{o.undoManager.undo(),t.fold(Ee,a=>o.selection.moveToBookmark(a)),C_(o,r),t=m.none()};e.on("keydown",o=>{o.keyCode===te.ENTER&&(Xq&&Zq(e.selection.getRng())?n(e):C_(e,o))}),e.on("keyup",o=>{o.keyCode===te.ENTER&&t.each(()=>s(e,o))})},Jq=(e,t,n)=>{const s=Fe.os.isMacOS()||Fe.os.isiOS();Oi([{keyCode:te.END,action:ye(gw,e,!0)},{keyCode:te.HOME,action:ye(gw,e,!1)},...s?[]:[{keyCode:te.HOME,action:ye(Bc,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:te.END,action:ye(Bc,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:te.END,action:ye(Sw,e,!0)},{keyCode:te.HOME,action:ye(Sw,e,!1)},{keyCode:te.END,action:ye(Oc,e,!0,t)},{keyCode:te.HOME,action:ye(Oc,e,!1,t)}],n).each(o=>{n.preventDefault()})},ej=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||Jq(e,t,n)})},tj=e=>{e.on("input",t=>{t.isComposing||wI(e)})},nj=Es(),sj=(e,t,n)=>{Oi([{keyCode:te.PAGE_UP,action:ye(Oc,e,!1,t)},{keyCode:te.PAGE_DOWN,action:ye(Oc,e,!0,t)}],n)},E_=e=>e.stopImmediatePropagation(),S_=e=>e.keyCode===te.PAGE_UP||e.keyCode===te.PAGE_DOWN,w_=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",E_,!0):!n&&e.get()&&t.off("NodeChange",E_),e.set(n)},oj=(e,t)=>{if(nj.os.isMacOS())return;const n=Rt(!1);e.on("keydown",s=>{S_(s)&&w_(n,e,!0)}),e.on("keyup",s=>{s.isDefaultPrevented()||sj(e,t,s),S_(s)&&n.get()&&(w_(n,e,!1),e.nodeChanged())})},__=(e,t)=>{const n=t.container(),s=t.offset();return z(n)?(n.insertData(s,e),m.some(P(n,s+e.length))):zl(t).map(o=>{const r=S.fromText(e);return t.isAtEnd()?io(o,r):_n(o,r),P(r.dom,e.length)})},x_=ne(__,Dt),k_=ne(__," "),rj=(e,t)=>_C(e,t)?x_(t):k_(t),aj=e=>t=>t.fold(n=>un(e.dom,P.before(n)),n=>Jt(n),n=>Qn(n),n=>Qt(e.dom,P.after(n))),ij=(e,t)=>n=>_C(e,n)?x_(t):k_(t),N_=e=>t=>{e.selection.setRng(t.toRange()),e.nodeChanged()},lj=(e,t)=>e.isEditable(e.getParent(t,"summary")),cj=e=>{const t=P.fromRangeStart(e.selection.getRng()),n=S.fromDom(e.getBody());if(e.selection.isCollapsed()){const s=ne(cr,e),o=P.fromRangeStart(e.selection.getRng());return Bs(s,e.getBody(),o).bind(aj(n)).map(r=>()=>ij(n,t)(r).each(N_(e)))}else return m.none()},uj=e=>{const t=()=>{const n=S.fromDom(e.getBody());e.selection.isCollapsed()||e.getDoc().execCommand("Delete");const s=P.fromRangeStart(e.selection.getRng());rj(n,s).each(N_(e))};return Dr(Fe.browser.isFirefox()&&e.selection.isEditable()&&lj(e.dom,e.selection.getRng().startContainer),t)},fj=(e,t)=>{yw([{keyCode:te.SPACEBAR,action:ye(cj,e)},{keyCode:te.SPACEBAR,action:ye(uj,e)}],t).each(n=>{t.preventDefault(),Wc(e,"insertText",{data:" "}).isDefaultPrevented()||(n(),Hc(e,"insertText",{data:" "}))})},dj=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||fj(e,t)})},mj=e=>b1(e)?[{keyCode:te.TAB,action:ye(Fw,e,!0)},{keyCode:te.TAB,shiftKey:!0,action:ye(Fw,e,!1)}]:[],pj=(e,t)=>{Oi([...mj(e)],t).each(n=>{t.preventDefault()})},gj=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||pj(e,t)})},hj=e=>{if(e.addShortcut("Meta+P","","mcePrint"),aq(e),Os(e))return Rt(null);{const t=J2(e);return XW(e),H3(e,t),cq(e,t),Qq(e),dj(e),tj(e),gj(e),ej(e,t),oj(e,t),t}};class bj{constructor(t){this.lastPath=[],this.editor=t;let n;const s=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",o=>{const r=t.selection.getRng(),a={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};(o.type==="nodechange"||!vd(a,n))&&t.dispatch("SelectionChange"),n=a}),t.on("contextmenu",()=>{t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{const o=t.selection.getStart(!0);o&&Kl(t)&&!s.isSameElementPath(o)&&t.dom.isChildOf(o,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",o=>{!o.isDefaultPrevented()&&Kl(t)&&(t.selection.getNode().nodeName==="IMG"?$n.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t={}){const n=this.editor.selection;let s;if(this.editor.initialized&&n&&!FR(this.editor)&&!this.editor.mode.isReadOnly()){const o=this.editor.getBody();s=n.getStart(!0)||o,(s.ownerDocument!==this.editor.getDoc()||!this.editor.dom.isChildOf(s,o))&&(s=o);const r=[];this.editor.dom.getParent(s,a=>a===o?!0:(r.push(a),!1)),this.editor.dispatch("NodeChange",{...t,element:s,parents:r})}}isSameElementPath(t){let n;const s=this.editor,o=ka(s.dom.getParents(t,St,s.getBody()));if(o.length===this.lastPath.length){for(n=o.length;n>=0&&o[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=o,!0}return this.lastPath=o,!1}}const A_=Za("image"),vj=e=>{const t=e;return m.from(t[A_])},yj=(e,t)=>{const n=e;n[A_]=t},Np=Za("event"),Cj=e=>{const t=e;return m.from(t[Np])},Xc=e=>t=>{const n=t;n[Np]=e},Ej=(e,t)=>Xc(t)(e),T_=Xc(0),Sj=Xc(2),wj=Xc(1),_j=(e=>t=>{const n=t;return m.from(n[Np]).exists(s=>s===e)})(0),xj=()=>Object.freeze({length:0,item:e=>null}),Ap=Za("mode"),kj=e=>{const t=e;return m.from(t[Ap])},Zc=e=>t=>{const n=t;n[Ap]=e},D_=(e,t)=>Zc(t)(e),R_=Zc(0),Tp=Zc(2),Nj=Zc(1),P_=e=>t=>{const n=t;return m.from(n[Ap]).exists(s=>s===e)},ca=P_(0),O_=P_(1),Aj=(e,t)=>({...t,get length(){return t.length},add:(n,s)=>{if(ca(e))if(ce(n)){if(!Ye(s))return t.add(n,s)}else return t.add(n);return null},remove:n=>{ca(e)&&t.remove(n)},clear:()=>{ca(e)&&t.clear()}}),Tj=["none","copy","link","move"],Dj=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],Dp=()=>{const e=new window.DataTransfer;let t="move",n="all";const s={get dropEffect(){return t},set dropEffect(o){Ve(Tj,o)&&(t=o)},get effectAllowed(){return n},set effectAllowed(o){_j(s)&&Ve(Dj,o)&&(n=o)},get items(){return Aj(s,e.items)},get files(){return O_(s)?xj():e.files},get types(){return e.types},setDragImage:(o,r,a)=>{ca(s)&&(yj(s,{image:o,x:r,y:a}),e.setDragImage(o,r,a))},getData:o=>O_(s)?"":e.getData(o),setData:(o,r)=>{ca(s)&&e.setData(o,r)},clearData:o=>{ca(s)&&e.clearData(o)}};return R_(s),s},Rj=e=>{const t=Dp(),n=kj(e);return Tp(e),T_(t),t.dropEffect=e.dropEffect,t.effectAllowed=e.effectAllowed,vj(e).each(s=>t.setDragImage(s.image,s.x,s.y)),M(e.types,s=>{s!=="Files"&&t.setData(s,e.getData(s))}),M(e.files,s=>t.items.add(s)),Cj(e).each(s=>{Ej(t,s)}),n.each(s=>{D_(e,s),D_(t,s)}),t},Pj=e=>{const t=e.getData("text/html");return t===""?m.none():m.some(t)},B_=(e,t)=>e.setData("text/html",t),I_="x-tinymce/html",Qc=Y(I_),Rp="<!-- "+I_+" -->",Oj=e=>Rp+e,Bj=e=>e.replace(Rp,""),F_=e=>e.indexOf(Rp)!==-1,Ij=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),Fj=(e,t)=>{let n="<"+e;const s=$u(t,(o,r)=>r+'="'+mo.encodeAllRaw(o)+'"');return s.length&&(n+=" "+s.join(" ")),n+">"},Lj=(e,t,n)=>{const s=e.split(/\n\n/),o=Fj(t,n),r="</"+t+">",a=Ue(s,l=>l.split(/\n/).join("<br />")),i=l=>o+l+r;return a.length===1?a[0]:Ue(a,i).join("")},L_="%MCEPASTEBIN%",$j=(e,t)=>{const{dom:n,selection:s}=e,o=e.getBody();t.set(s.getRng());const r=n.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},L_);Fe.browser.isFirefox()&&n.setStyle(r,"left",n.getStyle(o,"direction",!0)==="rtl"?65535:-65535),n.bind(r,"beforedeactivate focusin focusout",a=>{a.stopPropagation()}),r.focus(),s.select(r,!0)},Mj=(e,t)=>{const n=e.dom;if(Pp(e)){let s;const o=t.get();for(;s=Pp(e);)n.remove(s),n.unbind(s);o&&e.selection.setRng(o)}t.set(null)},Pp=e=>e.dom.get("mcepastebin"),Uj=e=>G(e)&&e.id==="mcepastebin",zj=e=>{const t=e.dom,n=(a,i)=>{a.appendChild(i),t.remove(i,!0)},[s,...o]=ve(e.getBody().childNodes,Uj);M(o,a=>{n(s,a)});const r=t.select("div[id=mcepastebin]",s);for(let a=r.length-1;a>=0;a--){const i=t.create("div");s.insertBefore(i,r[a]),n(i,r[a])}return s?s.innerHTML:""},$_=e=>e===L_,Hj=e=>{const t=Rt(null);return{create:()=>$j(e,t),remove:()=>Mj(e,t),getEl:()=>Pp(e),getHtml:()=>zj(e),getLastRng:t.get}},M_=(e,t)=>(V.each(t,n=>{Bt(n,RegExp)?e=e.replace(n,""):e=e.replace(n[0],n[1])}),e),Wj=e=>{const t=po(),n=na({},t);let s="";const o=t.getVoidElements(),r=V.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),i=l=>{const c=l.name,f=l;if(c==="br"){s+=`
`;return}if(c!=="wbr"){if(o[c]&&(s+=" "),r[c]){s+=" ";return}if(l.type===3&&(s+=l.value),!(l.name in t.getVoidElements())){let u=l.firstChild;if(u)do i(u);while(u=u.next)}a[c]&&f.next&&(s+=`
`,c==="p"&&(s+=`
`))}};return e=M_(e,[/<!\[[^\]]+\]>/g]),i(n.parse(e)),s},U_=e=>(e=M_(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(n,s,o)=>!s&&!o?" ":Dt],/<br class="Apple-interchange-newline">/g,/<br>$/i]),e),Vj=e=>{let t=0;return()=>e+t++},qj=e=>{const t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return V.hasOwn(n,t)?"image/"+n[t]:"image/"+t},jj=(e,t)=>{const n=na({sanitize:qf(e)},e.schema);n.addNodeFilter("meta",o=>{V.each(o,r=>{r.remove()})});const s=n.parse(t,{forced_root_block:!1,isRootContent:!0});return Co({validate:!0},e.schema).serialize(s)},z_=(e,t)=>({content:e,cancelled:t}),Kj=(e,t,n)=>{const s=e.dom.create("div",{style:"display:none"},t),o=tO(e,s,n);return z_(o.node.innerHTML,o.isDefaultPrevented())},Gj=(e,t,n)=>{const s=eO(e,t,n),o=jj(e,s.content);return e.hasEventListeners("PastePostProcess")&&!s.isDefaultPrevented()?Kj(e,o,n):z_(o,s.isDefaultPrevented())},Yj=(e,t,n)=>Gj(e,t,n),Op=(e,t)=>(e.insertContent(t,{merge:t1(e),paste:!0}),!0),Bp=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),Xj=(e,t)=>Bp(t)&&ht(yv(e),n=>Wu(t.toLowerCase(),`.${n.toLowerCase()}`)),Zj=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.insertContent('<img src="'+t+'">')}),!0),Qj=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.execCommand("mceInsertLink",!1,t)}),!0),Jj=(e,t,n)=>!e.selection.isCollapsed()&&Bp(t)?Qj(e,t,n):!1,e8=(e,t,n)=>Xj(e,t)?Zj(e,t,n):!1,t8=(e,t)=>{V.each([Jj,e8,Op],n=>!n(e,t,Op))},n8=(e,t,n)=>{n||!n1(e)?Op(e,t):t8(e,t)},s8=Vj("mceclip"),o8=e=>{const t=Dp();return B_(t,e),Tp(t),t},H_=(e,t,n,s,o)=>{const r=Yj(e,t,n);if(!r.cancelled){const a=r.content,i=()=>n8(e,a,s);o?Wc(e,"insertFromPaste",{dataTransfer:o8(a)}).isDefaultPrevented()||(i(),Hc(e,"insertFromPaste")):i()}},Jc=(e,t,n,s)=>{const o=n||F_(t);H_(e,Bj(t),o,!1,s)},Ip=(e,t,n)=>{const s=e.dom.encode(t).replace(/\r\n/g,`
`),o=Xh(s,o1(e)),r=Lj(o,cn(e),ni(e));H_(e,r,!1,!0,n)},W_=e=>{const t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){const s=e.types[n];try{t[s]=e.getData(s)}catch{t[s]=""}}return t},ko=(e,t)=>t in e&&e[t].length>0,V_=e=>ko(e,"text/html")||ko(e,"text/plain"),r8=(e,t)=>{const n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return G(n)?e.dom.encode(n[1]):void 0},a8=(e,t,n,s)=>{const o=s8(),r=lv(e)&&G(n.name),a=r?r8(e,n.name):o,i=r?n.name:void 0,l=t.create(o,n,s,a,i);return t.add(l),l},i8=(e,t)=>{vm(t.uri).each(({data:n,type:s,base64Encoded:o})=>{const r=o?n:btoa(n),a=t.file,i=e.editorUpload.blobCache,l=i.getByData(r,s),c=l??a8(e,i,a,r);Jc(e,`<img src="${c.blobUri()}">`,!1,!0)})},l8=e=>e.type==="paste",c8=e=>Promise.all(Ue(e,t=>KE(t).then(n=>({file:t,uri:n})))),u8=e=>{const t=yv(e);return n=>Ut(n.type,"image/")&&ht(t,s=>qj(s)===n.type)},f8=(e,t)=>{const n=t.items?ys(rn(t.items),o=>o.kind==="file"?[o.getAsFile()]:[]):[],s=t.files?rn(t.files):[];return ve(n.length>0?n:s,u8(e))},q_=(e,t,n)=>{const s=l8(t)?t.clipboardData:t.dataTransfer;if(Ml(e)&&s){const o=f8(e,s);if(o.length>0)return t.preventDefault(),c8(o).then(r=>{n&&e.selection.setRng(n),M(r,a=>{i8(e,a)})}),!0}return!1},d8=e=>{var t,n;return Fe.os.isAndroid()&&((n=(t=e.clipboardData)===null||t===void 0?void 0:t.items)===null||n===void 0?void 0:n.length)===0},m8=e=>te.metaKeyPressed(e)&&e.keyCode===86||e.shiftKey&&e.keyCode===45,Fp=(e,t,n,s,o)=>{let r=U_(n);const a=ko(t,Qc())||F_(n),i=!a&&Ij(r),l=Bp(r);($_(r)||!r.length||i&&!l)&&(s=!0),(s||l)&&(ko(t,"text/plain")&&i?r=t["text/plain"]:r=Wj(r)),!$_(r)&&(s?Ip(e,r,o):Jc(e,r,a,o))},p8=(e,t,n)=>{let s;const o=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",r=>{m8(r)&&!r.isDefaultPrevented()&&(s=r.shiftKey&&r.keyCode===86)}),e.on("paste",r=>{if(r.isDefaultPrevented()||d8(r))return;const a=n.get()==="text"||s;s=!1;const i=W_(r.clipboardData);!V_(i)&&q_(e,r,o())||(ko(i,"text/html")?(r.preventDefault(),Fp(e,i,i["text/html"],a,!0)):ko(i,"text/plain")&&ko(i,"text/uri-list")?(r.preventDefault(),Fp(e,i,i["text/plain"],a,!0)):(t.create(),$n.setEditorTimeout(e,()=>{const l=t.getHtml();t.remove(),Fp(e,i,l,a,!1)},0)))})},g8=e=>{const t=o=>Ut(o,"webkit-fake-url"),n=o=>Ut(o,"data:"),s=o=>{var r;return((r=o.data)===null||r===void 0?void 0:r.paste)===!0};e.parser.addNodeFilter("img",(o,r,a)=>{if(!Ml(e)&&s(a))for(const i of o){const l=i.attr("src");ce(l)&&!i.attr("data-mce-object")&&l!==Fe.transparentSrc&&(t(l)||!r1(e)&&n(l))&&i.remove()}})},h8=(e,t,n)=>{p8(e,t,n),g8(e)},b8=(e,t)=>{t.get()==="text"?(t.set("html"),Cy(e,!1)):(t.set("text"),Cy(e,!0)),e.focus()},v8=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",()=>{b8(e,t)}),e.addCommand("mceInsertClipboardContent",(n,s)=>{s.html&&Jc(e,s.html,s.internal,!1),s.text&&Ip(e,s.text,!1)})},y8=(e,t,n)=>{if(e)try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(Qc(),t),!0}catch{return!1}else return!1},j_=(e,t,n,s)=>{y8(e.clipboardData,t.html,t.text)?(e.preventDefault(),s()):n(t.html,s)},K_=e=>(t,n)=>{const{dom:s,selection:o}=e,r=s.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=s.create("div",{contenteditable:"true"},t);s.setStyles(r,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),r.appendChild(a),s.add(e.getBody(),r);const i=o.getRng();a.focus();const l=s.createRng();l.selectNodeContents(a),o.setRng(l),$n.setEditorTimeout(e,()=>{o.setRng(i),s.remove(r),n()},0)},G_=e=>({html:Oj(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),C8=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),Y_=e=>!e.selection.isCollapsed()||C8(e),E8=e=>t=>{!t.isDefaultPrevented()&&Y_(e)&&j_(t,G_(e),K_(e),()=>{if(Fe.browser.isChromium()||Fe.browser.isFirefox()){const n=e.selection.getRng();$n.setEditorTimeout(e,()=>{e.selection.setRng(n),e.execCommand("Delete")},0)}else e.execCommand("Delete")})},S8=e=>t=>{!t.isDefaultPrevented()&&Y_(e)&&j_(t,G_(e),K_(e),Ee)},w8=e=>{e.on("cut",E8(e)),e.on("copy",S8(e))},X_=(e,t)=>{var n,s;return ar.getCaretRangeFromPoint((n=t.clientX)!==null&&n!==void 0?n:0,(s=t.clientY)!==null&&s!==void 0?s:0,e.getDoc())},_8=e=>{const t=e["text/plain"];return t?t.indexOf("file://")===0:!1},Z_=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},x8=e=>ht(e.files,t=>/^image\//.test(t.type)),k8=(e,t,n,s)=>{const o=e.getParent(n,r=>jo(t,r));if(o&&Se(s,"text/html")){const r=new DOMParser().parseFromString(s["text/html"],"text/html").body;return!Et(r.querySelector(o.nodeName.toLowerCase()))}else return!1},N8=(e,t)=>{YR(e)&&e.on("dragend dragover draggesture dragdrop drop drag",n=>{n.preventDefault(),n.stopPropagation()}),Ml(e)||e.on("drop",n=>{const s=n.dataTransfer;s&&x8(s)&&n.preventDefault()}),e.on("drop",n=>{if(n.isDefaultPrevented())return;const s=X_(e,n);if(rt(s))return;const o=W_(n.dataTransfer),r=ko(o,Qc());if((!V_(o)||_8(o))&&q_(e,n,s))return;const a=o[Qc()],i=a||o["text/html"]||o["text/plain"],l=k8(e.dom,e.schema,s.startContainer,o);t.get()&&!l||i&&(n.preventDefault(),$n.setEditorTimeout(e,()=>{e.undoManager.transact(()=>{a&&e.execCommand("Delete"),Z_(e,s);const c=U_(i);o["text/html"]?Jc(e,c,r,!0):Ip(e,c,!0)})}))}),e.on("dragstart",n=>{t.set(!0)}),e.on("dragover dragend",n=>{Ml(e)&&!t.get()&&(n.preventDefault(),Z_(e,X_(e,n))),n.type==="dragend"&&t.set(!1)})},A8=e=>{const t=o=>r=>{o(e,r)},n=XR(e);Be(n)&&e.on("PastePreProcess",t(n));const s=ZR(e);Be(s)&&e.on("PastePostProcess",t(s))},T8=(e,t)=>{e.on("PastePreProcess",n=>{n.content=t(e,n.content,n.internal)})},D8=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,Q_=e=>V.trim(e).replace(D8,jl).toLowerCase(),R8=(e,t,n)=>{const s=JR(e);if(n||s==="all"||!e1(e))return t;const o=s?s.split(/[, ]/):[];if(o&&s!=="none"){const r=e.dom,a=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,c,f)=>{const u=r.parseStyle(r.decode(c)),d={};for(let E=0;E<o.length;E++){const h=u[o[E]];let C=h,w=r.getStyle(a,o[E],!0);/color/.test(o[E])&&(C=Q_(C),w=Q_(w)),w!==C&&(d[o[E]]=h)}const v=r.serializeStyle(d,"span");return v?l+' style="'+v+'"'+f:l+f})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(r,a,i,l)=>a+' style="'+i+'"'+l),t},P8=e=>{(Fe.browser.isChromium()||Fe.browser.isSafari())&&T8(e,R8)},O8=e=>{const t=Rt(!1),n=Rt(s1(e)?"text":"html"),s=Hj(e);P8(e),v8(e,n),A8(e),e.on("PreInit",()=>{w8(e),N8(e,t),h8(e,s,n)})},B8=e=>{e.on("click",t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()})},I8=e=>{e.parser.addNodeFilter("details",t=>{const n=v1(e);M(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})}),e.serializer.addNodeFilter("details",t=>{const n=y1(e);M(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})})},J_=e=>uo(S.fromDom(e)),ex=(e,t)=>{const n=t.getNode();Ye(n)||e.selection.setCursorLocation(n,t.offset())},tx=(e,t)=>{var n;return e.startOffset===0&&e.endOffset===((n=t.textContent)===null||n===void 0?void 0:n.length)},nx=Es(),F8=nx.browser,sx=nx.os,L8=F8.isSafari(),ox=sx.isMacOS()||sx.isiOS(),$8=(e,t)=>Jt(t).exists(n=>n.isEqual(e)),M8=(e,t)=>Qn(t).exists(n=>dt(n.getNode())&&un(t,n).exists(s=>s.isEqual(e))||n.isEqual(e)),U8=(e,t)=>{const n=m.from(e.getParent(t.startContainer,"details")),s=m.from(e.getParent(t.endContainer,"details"));if(n.isSome()||s.isSome()){const o=n.bind(r=>m.from(e.select("summary",r)[0]));return m.some({startSummary:o,startDetails:n,endDetails:s})}else return m.none()},z8=(e,t)=>{const n=l=>l.contains(e.startContainer),s=l=>l.contains(e.endContainer),o=t.startSummary.exists(n),r=t.startSummary.exists(s),a=t.startDetails.forall(l=>t.endDetails.forall(c=>l!==c));return(o||r)&&!(o&&r)||a},H8=(e,t)=>t.startSummary.exists(n=>$8(e,n)),W8=(e,t)=>t.startSummary.exists(n=>M8(e,n)),V8=(e,t)=>t.startDetails.exists(n=>un(n,e).forall(s=>t.startSummary.exists(o=>!o.contains(e.container())&&o.contains(s.container())))),q8=(e,t,n)=>n.startDetails.exists(s=>Qt(e,t).forall(o=>!s.contains(o.container()))),Lp=(e,t)=>G(e.getParent(t.container(),"details")),rx=(e,t)=>{const n=e.dom.getParent(t.container(),"details");if(n&&!n.open){const s=e.dom.select("summary",n)[0];s&&Qn(s).each(o=>ex(e,o))}else ex(e,t)},j8=(e,t)=>{const{dom:n,selection:s}=e,o=e.getBody();if(e.selection.isCollapsed()){const r=P.fromRangeStart(s.getRng()),a=n.getParent(r.container(),n.isBlock);if(a&&n.isEmpty(a)){if(Et(a.nextSibling)){const i=un(o,r).filter(l=>Lp(n,l));if(i.isSome())return i.each(l=>{t||rx(e,l)}),!0}else if(Et(a.previousSibling)&&Qt(o,r).filter(l=>Lp(n,l)))return!0}return ui(t,o,r).fold(lt,i=>Lp(n,i)?(a&&n.isEmpty(a)&&e.dom.remove(a),t||rx(e,i),!0):!1)}else return!1},K8=(e,t,n)=>{const s=e.selection,o=s.getNode(),r=s.getRng(),a=n.keyCode===te.BACKSPACE,i=n.keyCode===te.DELETE,l=e.selection.isCollapsed(),c=P.fromRangeStart(r),f=e.getBody();return!l&&z8(r,t)||l&&a&&H8(c,t)||l&&i&&W8(c,t)||l&&a&&V8(c,t)||l&&i&&q8(f,c,t)?!0:L8&&kA(o)?(!l&&tx(r,o)||LC(i,c,o)?J_(o):e.undoManager.transact(()=>{const u=s.getSel();let{anchorNode:d,anchorOffset:v,focusNode:E,focusOffset:h}=u??{};const C=()=>{G(d)&&G(v)&&G(E)&&G(h)&&(u==null||u.setBaseAndExtent(d,v,E,h))},w=()=>{d=u==null?void 0:u.anchorNode,v=u==null?void 0:u.anchorOffset,E=u==null?void 0:u.focusNode,h=u==null?void 0:u.focusOffset},_=(N,I)=>{M(N.childNodes,oe=>{di(oe)&&I.appendChild(oe)})},x=e.dom.create("span",{"data-mce-bogus":"all"});_(o,x),o.appendChild(x),C(),l&&(ox&&(n.altKey||a&&n.metaKey)||!ox&&n.ctrlKey)&&(u==null||u.modify("extend",a?"left":"right",n.metaKey?"line":"word")),!s.isCollapsed()&&tx(s.getRng(),x)?J_(o):(e.execCommand(a?"Delete":"ForwardDelete"),w(),_(x,o),C()),e.dom.remove(x)}),!0):!1},G8=e=>{e.on("keydown",t=>{(t.keyCode===te.BACKSPACE||t.keyCode===te.DELETE)&&U8(e.dom,e.selection.getRng()).fold(()=>{j8(e,t.keyCode===te.DELETE)&&t.preventDefault()},n=>{K8(e,n,t)&&t.preventDefault()})})},Y8=e=>{B8(e),I8(e),G8(e)},X8=dt,ax=z,Z8=e=>tt(e.dom),Q8=e=>rs(e.dom),ix=e=>t=>ze(S.fromDom(e),t),J8=(e,t)=>Mo(S.fromDom(e),n=>Q8(n)||On(n),ix(t)).getOr(S.fromDom(t)).dom,lx=(e,t)=>Mo(S.fromDom(e),Z8,ix(t)),cx=(e,t,n)=>{const s=new xt(e,t),o=n?s.next.bind(s):s.prev.bind(s);let r=e;for(let a=n?e:o();a&&!X8(a);a=o())Zn(a)&&(r=a);return r},e6=(e,t)=>{const s=P.fromRangeStart(e).getNode(),o=J8(s,t),r=cx(s,o,!1),a=cx(s,o,!0),i=document.createRange();return lx(r,o).fold(()=>{ax(r)?i.setStart(r,0):i.setStartBefore(r)},l=>i.setStartBefore(l.dom)),lx(a,o).fold(()=>{ax(a)?i.setEnd(a,a.data.length):i.setEndAfter(a)},l=>i.setEndAfter(l.dom)),i},t6=e=>{const t=e6(e.selection.getRng(),e.getBody());e.selection.setRng(nm(t))},n6=e=>{e.on("mousedown",t=>{t.detail>=3&&(t.preventDefault(),t6(e))})};var ua;(function(e){e.Before="before",e.After="after"})(ua||(ua={}));const s6=(e,t)=>Math.abs(e.left-t),o6=(e,t)=>Math.abs(e.right-t),r6=(e,t)=>e>=t.top&&e<=t.bottom,a6=(e,t)=>e.top<t.bottom&&e.bottom>t.top,i6=(e,t)=>{const n=bD(e,t)/Math.min(e.height,t.height);return a6(e,t)&&n>.5},l6=(e,t)=>{const n=ve(e,s=>r6(t,s));return hD(n).fold(()=>[[],e],s=>{const{pass:o,fail:r}=wa(e,a=>i6(a,s));return[o,r]})},c6=(e,t)=>({node:e.node,position:s6(e,t)<o6(e,t)?ua.Before:ua.After}),u6=(e,t,n)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),$p=(e,t,n)=>{const s=f=>Zn(f.node)?m.some(f):Q(f.node)?$p(rn(f.node.childNodes),t,n):m.none(),o=(f,u)=>{if(f.length>=2){const d=s(f[0]).getOr(f[0]),v=s(f[1]).getOr(f[1]);if(Math.abs(u(d,t,n)-u(v,t,n))<2){if(z(d.node))return m.some(d);if(z(v.node))return m.some(v)}}return m.none()},r=(f,u)=>{const d=Oo(f,(v,E)=>u(v,t,n)-u(E,t,n));return o(d,u).orThunk(()=>kr(d,s))},[a,i]=l6(O0(e),n),{pass:l,fail:c}=wa(i,f=>f.top<n);return r(a,u6).orThunk(()=>r(c,Rb)).orThunk(()=>r(l,Rb))},f6=(e,t,n,s)=>{const o=(r,a)=>{const i=c=>Q(c)&&c.classList.contains("mce-drag-container"),l=ve(r.dom.childNodes,xr(i));return a.fold(()=>$p(l,n,s),c=>{const f=ve(l,u=>u!==c.dom);return $p(f,n,s)}).orThunk(()=>(ze(r,e)?m.none():Zu(r)).bind(f=>o(f,m.some(r))))};return o(t,m.none())},d6=(e,t,n)=>{const s=S.fromDom(e),o=Vs(s),a=S.fromPoint(o,t,n).filter(i=>Ws(s,i)).getOr(s);return f6(s,a,t,n)},ux=(e,t,n)=>d6(e,t,n).filter(s=>ri(s.node)).map(s=>c6(s,t)),fx=e=>{var t,n;const s=e.getBoundingClientRect(),o=e.ownerDocument,r=o.documentElement,a=o.defaultView;return{top:s.top+((t=a==null?void 0:a.scrollY)!==null&&t!==void 0?t:0)-r.clientTop,left:s.left+((n=a==null?void 0:a.scrollX)!==null&&n!==void 0?n:0)-r.clientLeft}},m6=e=>e.inline?fx(e.getBody()):{left:0,top:0},p6=e=>{const t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},g6=e=>{const t=e.getBody(),n=e.getDoc().documentElement,s={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?s:o},h6=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){const n=fx(e.getContentAreaContainer()),s=g6(e);return{left:t.pageX-n.left+s.left,top:t.pageY-n.top+s.top}}return{left:t.pageX,top:t.pageY}},b6=(e,t,n)=>({pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}),v6=(e,t)=>b6(m6(e),p6(e),h6(e,t)),dx=e=>({target:e,srcElement:e}),y6=(e,t,n,s)=>({...t,dataTransfer:s,type:e,...dx(n)}),C6=(e,t,n)=>{const s=Sg("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:e,composedPath:s,initEvent:s,preventDefault:Ee,stopImmediatePropagation:Ee,stopPropagation:Ee,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:s,initMouseEvent:s,getModifierState:s,dataTransfer:n,...dx(t)}},E6=(e,t)=>{const n=Rj(e);return t==="dragstart"?(T_(n),R_(n)):t==="drop"?(Sj(n),Tp(n)):(wj(n),Nj(n)),n},S6=(e,t,n,s)=>{const o=E6(n,e);return Ye(s)?C6(e,t,o):y6(e,s,t,o)},eu=32,w6=100,tu=8,nu=16,mx=tt,_6=ED(mx,rs),x6=(e,t,n)=>mx(n)&&n!==t&&e.isEditable(n.parentElement),k6=(e,t,n)=>rt(t)||t===n||e.dom.isChildOf(t,n)?!1:e.dom.isEditable(t),N6=(e,t,n,s)=>{const o=e.dom,r=t.cloneNode(!0);o.setStyles(r,{width:n,height:s}),o.setAttrib(r,"data-mce-selected",null);const a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:s}),o.setStyles(r,{margin:0,boxSizing:"border-box"}),a.appendChild(r),a},A6=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},su=(e,t)=>n=>()=>{const s=e==="left"?n.scrollX:n.scrollY;n.scroll({[e]:s+t,behavior:"smooth"})},px=su("left",-eu),gx=su("left",eu),hx=su("top",-eu),bx=su("top",eu),T6=(e,t,n,s,o,r,a,i,l,c,f,u)=>{let d=0,v=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(d=t.pageX+n-o),t.pageY+s>r&&(v=t.pageY+s-r),e.style.width=n-d+"px",e.style.height=s-v+"px";const E=l.clientHeight,h=l.clientWidth,C=a+l.getBoundingClientRect().top,w=i+l.getBoundingClientRect().left;f.on(_=>{_.intervalId.clear(),_.dragging&&u&&(a+tu>=E?_.intervalId.set(bx(c)):a-tu<=0?_.intervalId.set(hx(c)):i+tu>=h?_.intervalId.set(gx(c)):i-tu<=0?_.intervalId.set(px(c)):C+nu>=window.innerHeight?_.intervalId.set(bx(window)):C-nu<=0?_.intervalId.set(hx(window)):w+nu>=window.innerWidth?_.intervalId.set(gx(window)):w-nu<=0&&_.intervalId.set(px(window)))})},vx=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},D6=(e,t)=>{const n=e.getParent(t.parentNode,e.isBlock);vx(t),n&&n!==e.getRoot()&&e.isEmpty(n)&&uo(S.fromDom(n))},R6=e=>e.button===0,P6=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),O6=(e,t)=>n=>{if(R6(n)){const s=_t(t.dom.getParents(n.target),_6).getOr(null);if(G(s)&&x6(t.dom,t.getBody(),s)){const o=t.dom.getPos(s),r=t.getBody(),a=t.getDoc().documentElement;e.set({element:s,dataTransfer:Dp(),dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?r.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?r.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:s.offsetWidth,height:s.offsetHeight,ghost:N6(t,s,s.offsetWidth,s.offsetHeight),intervalId:aD(w6)})}}},B6=(e,t,n)=>{e._selectionOverrides.hideFakeCaret(),ux(e.getBody(),t,n).fold(()=>e.selection.placeCaretAt(t,n),s=>{const o=e._selectionOverrides.showCaret(1,s.node,s.position===ua.Before,!1);o?e.selection.setRng(o):e.selection.placeCaretAt(t,n)})},Mi=(e,t,n,s,o)=>{t==="dragstart"&&B_(s,e.dom.getOuterHTML(n));const r=S6(t,n,s,o);return e.dispatch(t,r)},I6=(e,t)=>{const n=Ol((o,r)=>B6(t,o,r),0);t.on("remove",n.cancel);const s=e;return o=>e.on(r=>{const a=Math.max(Math.abs(o.screenX-r.screenX),Math.abs(o.screenY-r.screenY));if(!r.dragging&&a>10){const i=Mi(t,"dragstart",r.element,r.dataTransfer,o);if(G(i.dataTransfer)&&(r.dataTransfer=i.dataTransfer),i.isDefaultPrevented())return;r.dragging=!0,t.focus()}if(r.dragging){const i=o.currentTarget===t.getDoc().documentElement,l=P6(r,v6(t,o));A6(r.ghost,t.getBody()),T6(r.ghost,l,r.width,r.height,r.maxX,r.maxY,o.clientY,o.clientX,t.getContentAreaContainer(),t.getWin(),s,i),n.throttle(o.clientX,o.clientY)}})},F6=e=>{const t=e.getSel();if(G(t)){const s=t.getRangeAt(0).startContainer;return z(s)?s.parentNode:s}else return null},L6=(e,t)=>n=>{e.on(s=>{var o;if(s.intervalId.clear(),s.dragging){if(k6(t,F6(t.selection),s.element)){const r=(o=t.getDoc().elementFromPoint(n.clientX,n.clientY))!==null&&o!==void 0?o:t.getBody();Mi(t,"drop",r,s.dataTransfer,n).isDefaultPrevented()||t.undoManager.transact(()=>{D6(t.dom,s.element),Pj(s.dataTransfer).each(i=>t.insertContent(i)),t._selectionOverrides.hideFakeCaret()})}Mi(t,"dragend",t.getBody(),s.dataTransfer,n)}}),Cx(e)},yx=(e,t,n)=>{e.on(s=>{s.intervalId.clear(),s.dragging&&n.fold(()=>Mi(t,"dragend",s.element,s.dataTransfer),o=>Mi(t,"dragend",s.element,s.dataTransfer,o))}),Cx(e)},$6=(e,t)=>n=>yx(e,t,m.some(n)),Cx=e=>{e.on(t=>{t.intervalId.clear(),vx(t.ghost)}),e.clear()},M6=e=>{const t=go(),n=qe.DOM,s=document,o=O6(t,e),r=I6(t,e),a=L6(t,e),i=$6(t,e);e.on("mousedown",o),e.on("mousemove",r),e.on("mouseup",a),n.bind(s,"mousemove",r),n.bind(s,"mouseup",i),e.on("remove",()=>{n.unbind(s,"mousemove",r),n.unbind(s,"mouseup",i)}),e.on("keydown",l=>{l.keyCode===te.ESC&&yx(t,e,m.none())})},U6=e=>{const t=o=>{if(!o.isDefaultPrevented()){const r=o.dataTransfer;r&&(Ve(r.types,"Files")||r.files.length>0)&&(o.preventDefault(),o.type==="drop"&&xc(e,"Dropped file type is not supported"))}},n=o=>{sc(e,o.target)&&t(o)},s=()=>{const o=qe.DOM,r=e.dom,a=document,i=e.inline?e.getBody():e.getDoc(),l=["drop","dragover"];M(l,c=>{o.bind(a,c,n),r.bind(i,c,t)}),e.on("remove",()=>{M(l,c=>{o.unbind(a,c,n),r.unbind(i,c,t)})})};e.on("init",()=>{$n.setEditorTimeout(e,s,0)})},z6=e=>{M6(e),MR(e)&&U6(e)},H6=e=>{const t=Ol(()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){const n=e.selection.getRng();if(n.collapsed){const s=Hm(e,n,!1);e.selection.setRng(s)}}},0);e.on("focus",()=>{t.throttle()}),e.on("blur",()=>{t.cancel()})},W6=e=>{e.on("init",()=>{e.on("focusin",t=>{const n=t.target;if(xs(n)){const s=ur(e.getBody(),n),o=tt(s)?s:n;e.selection.getNode()!==o&&Ai(e,o).each(r=>e.selection.setRng(r))}})})},Ui=tt,Ex=(e,t)=>ur(e.getBody(),t),V6=e=>{const t=e.selection,n=e.dom,s=e.getBody(),o=R1(e,s,n.isBlock,()=>ir(e)),r="sel-"+n.uniqueId(),a="data-mce-selected";let i;const l=F=>G(F)&&n.hasClass(F,"mce-offscreen-selection"),c=F=>F!==s&&(Ui(F)||xs(F))&&n.isChildOf(F,s)&&n.isEditable(F.parentNode),f=F=>{F&&t.setRng(F)},u=(F,D,O,q=!0)=>e.dispatch("ShowCaret",{target:D,direction:F,before:O}).isDefaultPrevented()?null:(q&&t.scrollIntoView(D,F===-1),o.show(O,D)),d=F=>{F.hasAttribute("data-mce-caret")&&(pf(F),t.scrollIntoView(F))},v=()=>{e.on("click",D=>{n.isEditable(D.target)||(D.preventDefault(),e.focus())}),e.on("blur NewBlock",N),e.on("ResizeWindow FullscreenStateChanged",o.reposition),e.on("tap",D=>{const O=D.target,q=Ex(e,O);Ui(q)?(D.preventDefault(),Ai(e,q).each(x)):c(O)&&Ai(e,O).each(x)},!0),e.on("mousedown",D=>{const O=D.target;if(O!==s&&O.nodeName!=="HTML"&&!n.isChildOf(O,s)||!Uz(e,D.clientX,D.clientY))return;N(),oe();const q=Ex(e,O);Ui(q)?(D.preventDefault(),Ai(e,q).each(x)):ux(s,D.clientX,D.clientY).each(K=>{D.preventDefault();const ee=u(1,K.node,K.position===ua.Before,!1);f(ee),Q(q)?q.focus():e.getBody().focus()})}),e.on("keypress",D=>{te.modifierPressed(D)||Ui(t.getNode())&&D.preventDefault()}),e.on("GetSelectionRange",D=>{let O=D.range;if(i){if(!i.parentNode){i=null;return}O=O.cloneRange(),O.selectNode(i),D.range=O}}),e.on("SetSelectionRange",D=>{D.range=C(D.range);const O=x(D.range,D.forward);O&&(D.range=O)});const F=D=>Q(D)&&D.id==="mcepastebin";e.on("AfterSetSelectionRange",D=>{const O=D.range,q=O.startContainer.parentElement;!h(O)&&!F(q)&&oe(),l(q)||N()}),z6(e),H6(e),W6(e)},E=F=>Bn(F)||wl(F)||_l(F),h=F=>E(F.startContainer)||E(F.endContainer),C=F=>{const D=e.schema.getVoidElements(),O=n.createRng(),q=F.startContainer,K=F.startOffset,ee=F.endContainer,ge=F.endOffset;return Se(D,q.nodeName.toLowerCase())?K===0?O.setStartBefore(q):O.setStartAfter(q):O.setStart(q,K),Se(D,ee.nodeName.toLowerCase())?ge===0?O.setEndBefore(ee):O.setEndAfter(ee):O.setEnd(ee,ge),O},w=(F,D)=>{const O=S.fromDom(e.getBody()),q=e.getDoc(),K=La(O,"#"+r).getOrThunk(()=>{const me=S.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',q);return It(me,"id",r),bt(O,me),me}),ee=n.createRng();Fr(K),zo(K,[S.fromText(Dt,q),S.fromDom(D),S.fromText(Dt,q)]),ee.setStart(K.dom.firstChild,1),ee.setEnd(K.dom.lastChild,0),fl(K,{top:n.getPos(F,e.getBody()).y+"px"}),Uy(K);const ge=t.getSel();return ge&&(ge.removeAllRanges(),ge.addRange(ee)),ee},_=F=>{const D=F.cloneNode(!0),O=e.dispatch("ObjectSelected",{target:F,targetClone:D});if(O.isDefaultPrevented())return null;const q=w(F,O.targetClone),K=S.fromDom(F);return M(Yt(S.fromDom(e.getBody()),`*[${a}]`),ee=>{ze(K,ee)||zt(ee,a)}),n.getAttrib(F,a)||F.setAttribute(a,"1"),i=F,oe(),q},x=(F,D)=>{if(!F)return null;if(F.collapsed){if(!h(F)){const ee=D?1:-1,ge=ci(ee,s,F),me=ge.getNode(!D);if(G(me)){if(ri(me))return u(ee,me,D?!ge.isAtEnd():!1,!1);if(fo(me)&&tt(me.nextSibling)){const Ie=n.createRng();return Ie.setStart(me,0),Ie.setEnd(me,0),Ie}}const Ne=ge.getNode(D);if(G(Ne)){if(ri(Ne))return u(ee,Ne,D?!1:!ge.isAtEnd(),!1);if(fo(Ne)&&tt(Ne.previousSibling)){const Ie=n.createRng();return Ie.setStart(Ne,1),Ie.setEnd(Ne,1),Ie}}}return null}let O=F.startContainer,q=F.startOffset;const K=F.endOffset;if(z(O)&&q===0&&Ui(O.parentNode)&&(O=O.parentNode,q=n.nodeIndex(O),O=O.parentNode),!Q(O))return null;if(K===q+1&&O===F.endContainer){const ee=O.childNodes[q];if(c(ee))return _(ee)}return null},N=()=>{i&&i.removeAttribute(a),La(S.fromDom(e.getBody()),"#"+r).each(at),i=null},I=()=>{o.destroy(),i=null},oe=()=>{o.hide()};return Os(e)||v(),{showCaret:u,showBlockCaretContainer:d,hideFakeCaret:oe,destroy:I}},q6=(e,t)=>{let n=t;for(let s=e.previousSibling;z(s);s=s.previousSibling)n+=s.data.length;return n},Sx=(e,t,n,s,o)=>{if(z(n)&&(s<0||s>n.data.length))return[];const r=o&&z(n)?[q6(n,s)]:[s];let a=n;for(;a!==t&&a.parentNode;)r.push(e.nodeIndex(a,o)),a=a.parentNode;return a===t?r.reverse():[]},Mp=(e,t,n,s,o,r,a=!1)=>{const i=Sx(e,t,n,s,a),l=Sx(e,t,o,r,a);return{start:i,end:l}},wx=(e,t)=>{const n=t.slice(),s=n.pop();return Tt(s)?Sn(n,(r,a)=>r.bind(i=>m.from(i.childNodes[a])),m.some(e)).bind(r=>z(r)&&(s<0||s>r.data.length)?m.none():m.some({node:r,offset:s})):m.none()},_x=(e,t)=>wx(e,t.start).bind(({node:n,offset:s})=>wx(e,t.end).map(({node:o,offset:r})=>{const a=document.createRange();return a.setStart(n,s),a.setEnd(o,r),a})),j6=(e,t,n,s=!1)=>Mp(e,t,n.startContainer,n.startOffset,n.endContainer,n.endOffset,s),fa=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){const s=t.parentNode;e.remove(t),fa(e,s,n)}},ou=(e,t,n,s=!0)=>{const o=t.startContainer.parentNode,r=t.endContainer.parentNode;t.deleteContents(),s&&!n(t.startContainer)&&(z(t.startContainer)&&t.startContainer.data.length===0&&e.remove(t.startContainer),z(t.endContainer)&&t.endContainer.data.length===0&&e.remove(t.endContainer),fa(e,o,n),o!==r&&fa(e,r,n))},Up=(e,t)=>m.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),xx=(e,t,n)=>{const s=e.dynamicPatternsLookup({text:n,block:t});return{...e,blockPatterns:ev(s).concat(e.blockPatterns),inlinePatterns:tv(s).concat(e.inlinePatterns)}},kx=(e,t,n,s)=>{const o=e.createRng();return o.setStart(t,0),o.setEnd(n,s),o.toString()},K6=e=>/^\s[^\s]/.test(e),Nx=(e,t,n)=>{V3(t,0,t).each(o=>{const r=o.container;Lw(r,n.start.length,t).each(l=>{const c=e.createRng();c.setStart(r,0),c.setEnd(l.container,l.offset),ou(e,c,f=>f===t)});const a=S.fromDom(r),i=vl(a);K6(i)&&AA(a,i.slice(1))})},G6=(e,t)=>{const n=e.dom,s=t.pattern,o=_x(n.getRoot(),t.range).getOrDie("Unable to resolve path range"),r=(a,i)=>{const l=i.get(a);return Ge(l)&&hn(l).exists(c=>Se(c,"block"))};return Up(e,o).each(a=>{s.type==="block-format"?r(s.format,e.formatter)&&e.undoManager.transact(()=>{Nx(e.dom,a,s),e.formatter.apply(s.format)}):s.type==="block-command"&&e.undoManager.transact(()=>{Nx(e.dom,a,s),e.execCommand(s.cmd,!1,s.value)})}),!0},Y6=e=>Oo(e,(t,n)=>n.start.length-t.start.length),X6=(e,t)=>{const n=Y6(e),s=t.replace(Dt," ");return _t(n,o=>t.indexOf(o.start)===0||s.indexOf(o.start)===0)},Z6=(e,t,n,s)=>{var o;const r=e.dom,a=cn(e);if(!r.is(t,a))return[];const i=(o=t.textContent)!==null&&o!==void 0?o:"";return X6(n.blockPatterns,i).map(l=>V.trim(i).length===l.start.length?[]:[{pattern:l,range:Mp(r,r.getRoot(),t,0,t,0,s)}]).getOr([])},Q6=(e,t)=>{if(t.length===0)return;const n=e.selection.getBookmark();M(t,s=>G6(e,s)),e.selection.moveToBookmark(n)},Ax=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),ru=(e,t)=>{const n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},Tx=(e,t,n)=>{const s=_x(e.getRoot(),n).getOrDie("Unable to resolve path range"),o=s.startContainer,r=s.endContainer,a=s.endOffset===0?r:r.splitText(s.endOffset),i=s.startOffset===0?o:o.splitText(s.startOffset),l=i.parentNode,c=a.parentNode;return{prefix:t,end:c.insertBefore(Ax(e,t+"-end"),a),start:l.insertBefore(Ax(e,t+"-start"),i)}},Dx=(e,t,n)=>{fa(e,e.get(t.prefix+"-end"),n),fa(e,e.get(t.prefix+"-start"),n)},zp=e=>e.start.length===0,J6=e=>(t,n)=>{const o=t.data.substring(0,n),r=o.lastIndexOf(e.charAt(e.length-1)),a=o.lastIndexOf(e);return a!==-1?a+e.length:r!==-1?r+1:-1},Rx=(e,t,n,s)=>{const o=t.start;return up(e,s.container,s.offset,J6(o),n).bind(a=>{var i,l;const c=(l=(i=n.textContent)===null||i===void 0?void 0:i.indexOf(o))!==null&&l!==void 0?l:-1;if(c!==-1&&a.offset>=c+o.length){const u=e.createRng();return u.setStart(a.container,a.offset-o.length),u.setEnd(a.container,a.offset),m.some(u)}else{const u=a.offset-o.length;return cp(a.container,u,n).map(d=>{const v=e.createRng();return v.setStart(d.container,d.offset),v.setEnd(a.container,a.offset),v}).filter(d=>d.toString()===o).orThunk(()=>Rx(e,t,n,fs(a.container,0)))}})},e5=(e,t,n,s,o,r=!1)=>{if(t.start.length===0&&!r){const a=e.createRng();return a.setStart(n,s),a.setEnd(n,s),m.some(a)}return lp(n,s,o).bind(a=>Rx(e,t,o,a).bind(l=>{var c;if(r){if(l.endContainer===a.container&&l.endOffset===a.offset)return m.none();if(a.offset===0&&((c=l.endContainer.textContent)===null||c===void 0?void 0:c.length)===l.endOffset)return m.none()}return m.some(l)}))},t5=(e,t,n,s)=>{const o=e.dom,r=o.getRoot(),a=n.pattern,i=n.position.container,l=n.position.offset;return cp(i,l-n.pattern.end.length,t).bind(c=>{const f=Mp(o,r,c.container,c.offset,i,l,s);if(zp(a))return m.some({matches:[{pattern:a,startRng:f,endRng:f}],position:c});{const u=au(e,n.remainingPatterns,c.container,c.offset,t,s),d=u.getOr({matches:[],position:c}),v=d.position;return e5(o,a,v.container,v.offset,t,u.isNone()).map(h=>{const C=j6(o,r,h,s);return{matches:d.matches.concat([{pattern:a,startRng:C,endRng:f}]),position:fs(h.startContainer,h.startOffset)}})}})},au=(e,t,n,s,o,r)=>{const a=e.dom;return lp(n,s,a.getRoot()).bind(i=>{const l=kx(a,o,n,s);for(let c=0;c<t.length;c++){const f=t[c];if(!Wu(l,f.end))continue;const u=t.slice();u.splice(c,1);const d=t5(e,o,{pattern:f,remainingPatterns:u,position:i},r);if(d.isNone()&&s>0)return au(e,t,n,s-1,o,r);if(d.isSome())return d}return m.none()})},Px=(e,t,n)=>{e.selection.setRng(n),t.type==="inline-format"?M(t.format,s=>{e.formatter.apply(s)}):e.execCommand(t.cmd,!1,t.value)},n5=(e,t,n,s)=>{const o=ru(e.dom,n);ou(e.dom,o,s),Px(e,t,o)},s5=(e,t,n,s,o)=>{const r=e.dom,a=ru(r,s),i=ru(r,n);ou(r,i,o),ou(r,a,o);const l={prefix:n.prefix,start:n.end,end:s.start},c=ru(r,l);Px(e,t,c)},o5=(e,t)=>{const n=Za("mce_textpattern"),s=_a(t,(o,r)=>{const a=Tx(e,n+`_end${o.length}`,r.endRng);return o.concat([{...r,endMarker:a}])},[]);return _a(s,(o,r)=>{const a=s.length-o.length-1,i=zp(r.pattern)?r.endMarker:Tx(e,n+`_start${a}`,r.startRng);return o.concat([{...r,startMarker:i}])},[])},r5=e=>Oo(e,(t,n)=>n.end.length-t.end.length),a5=(e,t)=>{const n=oo(e,s=>ht(t,o=>s.pattern.start===o.pattern.start&&s.pattern.end===o.pattern.end));return e.length===t.length?n?e:t:e.length>t.length?e:t},Ox=(e,t,n,s,o,r)=>{const a=au(e,o.inlinePatterns,n,s,t,r).fold(()=>[],l=>l.matches),i=au(e,r5(o.inlinePatterns),n,s,t,r).fold(()=>[],l=>l.matches);return a5(a,i)},Bx=(e,t)=>{if(t.length===0)return;const n=e.dom,s=e.selection.getBookmark(),o=o5(n,t);M(o,r=>{const a=n.getParent(r.startMarker.start,n.isBlock),i=l=>l===a;zp(r.pattern)?n5(e,r.pattern,r.endMarker,i):s5(e,r.pattern,r.startMarker,r.endMarker,i),Dx(n,r.endMarker,i),Dx(n,r.startMarker,i)}),e.selection.moveToBookmark(s)},i5=(e,t)=>{const n=e.selection.getRng();return Up(e,n).map(s=>{var o;const r=Math.max(0,n.startOffset),a=xx(t,s,(o=s.textContent)!==null&&o!==void 0?o:""),i=Ox(e,s,n.startContainer,r,a,!0),l=Z6(e,s,a,!0);return l.length>0||i.length>0?(e.undoManager.add(),e.undoManager.extra(()=>{e.execCommand("mceInsertNewLine")},()=>{e.insertContent($r),Bx(e,i),Q6(e,l);const c=e.selection.getRng(),f=lp(c.startContainer,c.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),f.each(u=>{const d=u.container;d.data.charAt(u.offset-1)===$r&&(d.deleteData(u.offset-1,1),fa(e.dom,d.parentNode,v=>v===e.dom.getRoot()))})}),!0):!1}).getOr(!1)},l5=(e,t)=>{const n=e.selection.getRng();Up(e,n).map(s=>{const o=Math.max(0,n.startOffset-1),r=kx(e.dom,s,n.startContainer,o),a=xx(t,s,r),i=Ox(e,s,n.startContainer,o,a,!1);i.length>0&&e.undoManager.transact(()=>{Bx(e,i)})})},Ix=(e,t,n)=>{for(let s=0;s<e.length;s++)if(n(e[s],t))return!0;return!1},c5=(e,t)=>Ix(e,t,(n,s)=>n===s.keyCode&&!te.modifierPressed(s)),u5=(e,t)=>Ix(e,t,(n,s)=>n.charCodeAt(0)===s.charCode),f5=e=>{const t=[",",".",";",":","!","?"],n=[32],s=()=>jD(a1(e),i1(e)),o=()=>m1(e);e.on("keydown",a=>{if(a.keyCode===13&&!te.modifierPressed(a)&&e.selection.isCollapsed()){const i=s();(i.inlinePatterns.length>0||i.blockPatterns.length>0||o())&&i5(e,i)&&a.preventDefault()}},!0);const r=()=>{if(e.selection.isCollapsed()){const a=s();(a.inlinePatterns.length>0||o())&&l5(e,a)}};e.on("keyup",a=>{c5(n,a)&&r()}),e.on("keypress",a=>{u5(t,a)&&$n.setEditorTimeout(e,r)})},d5=e=>{f5(e)},m5=e=>{const t=V.each,n=te.BACKSPACE,s=te.DELETE,o=e.dom,r=e.selection,a=e.parser,i=Fe.browser,l=i.isFirefox(),c=i.isChromium()||i.isSafari(),f=Fe.deviceType.isiPhone()||Fe.deviceType.isiPad(),u=Fe.os.isMacOS()||Fe.os.isiOS(),d=(ae,le)=>{try{e.getDoc().execCommand(ae,!1,String(le))}catch{}},v=ae=>ae.isDefaultPrevented(),E=()=>{const ae=U=>{const pe=o.create("body"),_e=U.cloneContents();return pe.appendChild(_e),r.serializer.serialize(pe,{format:"html"})},le=U=>{const pe=ae(U),_e=o.createRng();_e.selectNode(e.getBody());const Me=ae(_e);return pe===Me};e.on("keydown",U=>{const pe=U.keyCode;if(!v(U)&&(pe===s||pe===n)&&e.selection.isEditable()){const _e=e.selection.isCollapsed(),Me=e.getBody();if(_e&&!o.isEmpty(Me)||!_e&&!le(e.selection.getRng()))return;U.preventDefault(),e.setContent(""),Me.firstChild&&o.isBlock(Me.firstChild)?e.selection.setCursorLocation(Me.firstChild,0):e.selection.setCursorLocation(Me,0),e.nodeChanged()}})},h=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},C=()=>{e.inline||o.bind(e.getDoc(),"mousedown mouseup",ae=>{let le;if(ae.target===e.getDoc().documentElement)if(le=r.getRng(),e.getBody().focus(),ae.type==="mousedown"){if(Bn(le.startContainer))return;r.placeCaretAt(ae.clientX,ae.clientY)}else r.setRng(le)})},w=()=>{e.on("keydown",ae=>{if(!v(ae)&&ae.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(r.isCollapsed()&&r.getRng().startOffset===0){const le=r.getNode(),U=le.previousSibling;if(le.nodeName==="HR"){o.remove(le),ae.preventDefault();return}U&&U.nodeName&&U.nodeName.toLowerCase()==="hr"&&(o.remove(U),ae.preventDefault())}}})},_=()=>{Range.prototype.getClientRects||e.on("mousedown",ae=>{if(!v(ae)&&ae.target.nodeName==="HTML"){const le=e.getBody();le.blur(),$n.setEditorTimeout(e,()=>{le.focus()})}})},x=()=>{const ae=bv(e);e.on("click",le=>{const U=le.target;/^(IMG|HR)$/.test(U.nodeName)&&o.isEditable(U.parentNode)&&(le.preventDefault(),e.selection.select(U),e.nodeChanged()),U.nodeName==="A"&&o.hasClass(U,ae)&&U.childNodes.length===0&&o.isEditable(U.parentNode)&&(le.preventDefault(),r.select(U))})},N=()=>{const ae=()=>{const U=o.getAttribs(r.getStart().cloneNode(!1));return()=>{const pe=r.getStart();pe!==e.getBody()&&(o.setAttrib(pe,"style",null),t(U,_e=>{pe.setAttributeNode(_e.cloneNode(!0))}))}},le=()=>!r.isCollapsed()&&o.getParent(r.getStart(),o.isBlock)!==o.getParent(r.getEnd(),o.isBlock);e.on("keypress",U=>{let pe;return!v(U)&&(U.keyCode===8||U.keyCode===46)&&le()?(pe=ae(),e.getDoc().execCommand("delete",!1),pe(),U.preventDefault(),!1):!0}),o.bind(e.getDoc(),"cut",U=>{if(!v(U)&&le()){const pe=ae();$n.setEditorTimeout(e,()=>{pe()})}})},I=()=>{e.on("keydown",ae=>{if(!v(ae)&&ae.keyCode===n&&r.isCollapsed()&&r.getRng().startOffset===0){const le=r.getNode().previousSibling;if(le&&le.nodeName&&le.nodeName.toLowerCase()==="table")return ae.preventDefault(),!1}return!0})},oe=()=>{e.on("keydown",ae=>{if(v(ae)||ae.keyCode!==te.BACKSPACE)return;let le=r.getRng();const U=le.startContainer,pe=le.startOffset,_e=o.getRoot();let Me=U;if(!(!le.collapsed||pe!==0)){for(;Me.parentNode&&Me.parentNode.firstChild===Me&&Me.parentNode!==_e;)Me=Me.parentNode;Me.nodeName==="BLOCKQUOTE"&&(e.formatter.toggle("blockquote",void 0,Me),le=o.createRng(),le.setStart(U,0),le.setEnd(U,0),r.setRng(le))}})},F=()=>{const ae=()=>{d("StyleWithCSS",!1),d("enableInlineTableEditing",!1),mv(e)||d("enableObjectResizing",!1)};gv(e)||e.on("BeforeExecCommand mousedown",ae)},D=()=>{const ae=()=>{t(o.select("a:not([data-mce-block])"),le=>{var U;let pe=le.parentNode;const _e=o.getRoot();if((pe==null?void 0:pe.lastChild)===le){for(;pe&&!o.isBlock(pe);){if(((U=pe.parentNode)===null||U===void 0?void 0:U.lastChild)!==pe||pe===_e)return;pe=pe.parentNode}o.add(pe,"br",{"data-mce-bogus":1})}})};e.on("SetContent ExecCommand",le=>{(le.type==="setcontent"||le.command==="mceInsertLink")&&ae()})},O=()=>{e.on("init",()=>{d("DefaultParagraphSeparator",cn(e))})},q=ae=>{const le=ae.getBody(),U=ae.selection.getRng();return U.startContainer===U.endContainer&&U.startContainer===le&&U.startOffset===0&&U.endOffset===le.childNodes.length},K=()=>{e.on("keyup focusin mouseup",ae=>{!te.modifierPressed(ae)&&!q(e)&&r.normalize()},!0)},ee=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},ge=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},me=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",ae=>{let le;ae.target.nodeName==="HTML"&&(le=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(le),e.selection.normalize(),e.nodeChanged())}))},Ne=()=>{u&&e.on("keydown",ae=>{te.metaKeyPressed(ae)&&!ae.shiftKey&&(ae.keyCode===37||ae.keyCode===39)&&(ae.preventDefault(),e.selection.getSel().modify("move",ae.keyCode===37?"backward":"forward","lineboundary"))})},Ie=()=>{e.on("click",ae=>{let le=ae.target;do if(le.tagName==="A"){ae.preventDefault();return}while(le=le.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},it=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",ae=>{ae.preventDefault()})})},Lt=()=>{a.addNodeFilter("br",ae=>{let le=ae.length;for(;le--;)ae[le].attr("class")==="Apple-interchange-newline"&&ae[le].remove()})},yt=Ee,H=()=>{if(!l||e.removed)return!1;const ae=e.selection.getSel();return!ae||!ae.rangeCount||ae.rangeCount===0},re=()=>{c&&(C(),x(),it(),h(),f&&(ge(),me(),Ie())),l&&(_(),F(),ee(),Ne())},Ae=()=>{e.on("drop",ae=>{var le;const U=(le=ae.dataTransfer)===null||le===void 0?void 0:le.getData("text/html");ce(U)&&/^<img[^>]*>$/.test(U)&&e.dispatch("dragend",new window.DragEvent("dragend",ae))})},xe=()=>{oe(),E(),Fe.windowsPhone||K(),c&&(C(),x(),O(),it(),I(),Lt(),f?(ge(),me(),Ie()):h()),l&&(w(),_(),N(),F(),D(),ee(),Ne(),I(),Ae())};return Os(e)?re():xe(),{refreshContentEditable:yt,isHidden:H}},Hp=qe.DOM,p5=(e,t)=>{const n=S.fromDom(e.getBody()),s=nf(ao(n)),o=S.fromTag("style");It(o,"type","text/css"),bt(o,S.fromText(t)),bt(s,o),e.on("remove",()=>{at(o)})},g5=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,Wp=e=>Na(e,t=>Ye(t)===!1),Fx=e=>{const t=e.options.get,n=e.editorUpload.blobCache;return Wp({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_fonts_to_spans:t("convert_fonts_to_spans"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),inline_styles:t("inline_styles"),root_name:g5(e),sanitize:t("xss_sanitization"),validate:!0,blob_cache:n,document:e.getDoc()})},Lx=e=>{const t=e.options.get;return Wp({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},h5=e=>{const t=e.options.get;return{...Fx(e),...Lx(e),...Wp({remove_trailing_brs:t("remove_trailing_brs"),url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")})}},b5=e=>{const t=na(Fx(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(n,s)=>{const o=e.dom,r="data-mce-"+s;let a=n.length;for(;a--;){const i=n[a];let l=i.attr(s);if(l&&!i.attr(r)){if(l.indexOf("data:")===0||l.indexOf("blob:")===0)continue;s==="style"?(l=o.serializeStyle(o.parseStyle(l),i.name),l.length||(l=null),i.attr(r,l),i.attr(s,l)):s==="tabindex"?(i.attr(r,l),i.attr(s,null)):i.attr(r,e.convertURL(l,s,i.name))}}}),t.addNodeFilter("script",n=>{let s=n.length;for(;s--;){const o=n[s],r=o.attr("type")||"no/type";r.indexOf("mce-")!==0&&o.attr("type","mce-"+r)}}),u1(e)&&t.addNodeFilter("#cdata",n=>{var s;let o=n.length;for(;o--;){const r=n[o];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode((s=r.value)!==null&&s!==void 0?s:"")+"]]"}}),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",n=>{let s=n.length;const o=e.schema.getNonEmptyElements();for(;s--;){const r=n[s];r.isEmpty(o)&&r.getAll("br").length===0&&r.append(new fn("br",1))}}),t},v5=e=>{const t=jR(e);t&&$n.setEditorTimeout(e,()=>{let n;t===!0?n=e:n=e.editorManager.get(t),n&&!n.destroyed&&(n.focus(),n.selection.scrollIntoView())},100)},y5=e=>{const t=e.dom.getRoot();!e.inline&&(!Kl(e)||e.selection.getStart(!0)===t)&&Jt(t).each(n=>{const s=n.getNode(),o=Ks(s)?Jt(s).getOr(n):n;e.selection.setRng(o.toRange())})},C5=e=>{e.bindPendingEventDelegates(),e.initialized=!0,KP(e),e.focus(!0),y5(e),e.nodeChanged({initial:!0});const t=VR(e);Be(t)&&t.call(e,e),v5(e)},$x=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,E5=(e,t,n)=>{const s=[$x(e).loadAll(t)];return e.inline?s:s.concat([e.ui.styleSheetLoader.loadAll(n)])},Mx=e=>{const t=$x(e),n=dv(e),s=e.contentCSS,o=()=>{t.unloadAll(s),e.inline||e.ui.styleSheetLoader.unloadAll(n)},r=()=>{e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){let l="";V.each(e.contentStyles,c=>{l+=c+`\r
`}),e.dom.addStyle(l)}const a=Promise.all(E5(e,s,n)).then(r).catch(r),i=vR(e);return i&&p5(e,i),a},S5=e=>{const t=e.getDoc(),n=e.getBody();qP(e),KR(e)||(t.body.spellcheck=!1,Hp.setAttrib(n,"spellcheck","false")),e.quirks=m5(e),jP(e);const s=yR(e);s!==void 0&&(n.dir=s);const o=GR(e);o&&e.on("BeforeSetContent",r=>{V.each(o,a=>{r.content=r.content.replace(a,i=>"<!--mce:protected "+escape(i)+"-->")})}),e.on("SetContent",()=>{e.addVisual(e.getBody())}),e.on("compositionstart compositionend",r=>{e.composing=r.type==="compositionstart"})},w5=e=>{Os(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},Vp=e=>{e.removed!==!0&&(w5(e),C5(e))},Ux=e=>{const t=e.getElement();let n=e.getDoc();e.inline&&(Hp.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);const s=e.getBody();s.disabled=!0,e.readonly=gv(e),e._editableRoot=LR(e),!e.readonly&&e.hasEditableRoot()&&(e.inline&&Hp.getStyle(s,"position",!0)==="static"&&(s.style.position="relative"),s.contentEditable="true"),s.disabled=!1,e.editorUpload=dH(e),e.schema=po(Lx(e)),e.dom=qe(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:e.inline,schema:e.schema,contentCssCors:pR(e),referrerPolicy:Hf(e),onSetAttrib:a=>{e.dispatch("SetAttrib",a)}}),e.parser=b5(e),e.serializer=FS(h5(e),e),e.selection=IS(e.dom,e.getWin(),e.serializer,e),e.annotator=my(e),e.formatter=ZS(e),e.undoManager=JS(e),e._nodeChangeDispatcher=new bj(e),e._selectionOverrides=V6(e),MW(e),Y8(e),KW(e),Os(e)||(n6(e),d5(e));const o=hj(e);FW(e,o),VW(e),NH(e),O8(e);const r=hU(e);S5(e),r.fold(()=>{Mx(e).then(()=>Vp(e))},a=>{e.setProgressState(!0),Mx(e).then(()=>{a().then(i=>{e.setProgressState(!1),Vp(e),DS(e)},i=>{e.notificationManager.open({type:"error",text:String(i)}),Vp(e),DS(e)})})})},_5=St,x5=(e,t,n)=>pA(e,t,_5,n),qp=qe.DOM,k5=(e,t,n,s)=>{const o=S.fromTag("iframe");return s.each(r=>It(o,"tabindex",r)),ro(o,n),ro(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),Rr(o,"tox-edit-area__iframe"),o},N5=e=>{let t=JD(e)+"<html><head>";rv(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const n=eR(e),s=tR(e),o=e.translate(HR(e));return av(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+av(e)+'" />'),t+=`</head><body id="${n}" class="mce-content-body ${s}" data-id="${e.id}" aria-label="${o}"><br></body></html>`,t},A5=(e,t)=>{const n=e.translate("Rich Text Area"),s=Hs(S.fromDom(e.getElement()),"tabindex").bind(ll),o=k5(e.id,n,QD(e),s).dom;o.onload=()=>{o.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=o,e.iframeHTML=N5(e),qp.add(t.iframeContainer,o)},T5=e=>{const t=e.iframeElement,n=()=>{e.contentDocument=t.contentDocument,Ux(e)};if(d1(e)||Fe.browser.isFirefox()){const s=e.getDoc();s.open(),s.write(e.iframeHTML),s.close(),n()}else{const s=x5(S.fromDom(t),"load",()=>{s.unbind(),n()});t.srcdoc=e.iframeHTML}},D5=(e,t)=>{A5(e,t),t.editorContainer&&(t.editorContainer.style.display=e.orgDisplay,e.hidden=qp.isHidden(t.editorContainer)),e.getElement().style.display="none",qp.setAttrib(e.id,"aria-hidden","true"),e.getElement().style.visibility=e.orgVisibility,T5(e)},zx=qe.DOM,R5=(e,t,n)=>{const s=oa.get(n),o=oa.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=V.trim(n),s&&V.inArray(t,n)===-1){if(e.plugins[n])return;try{const r=s(e,o)||{};e.plugins[n]=r,Be(r.init)&&(r.init(e,o),t.push(n))}catch(r){Zz(e,n,r)}}},P5=e=>e.replace(/^\-/,""),O5=e=>{const t=[];M($l(e),n=>{R5(e,t,P5(n))})},B5=e=>{const t=V.trim(cv(e)),n=e.ui.registry.getAll().icons,s={..._c.get("default").icons,..._c.get(t).icons};Je(s,(o,r)=>{Se(n,r)||e.ui.registry.addIcon(r,o)})},I5=e=>{const t=qr(e);if(ce(t)){const n=pr.get(t);e.theme=n(e,pr.urls[t])||{},Be(e.theme.init)&&e.theme.init(e,pr.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},F5=e=>{const t=Wf(e),n=sa.get(t);e.model=n(e,sa.urls[t])},L5=e=>{const t=e.theme.renderUI;return t?t():Wx(e)},$5=e=>{const t=e.getElement(),s=qr(e)(e,t);return s.editorContainer.nodeType&&(s.editorContainer.id=s.editorContainer.id||e.id+"_parent"),s.iframeContainer&&s.iframeContainer.nodeType&&(s.iframeContainer.id=s.iframeContainer.id||e.id+"_iframecontainer"),s.height=s.iframeHeight?s.iframeHeight:t.offsetHeight,s},Hx=(e,t)=>({editorContainer:e,iframeContainer:t,api:{}}),M5=e=>{const t=zx.create("div");return zx.insertAfter(t,e),Hx(t,t)},Wx=e=>{const t=e.getElement();return e.inline?Hx(null):M5(t)},U5=e=>{const t=e.getElement();return e.orgDisplay=t.style.display,ce(qr(e))?L5(e):Be(qr(e))?$5(e):Wx(e)},z5=(e,t)=>{const n={show:m.from(t.show).getOr(Ee),hide:m.from(t.hide).getOr(Ee),isEnabled:m.from(t.isEnabled).getOr(St),setEnabled:s=>{e.mode.isReadOnly()||m.from(t.setEnabled).each(o=>o(s))}};e.ui={...e.ui,...n}},H5=async e=>{e.dispatch("ScriptsLoaded"),B5(e),I5(e),F5(e),O5(e);const t=await U5(e);z5(e,m.from(t.api).getOr({})),e.editorContainer=t.editorContainer,tH(e),e.inline?Ux(e):D5(e,{editorContainer:t.editorContainer,iframeContainer:t.iframeContainer})},gr=qe.DOM,Vx=e=>e.charAt(0)==="-",W5=(e,t)=>{const n=uv(t),s=gR(t);if(!as.hasCode(n)&&n!=="en"){const o=Cs(s)?s:`${t.editorManager.baseURL}/langs/${n}.js`;e.add(o).catch(()=>{Gz(t,o,n)})}},V5=(e,t)=>{const n=qr(e);if(ce(n)&&!Vx(n)&&!Se(pr.urls,n)){const s=_R(e),o=s?e.documentBaseURI.toAbsolute(s):`themes/${n}/theme${t}.js`;pr.load(n,o).catch(()=>{Yz(e,o,n)})}},q5=(e,t)=>{const n=Wf(e);if(n!=="plugin"&&!Se(sa.urls,n)){const s=xR(e),o=ce(s)?e.documentBaseURI.toAbsolute(s):`models/${n}/model${t}.js`;sa.load(n,o).catch(()=>{Xz(e,o,n)})}},j5=e=>m.from(cR(e)).filter(Cs).map(t=>({url:t,name:m.none()})),qx=(e,t,n)=>m.from(t).filter(s=>Cs(s)&&!_c.has(s)).map(s=>({url:`${e.editorManager.baseURL}/icons/${s}/icons${n}.js`,name:m.some(s)})),K5=(e,t,n)=>{const s=qx(t,"default",n),o=j5(t).orThunk(()=>qx(t,cv(t),""));M(wN([s,o]),r=>{e.add(r.url).catch(()=>{Kz(t,r.url,r.name.getOrUndefined())})})},G5=(e,t)=>{const n=(s,o)=>{oa.load(s,o).catch(()=>{jz(e,o,s)})};Je($R(e),(s,o)=>{n(o,s),e.options.set("plugins",$l(e).concat(o))}),M($l(e),s=>{s=V.trim(s),s&&!oa.urls[s]&&!Vx(s)&&n(s,`plugins/${s}/plugin${t}.js`)})},Y5=e=>{const t=qr(e);return!ce(t)||G(pr.get(t))},X5=e=>{const t=Wf(e);return G(sa.get(t))},Z5=(e,t)=>{const n=Ys.ScriptLoader,s=()=>{!e.removed&&Y5(e)&&X5(e)&&H5(e)};V5(e,t),q5(e,t),W5(n,e),K5(n,e,t),G5(e,t),n.loadQueue().then(s,s)},Q5=(e,t)=>ob.forElement(e,{contentCssCors:hv(t),referrerPolicy:Hf(t)}),J5=e=>{const t=e.id;as.setCode(uv(e));const n=()=>{gr.unbind(window,"ready",n),e.render()};if(!Go.Event.domLoaded){gr.bind(window,"ready",n);return}if(!e.getElement())return;const s=S.fromDom(e.getElement()),o=uh(s);e.on("remove",()=>{_g(s.dom.attributes,a=>zt(s,a.name)),ro(s,o)}),e.ui.styleSheetLoader=Q5(s,e),Vf(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const r=e.getElement().form||gr.getParent(t,"form");r&&(e.formElement=r,RR(e)&&!af(e.getElement())&&(gr.insertAfter(gr.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=a=>{e.dispatch(a.type,a)},gr.bind(r,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),PR(e)&&!r.submit.nodeType&&!r.submit.length&&!r._mceOldSubmit&&(r._mceOldSubmit=r.submit,r.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),r._mceOldSubmit(r)))),e.windowManager=WS(e),e.notificationManager=HS(e),h1(e)&&e.on("GetContent",a=>{a.save&&(a.content=gr.encode(a.content))}),OR(e)&&e.on("submit",()=>{e.initialized&&e.save()}),BR(e)&&(e._beforeUnload=()=>{e.initialized&&!e.destroyed&&!e.isHidden()&&e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),Z5(e,e.suffix)},e9=(e,t)=>{e._editableRoot!==t&&(e._editableRoot=t,e.readonly||(e.getBody().contentEditable=String(e.hasEditableRoot()),e.nodeChanged()),nO(e,t))},t9=e=>e._editableRoot,n9=(e,t)=>({sections:Y(e),options:Y(t)}),jx=Es().deviceType,Kx=jx.isPhone(),s9=jx.isTablet(),zi=e=>{if(rt(e))return[];{const t=Ge(e)?e:e.split(/[ ,]/),n=Ue(t,Ar);return ve(n,Cs)}},o9=(e,t)=>{const n=Yk(t,(s,o)=>Ve(e,o));return n9(n.t,n.f)},r9=(e,t,n={})=>{const s=e.sections(),o=st(s,t).getOr({});return V.extend({},n,o)},jp=(e,t)=>Se(e.sections(),t),a9=(e,t)=>jp(e,t)?e.sections()[t]:{},i9=(e,t)=>({...{table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:st(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},...t?{menubar:!1}:{}}),l9=(e,t)=>{var n;const s=(n=t.external_plugins)!==null&&n!==void 0?n:{};return e&&e.external_plugins?V.extend({},e.external_plugins,s):s},c9=(e,t)=>[...zi(e),...zi(t)],u9=(e,t,n,s)=>e&&jp(t,"mobile")?s:n,f9=(e,t,n,s)=>{const o=zi(n.forced_plugins),r=zi(s.plugins),a=a9(t,"mobile"),i=a.plugins?zi(a.plugins):r,l=u9(e,t,r,i),c=c9(o,l);return V.extend(s,{forced_plugins:o,plugins:c})},d9=(e,t)=>e&&jp(t,"mobile"),m9=(e,t,n,s,o)=>{var r;const a=e?{mobile:i9((r=o.mobile)!==null&&r!==void 0?r:{},t)}:{},i=o9(["mobile"],$c(a,o)),l=V.extend(n,s,i.options(),d9(e,i)?r9(i,"mobile"):{},{external_plugins:l9(s,i.options())});return f9(e,i,s,l)},p9=(e,t)=>m9(Kx||s9,Kx,t,e,t),g9=(e,t)=>zU(e,t),h9=e=>{const t=(s,o)=>{e.formatter.toggle(s,o),e.nodeChanged()},n=s=>()=>{M("left,center,right,justify".split(","),o=>{s!==o&&e.formatter.remove("align"+o)}),s!=="none"&&t("align"+s)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})},b9=e=>{const t=n=>()=>{const s=e.selection,o=s.isCollapsed()?[e.dom.getParent(s.getNode(),e.dom.isBlock)]:s.getSelectedBlocks();return ht(o,r=>G(e.formatter.matchNode(r,n)))};e.editorCommands.addCommands({JustifyLeft:t("alignleft"),JustifyCenter:t("aligncenter"),JustifyRight:t("alignright"),JustifyFull:t("alignjustify")},"state")},v9=e=>{h9(e),b9(e)},y9=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{const n=e.getDoc();let s;try{n.execCommand(t)}catch{s=!0}if(t==="paste"&&!n.queryCommandEnabled(t)&&(s=!0),s||!n.queryCommandSupported(t)){let o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(Fe.os.isMacOS()||Fe.os.isiOS())&&(o=o.replace(/Ctrl\+/g,"+")),e.notificationManager.open({text:o,type:"error"})}}})},C9=(e,t,n)=>{const s=S.fromDom(e.getRoot());return yi(s,P.fromRangeStart(t))?n=n.replace(/^ /,"&nbsp;"):n=n.replace(/^&nbsp;/," "),Ci(s,P.fromRangeEnd(t))?n=n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n=n.replace(/&nbsp;(<br( \/)?>)?$/," "),n},E9=e=>{if(typeof e!="string"){const t=V.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},S9=(e,t)=>{const n=e.selection,s=e.dom;return/^ | $/.test(t)?C9(s,n.getRng(),t):t},iu=(e,t)=>{if(e.selection.isEditable()){const{content:n,details:s}=E9(t);Am(e,{...s,content:S9(e,n),format:"html",set:!1,selection:!0}).each(o=>{const r=MU(e,o.content,s);Tm(e,r,o),e.addVisual()})}},w9=e=>{e.editorCommands.addCommands({mceCleanup:()=>{const t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,n,s)=>{iu(e,e.dom.createHTML("img",{src:s}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,n,s)=>{iu(e,e.dom.encode(s))},insertHTML:(t,n,s)=>{iu(e,s)},mceInsertContent:(t,n,s)=>{iu(e,s)},mceSetContent:(t,n,s)=>{e.setContent(s)},mceReplaceContent:(t,n,s)=>{e.execCommand("mceInsertContent",!1,s.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent(QR(e))}})},_9={"font-size":"size","font-family":"face"},x9=Gu("font"),k9=(e,t,n)=>{const s=r=>dl(r,e).orThunk(()=>x9(r)?st(_9,e).bind(a=>Hs(r,a)):m.none()),o=r=>ze(S.fromDom(t),r);return am(S.fromDom(n),r=>s(r),o)},N9=e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),A9=(e,t)=>m.from(qe.DOM.getStyle(t,e,!0)),Gx=e=>(t,n)=>m.from(n).map(S.fromDom).filter(bn).bind(s=>k9(e,t,s.dom).or(A9(e,s.dom))).getOr(""),T9=Gx("font-size"),D9=on(N9,Gx("font-family")),R9=e=>Jt(e.getBody()).bind(t=>{const n=t.container();return m.from(z(n)?n.parentNode:n)}),P9=e=>m.from(e.selection.getRng()).bind(t=>{const n=e.getBody();return t.startContainer===n&&t.startOffset===0?m.none():m.from(e.selection.getStart(!0))}),O9=(e,t)=>P9(e).orThunk(ne(R9,e)).map(S.fromDom).filter(bn).bind(t),Kp=(e,t)=>O9(e,Po(m.some,t)),Yx=(e,t)=>{if(/^[0-9.]+$/.test(t)){const n=parseInt(t,10);if(n>=1&&n<=7){const s=p1(e),o=g1(e);return o.length>0?o[n-1]||t:s[n-1]||t}else return t}else return t},B9=e=>{const t=e.split(/\s*,\s*/);return Ue(t,n=>n.indexOf(" ")!==-1&&!(Ut(n,'"')||Ut(n,"'"))?`'${n}'`:n).join(",")},I9=(e,t)=>{const n=Yx(e,t);e.formatter.toggle("fontname",{value:B9(n)}),e.nodeChanged()},F9=e=>Kp(e,t=>D9(e.getBody(),t.dom)).getOr(""),L9=(e,t)=>{e.formatter.toggle("fontsize",{value:Yx(e,t)}),e.nodeChanged()},$9=e=>Kp(e,t=>T9(e.getBody(),t.dom)).getOr(""),M9=e=>Kp(e,t=>{const n=S.fromDom(e.getBody()),s=am(t,r=>dl(r,"line-height"),ne(ze,n)),o=()=>{const r=parseFloat(_s(t,"line-height")),a=parseFloat(_s(t,"font-size"));return String(r/a)};return s.getOrThunk(o)}).getOr(""),U9=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},z9=e=>{const t=(n,s)=>{e.formatter.toggle(n,s),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>{t(n)},"ForeColor,HiliteColor":(n,s,o)=>{t(n,{value:o})},BackColor:(n,s,o)=>{t("hilitecolor",{value:o})},FontName:(n,s,o)=>{I9(e,o)},FontSize:(n,s,o)=>{L9(e,o)},LineHeight:(n,s,o)=>{U9(e,o)},Lang:(n,s,o)=>{var r;t(n,{value:o.code,customValue:(r=o.customCode)!==null&&r!==void 0?r:null})},RemoveFormat:n=>{e.formatter.remove(n)},mceBlockQuote:()=>{t("blockquote")},FormatBlock:(n,s,o)=>{t(ce(o)?o:"p")},mceToggleFormat:(n,s,o)=>{t(o)}})},H9=e=>{const t=n=>e.formatter.match(n);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>t(n),mceBlockQuote:()=>t("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",()=>F9(e)),e.editorCommands.addQueryValueHandler("FontSize",()=>$9(e)),e.editorCommands.addQueryValueHandler("LineHeight",()=>M9(e))},W9=e=>{z9(e),H9(e)},V9=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},q9=e=>{e.editorCommands.addCommands({Indent:()=>{OW(e)},Outdent:()=>{nw(e)}}),e.editorCommands.addCommands({Outdent:()=>Q0(e)},"state")},j9=e=>{const t=(n,s,o)=>{const r=ce(o)?{href:o}:o,a=e.dom.getParent(e.selection.getNode(),"a");Qe(r)&&ce(r.href)&&(r.href=r.href.replace(/ /g,"%20"),(!a||!r.href)&&e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,a))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isEditable()){if(e.selection.isCollapsed()){const n=e.dom.getParent(e.selection.getStart(),"a");n&&e.dom.remove(n,!0);return}e.formatter.remove("link")}},mceInsertLink:t,createLink:t})},K9=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{e.getDoc().execCommand(t);const n=e.dom.getParent(e.selection.getNode(),"ol,ul");if(n){const s=n.parentNode;if(s&&/^(H[1-6]|P|ADDRESS|PRE)$/.test(s.nodeName)){const o=e.selection.getBookmark();e.dom.split(s,n),e.selection.moveToBookmark(o)}}}})},G9=e=>{e.editorCommands.addCommands({"InsertUnorderedList,InsertOrderedList":t=>{const n=e.dom.getParent(e.selection.getNode(),"ul,ol");return n&&(t==="insertunorderedlist"&&n.tagName==="UL"||t==="insertorderedlist"&&n.tagName==="OL")}},"state")},Y9=e=>{K9(e),G9(e)},X9=e=>{e.editorCommands.addCommands({insertParagraph:()=>{Yc(f_,e)},mceInsertNewLine:(t,n,s)=>{v_(e,s)},InsertLineBreak:(t,n,s)=>{Yc(p_,e)}})},Z9=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,n,s)=>{let o=0;e.dom.getParent(e.selection.getNode(),r=>Q(r)&&o++===s?(e.selection.select(r),!1):!0,e.getBody())},mceSelectNode:(t,n,s)=>{e.selection.select(s)},selectAll:()=>{const t=e.dom.getParent(e.selection.getStart(),rs);if(t){const n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}}})},Q9=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,n,s)=>{const o=s??e.selection.getNode();if(o!==e.getBody()){const r=e.selection.getBookmark();e.dom.remove(o,!0),e.selection.moveToBookmark(r)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,n,s)=>{NB(e,s===!0)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},J9=e=>{v9(e),y9(e),V9(e),Z9(e),w9(e),j9(e),q9(e),X9(e),Y9(e),W9(e),Q9(e)},e4=["toggleview"],Xx=e=>Ve(e4,e.toLowerCase());class Zx{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,n=!1,s,o){const r=this.editor,a=t.toLowerCase(),i=o==null?void 0:o.skip_focus;if(r.removed||(a!=="mcefocus"&&(!/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)&&!i?r.focus():aB(r)),r.dispatch("BeforeExecCommand",{command:t,ui:n,value:s}).isDefaultPrevented()))return!1;const c=this.commands.exec[a];return Be(c)?(c(a,n,s),r.dispatch("ExecCommand",{command:t,ui:n,value:s}),!0):!1}queryCommandState(t){if(!Xx(t)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=t.toLowerCase(),s=this.commands.state[n];return Be(s)?s(n):!1}queryCommandValue(t){if(!Xx(t)&&this.editor.quirks.isHidden()||this.editor.removed)return"";const n=t.toLowerCase(),s=this.commands.value[n];return Be(s)?s(n):""}addCommands(t,n="exec"){const s=this.commands;Je(t,(o,r)=>{M(r.toLowerCase().split(","),a=>{s[n][a]=o})})}addCommand(t,n,s){const o=t.toLowerCase();this.commands.exec[o]=(r,a,i)=>n.call(s??this.editor,a,i)}queryCommandSupported(t){const n=t.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(t,n,s){this.commands.state[t.toLowerCase()]=()=>n.call(s??this.editor)}addQueryValueHandler(t,n,s){this.commands.value[t.toLowerCase()]=()=>n.call(s??this.editor)}}const hr="data-mce-contenteditable",t4=(e,t,n)=>{Xu(e,t)&&!n?Pr(e,t):n&&Rr(e,t)},Gp=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch{}},lu=(e,t)=>{e.dom.contentEditable=t?"true":"false"},n4=e=>{M(Yt(e,'*[contenteditable="true"]'),t=>{It(t,hr,"true"),lu(t,!1)})},s4=e=>{M(Yt(e,`*[${hr}="true"]`),t=>{zt(t,hr),lu(t,!0)})},o4=e=>{m.from(e.selection.getNode()).each(t=>{t.removeAttribute("data-mce-selected")})},r4=e=>{e.selection.setRng(e.selection.getRng())},a4=(e,t)=>{const n=S.fromDom(e.getBody());t4(n,"mce-content-readonly",t),t?(e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),o4(e),e.readonly=!0,lu(n,!1),n4(n)):(e.readonly=!1,e.hasEditableRoot()&&lu(n,!0),s4(n),Gp(e,"StyleWithCSS",!1),Gp(e,"enableInlineTableEditing",!1),Gp(e,"enableObjectResizing",!1),xB(e)&&e.focus(),r4(e),e.nodeChanged())},br=e=>e.readonly,Qx=e=>{e.parser.addAttributeFilter("contenteditable",t=>{br(e)&&M(t,n=>{n.attr(hr,n.attr("contenteditable")),n.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(hr,t=>{br(e)&&M(t,n=>{n.attr("contenteditable",n.attr(hr))})}),e.serializer.addTempAttr(hr)},i4=e=>{e.serializer?Qx(e):e.on("PreInit",()=>{Qx(e)})},l4=e=>e.type==="click",c4=["copy"],u4=e=>Ve(c4,e.type),f4=(e,t)=>Uo(t,"a",s=>ze(s,S.fromDom(e.getBody()))).bind(s=>Hs(s,"href")),d4=(e,t)=>{if(l4(t)&&!te.metaKeyPressed(t)){const n=S.fromDom(t.target);f4(e,n).each(s=>{if(t.preventDefault(),/^#/.test(s)){const o=e.dom.select(`${s},[name="${Bg(s,"#")}"]`);o.length&&e.selection.scrollIntoView(o[0],!0)}else window.open(s,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else u4(t)&&e.dispatch(t.type,t)},m4=e=>{e.on("ShowCaret",t=>{br(e)&&t.preventDefault()}),e.on("ObjectSelected",t=>{br(e)&&t.preventDefault()})},p4=V.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class Yp{static isNative(t){return!!p4[t.toLowerCase()]}constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||lt}fire(t,n){return this.dispatch(t,n)}dispatch(t,n){const s=t.toLowerCase(),o=kf(s,n??{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);const r=this.bindings[s];if(r)for(let a=0,i=r.length;a<i;a++){const l=r[a];if(!l.removed){if(l.once&&this.off(s,l.func),o.isImmediatePropagationStopped())return o;if(l.func.call(this.scope,o)===!1)return o.preventDefault(),o}}return o}on(t,n,s,o){if(n===!1&&(n=lt),n){const r={func:n,removed:!1};o&&V.extend(r,o);const a=t.toLowerCase().split(" ");let i=a.length;for(;i--;){const l=a[i];let c=this.bindings[l];c||(c=[],this.toggleEvent(l,!0)),s?c=[r,...c]:c=[...c,r],this.bindings[l]=c}}return this}off(t,n){if(t){const s=t.toLowerCase().split(" ");let o=s.length;for(;o--;){const r=s[o];let a=this.bindings[r];if(!r)return Je(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(!n)a.length=0;else{const i=wa(a,l=>l.func===n);a=i.fail,this.bindings[r]=a,M(i.pass,l=>{l.removed=!0})}a.length||(this.toggleEvent(t,!1),delete this.bindings[r])}}}else Je(this.bindings,(s,o)=>{this.toggleEvent(o,!1)}),this.bindings={};return this}once(t,n,s){return this.on(t,n,s,{once:!0})}has(t){t=t.toLowerCase();const n=this.bindings[t];return!(!n||n.length===0)}}const Hi=e=>(e._eventDispatcher||(e._eventDispatcher=new Yp({scope:e,toggleEvent:(t,n)=>{Yp.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),Xp={fire(e,t,n){return this.dispatch(e,t,n)},dispatch(e,t,n){const s=this;if(s.removed&&e!=="remove"&&e!=="detach")return kf(e.toLowerCase(),t??{},s);const o=Hi(s).dispatch(e,t);if(n!==!1&&s.parent){let r=s.parent();for(;r&&!o.isPropagationStopped();)r.dispatch(e,o,!1),r=r.parent?r.parent():void 0}return o},on(e,t,n){return Hi(this).on(e,t,n)},off(e,t){return Hi(this).off(e,t)},once(e,t){return Hi(this).once(e,t)},hasEventListeners(e){return Hi(this).has(e)}},cu=qe.DOM;let vr;const uu=(e,t)=>{if(t==="selectionchange")return e.getDoc();if(!e.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(t))return e.getDoc().documentElement;const n=pv(e);return n?(e.eventRoot||(e.eventRoot=cu.select(n)[0]),e.eventRoot):e.getBody()},g4=e=>!e.hidden&&!br(e),Jx=(e,t,n)=>{g4(e)?e.dispatch(t,n):br(e)&&d4(e,n)},ek=(e,t)=>{if(e.delegates||(e.delegates={}),e.delegates[t]||e.removed)return;const n=uu(e,t);if(pv(e)){if(vr||(vr={},e.editorManager.on("removeEditor",()=>{e.editorManager.activeEditor||vr&&(Je(vr,(o,r)=>{e.dom.unbind(uu(e,r))}),vr=null)})),vr[t])return;const s=o=>{const r=o.target,a=e.editorManager.get();let i=a.length;for(;i--;){const l=a[i].getBody();(l===r||cu.isChildOf(r,l))&&Jx(a[i],t,o)}};vr[t]=s,cu.bind(n,t,s)}else{const s=o=>{Jx(e,t,o)};cu.bind(n,t,s),e.delegates[t]=s}},tk={...Xp,bindPendingEventDelegates(){const e=this;V.each(e._pendingNativeEvents,t=>{ek(e,t)})},toggleNativeEvent(e,t){const n=this;e==="focus"||e==="blur"||n.removed||(t?n.initialized?ek(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&n.delegates&&(n.dom.unbind(uu(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents(){const e=this,t=e.getBody(),n=e.dom;e.delegates&&(Je(e.delegates,(s,o)=>{e.dom.unbind(uu(e,o),o,s)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}},h4=e=>ce(e)?{value:e.split(/[ ,]/),valid:!0}:En(e,ce)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},b4=e=>{const t=(()=>{switch(e){case"array":return Ge;case"boolean":return Dn;case"function":return Be;case"number":return Tt;case"object":return Qe;case"string":return ce;case"string[]":return h4;case"object[]":return n=>En(n,Qe);case"regexp":return n=>Bt(n,RegExp);default:return St}})();return n=>Zp(n,t,`The value must be a ${e}.`)},v4=e=>ce(e.processor),nk=(e,t)=>{const n=Da(t.message)?"":`. ${t.message}`;return e+n},sk=e=>e.valid,Zp=(e,t,n="")=>{const s=t(e);return Dn(s)?s?{value:e,valid:!0}:{valid:!1,message:n}:s},y4=(e,t,n)=>{if(!Ye(t)){const s=Zp(t,n);if(sk(s))return s.value;console.error(nk(`Invalid default value passed for the "${e}" option`,s))}},C4=(e,t)=>{const n={},s={},o=(u,d,v)=>{const E=Zp(d,v);return sk(E)?(s[u]=E.value,!0):(console.warn(nk(`Invalid value passed for the ${u} option`,E)),!1)},r=(u,d)=>{const v=v4(d)?b4(d.processor):d.processor,E=y4(u,d.default,v);n[u]={...d,default:E,processor:v},st(s,u).orThunk(()=>st(t,u)).each(C=>o(u,C,v))},a=u=>Se(n,u);return{register:r,isRegistered:a,get:u=>st(s,u).orThunk(()=>st(n,u).map(d=>d.default)).getOrUndefined(),set:(u,d)=>{if(a(u)){const v=n[u];return v.immutable?(console.error(`"${u}" is an immutable option and cannot be updated`),!1):o(u,d,v.processor)}else return console.warn(`"${u}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:u=>{const d=a(u);return d&&delete s[u],d},isSet:u=>Se(s,u)}},E4=["design","readonly"],ok=(e,t,n,s)=>{const o=n[t.get()],r=n[s];try{r.activate()}catch(a){console.error(`problem while activating editor mode ${s}:`,a);return}o.deactivate(),o.editorReadOnly!==r.editorReadOnly&&a4(e,r.editorReadOnly),t.set(s),HP(e,s)},S4=(e,t,n,s)=>{if(s!==n.get()){if(!Se(t,s))throw new Error(`Editor mode '${s}' is invalid`);e.initialized?ok(e,n,t,s):e.on("init",()=>ok(e,n,t,s))}},w4=(e,t,n)=>{if(Ve(E4,t))throw new Error(`Cannot override default mode ${t}`);return{...e,[t]:{...n,deactivate:()=>{try{n.deactivate()}catch(s){console.error(`problem while deactivating editor mode ${t}:`,s)}}}}},_4=e=>{const t=Rt("design"),n=Rt({design:{activate:Ee,deactivate:Ee,editorReadOnly:!1},readonly:{activate:Ee,deactivate:Ee,editorReadOnly:!0}});return i4(e),m4(e),{isReadOnly:()=>br(e),set:s=>S4(e,n.get(),t,s),get:()=>t.get(),register:(s,o)=>{n.set(w4(n.get(),s,o))}}},Qp=V.each,Jp=V.explode,x4={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},rk=V.makeMap("alt,ctrl,shift,meta,access"),k4=e=>e in rk,N4=e=>{const t={},n=Fe.os.isMacOS()||Fe.os.isiOS();Qp(Jp(e.toLowerCase(),"+"),r=>{k4(r)?t[r]=!0:/^[0-9]{2,}$/.test(r)?t.keyCode=parseInt(r,10):(t.charCode=r.charCodeAt(0),t.keyCode=x4[r]||r.toUpperCase().charCodeAt(0))});const s=[t.keyCode];let o;for(o in rk)t[o]?s.push(o):t[o]=!1;return t.id=s.join(","),t.access&&(t.alt=!0,n?t.ctrl=!0:t.shift=!0),t.meta&&(n?t.meta=!0:(t.ctrl=!0,t.meta=!1)),t};class ak{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;const n=this;t.on("keyup keypress keydown",s=>{(n.hasModifier(s)||n.isFunctionKey(s))&&!s.isDefaultPrevented()&&(Qp(n.shortcuts,o=>{n.matchShortcut(s,o)&&(n.pendingPatterns=o.subpatterns.slice(0),s.type==="keydown"&&n.executeShortcutAction(o))}),n.matchShortcut(s,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&s.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(t,n,s,o){const r=this,a=r.normalizeCommandFunc(s);return Qp(Jp(V.trim(t)),i=>{const l=r.createShortcut(i,n,a,o);r.shortcuts[l.id]=l}),!0}remove(t){const n=this.createShortcut(t);return this.shortcuts[n.id]?(delete this.shortcuts[n.id],!0):!1}normalizeCommandFunc(t){const n=this,s=t;return typeof s=="string"?()=>{n.editor.execCommand(s,!1,null)}:V.isArray(s)?()=>{n.editor.execCommand(s[0],s[1],s[2])}:s}createShortcut(t,n,s,o){const r=V.map(Jp(t,">"),N4);return r[r.length-1]=V.extend(r[r.length-1],{func:s,scope:o||this.editor}),V.extend(r[0],{desc:this.editor.translate(n),subpatterns:r.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return t.type==="keydown"&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,n){return!n||n.ctrl!==t.ctrlKey||n.meta!==t.metaKey||n.alt!==t.altKey||n.shift!==t.shiftKey?!1:t.keyCode===n.keyCode||t.charCode&&t.charCode===n.charCode?(t.preventDefault(),!0):!1}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}const A4=()=>{const e={},t={},n={},s={},o={},r={},a={},i={},l=(f,u)=>(d,v)=>{f[d.toLowerCase()]={...v,type:u}},c=(f,u)=>s[f.toLowerCase()]=u;return{addButton:l(e,"button"),addGroupToolbarButton:l(e,"grouptoolbarbutton"),addToggleButton:l(e,"togglebutton"),addMenuButton:l(e,"menubutton"),addSplitButton:l(e,"splitbutton"),addMenuItem:l(t,"menuitem"),addNestedMenuItem:l(t,"nestedmenuitem"),addToggleMenuItem:l(t,"togglemenuitem"),addAutocompleter:l(n,"autocompleter"),addContextMenu:l(o,"contextmenu"),addContextToolbar:l(r,"contexttoolbar"),addContextForm:l(r,"contextform"),addSidebar:l(a,"sidebar"),addView:l(i,"views"),addIcon:c,getAll:()=>({buttons:e,menuItems:t,icons:s,popups:n,contextMenus:o,contextToolbars:r,sidebars:a,views:i})}},T4=()=>{const e=A4();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,addView:e.addView,getAll:e.getAll}},yr=qe.DOM,ik=V.extend,D4=V.each;class fu{constructor(t,n,s){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=s,this.documentBaseUrl=s.documentBaseURL,ik(this,tk);const o=this;this.id=t,this.hidden=!1;const r=p9(s.defaultOptions,n);this.options=C4(o,r),ZD(o);const a=this.options.get;a("deprecation_warnings")&&Nz(n,r);const i=a("suffix");i&&(s.suffix=i),this.suffix=s.suffix;const l=a("base_url");l&&s._setBaseUrl(l),this.baseUri=s.baseURI;const c=Hf(o);c&&(Ys.ScriptLoader._setReferrerPolicy(c),qe.DOM.styleSheetLoader._setReferrerPolicy(c));const f=hv(o);G(f)&&qe.DOM.styleSheetLoader._setContentCssCors(f),Zt.languageLoad=a("language_load"),Zt.baseURL=s.baseURL,this.setDirty(!1),this.documentBaseURI=new us(rv(o),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=Vf(o),this.hasVisual=UR(o),this.shortcuts=new ak(this),this.editorCommands=new Zx(this),J9(this);const u=a("cache_suffix");u&&(Fe.cacheSuffix=u.replace(/^[\?\&]+/,"")),this.ui={registry:T4(),styleSheetLoader:void 0,show:Ee,hide:Ee,setEnabled:Ee,isEnabled:St},this.mode=_4(o),s.dispatch("SetupEditor",{editor:this});const d=WR(o);Be(d)&&d.call(o,o)}render(){J5(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return ir(this)}translate(t){return as.translate(t)}getParam(t,n,s){const o=this.options;return o.isRegistered(t)||(G(s)?o.register(t,{processor:s,default:n}):o.register(t,{processor:St,default:n})),!o.isSet(t)&&!Ye(n)?n:o.get(t)}hasPlugin(t,n){return Ve($l(this),t)?n?oa.get(t)!==void 0:!0:!1}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,n,s){this.editorCommands.addCommand(t,n,s)}addQueryStateHandler(t,n,s){this.editorCommands.addQueryStateHandler(t,n,s)}addQueryValueHandler(t,n,s){this.editorCommands.addQueryValueHandler(t,n,s)}addShortcut(t,n,s,o){this.shortcuts.add(t,n,s,o)}execCommand(t,n,s,o){return this.editorCommands.execCommand(t,n,s,o)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){const t=this;t.hidden&&(t.hidden=!1,t.inline?t.getBody().contentEditable="true":(yr.show(t.getContainer()),yr.hide(t.id)),t.load(),t.dispatch("show"))}hide(){const t=this;t.hidden||(t.save(),t.inline?(t.getBody().contentEditable="false",t===t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):(yr.hide(t.getContainer()),yr.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,n){this.dispatch("ProgressState",{state:t,time:n})}load(t={}){const n=this,s=n.getElement();if(n.removed)return"";if(s){const o={...t,load:!0},r=af(s)?s.value:s.innerHTML,a=n.setContent(r,o);return o.no_events||n.dispatch("LoadContent",{...o,element:s}),a}else return""}save(t={}){const n=this;let s=n.getElement();if(!s||!n.initialized||n.removed)return"";const o={...t,save:!0,element:s};let r=n.getContent(o);const a={...o,content:r};if(a.no_events||n.dispatch("SaveContent",a),a.format==="raw"&&n.dispatch("RawSaveContent",a),r=a.content,af(s))s.value=r;else{(t.is_removing||!n.inline)&&(s.innerHTML=r);const i=yr.getParent(n.id,"form");i&&D4(i.elements,l=>l.name===n.id?(l.value=r,!1):!0)}return a.element=o.element=s=null,a.set_dirty!==!1&&n.setDirty(!1),r}setContent(t,n){return Lm(this,t,n)}getContent(t){return pz(this,t)}insertContent(t,n){n&&(t=ik({content:t},n)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){t===void 0?Lm(this,this.startContent,{format:"raw"}):Lm(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){const n=!this.isNotDirty;this.isNotDirty=!t,t&&t!==n&&this.dispatch("dirty")}getContainer(){const t=this;return t.container||(t.container=t.editorContainer||yr.get(t.id+"_parent")),t.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=yr.get(this.id)),this.targetElm}getWin(){const t=this;if(!t.contentWindow){const n=t.iframeElement;n&&(t.contentWindow=n.contentWindow)}return t.contentWindow}getDoc(){const t=this;if(!t.contentDocument){const n=t.getWin();n&&(t.contentDocument=n.document)}return t.contentDocument}getBody(){var t,n;const s=this.getDoc();return(n=(t=this.bodyElement)!==null&&t!==void 0?t:s==null?void 0:s.body)!==null&&n!==void 0?n:null}convertURL(t,n,s){const o=this,r=o.options.get,a=qR(o);return Be(a)?a.call(o,t,s,!0,n):!r("convert_urls")||s==="link"||Qe(s)&&s.nodeName==="LINK"||t.indexOf("file:")===0||t.length===0?t:r("relative_urls")?o.documentBaseURI.toRelative(t):(t=o.documentBaseURI.toAbsolute(t,r("remove_script_host")),t)}addVisual(t){g9(this,t)}setEditableRoot(t){e9(this,t)}hasEditableRoot(){return t9(this)}remove(){Rz(this)}destroy(t){Pz(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const da=qe.DOM,du=V.each;let lk=!1,mu,dn=[];const pu=e=>{const t=e.type;du(No.get(),n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e);break}})},ck=e=>{if(e!==lk){const t=qe.DOM;e?(t.bind(window,"resize",pu),t.bind(window,"scroll",pu)):(t.unbind(window,"resize",pu),t.unbind(window,"scroll",pu)),lk=e}},uk=e=>{const t=dn;return dn=ve(dn,n=>e!==n),No.activeEditor===e&&(No.activeEditor=dn.length>0?dn[0]:null),No.focusedEditor===e&&(No.focusedEditor=null),t.length!==dn.length},R4=e=>{e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(uk(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)},P4=document.compatMode!=="CSS1Compat",No={...Xp,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"6",minorVersion:"6.0",releaseDate:"2023-07-12",i18n:as,activeEditor:null,focusedEditor:null,setup(){const e=this;let t="",n="",s=us.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/"));const o=window.tinymce||window.tinyMCEPreInit;if(o)t=o.base||o.baseURL,n=o.suffix;else{const r=document.getElementsByTagName("script");for(let a=0;a<r.length;a++){const i=r[a].src||"";if(i==="")continue;const l=i.substring(i.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(i)){l.indexOf(".min")!==-1&&(n=".min"),t=i.substring(0,i.lastIndexOf("/"));break}}if(!t&&document.currentScript){const a=document.currentScript.src;a.indexOf(".min")!==-1&&(n=".min"),t=a.substring(0,a.lastIndexOf("/"))}}e.baseURL=new us(s).toAbsolute(t),e.documentBaseURL=s,e.baseURI=new us(e.baseURL),e.suffix=n,bB(e)},overrideDefaults(e){const t=e.base_url;t&&this._setBaseUrl(t);const n=e.suffix;n&&(this.suffix=n),this.defaultOptions=e;const s=e.plugin_base_urls;s!==void 0&&Je(s,(o,r)=>{Zt.PluginManager.urls[r]=o})},init(e){const t=this;let n;const s=V.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=(f,u)=>f.inline&&u.tagName.toLowerCase()in s,r=f=>{let u=f.id;return u||(u=st(f,"name").filter(d=>!da.get(d)).getOrThunk(da.uniqueId),f.setAttribute("id",u)),u},a=f=>{const u=e[f];if(u)return u.apply(t,[])},i=f=>Fe.browser.isIE()||Fe.browser.isEdge()?(kc("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/6/support/#supportedwebbrowsers"),[]):P4?(kc("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):ce(f.selector)?da.select(f.selector):G(f.target)?[f.target]:[];let l=f=>{n=f};const c=()=>{let f=0;const u=[];let d;const v=(E,h,C)=>{const w=new fu(E,h,t);u.push(w),w.on("init",()=>{++f===d.length&&l(u)}),w.targetElm=w.targetElm||C,w.render()};da.unbind(window,"ready",c),a("onpageload"),d=jk(i(e)),V.each(d,E=>{R4(t.get(E.id))}),d=V.grep(d,E=>!t.get(E.id)),d.length===0?l([]):du(d,E=>{o(e,E)?kc("Could not initialize inline editor on invalid inline target element",E):v(r(E),e,E)})};return da.bind(window,"ready",c),new Promise(f=>{n?f(n):l=u=>{f(u)}})},get(e){return arguments.length===0?dn.slice(0):ce(e)?_t(dn,t=>t.id===e).getOr(null):Tt(e)&&dn[e]?dn[e]:null},add(e){const t=this,n=t.get(e.id);return n===e||(n===null&&dn.push(e),ck(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),mu||(mu=s=>{const o=t.dispatch("BeforeUnload");if(o.returnValue)return s.preventDefault(),s.returnValue=o.returnValue,o.returnValue},window.addEventListener("beforeunload",mu))),e},createEditor(e,t){return this.add(new fu(e,t,this))},remove(e){const t=this;let n;if(!e){for(let s=dn.length-1;s>=0;s--)t.remove(dn[s]);return}if(ce(e)){du(da.select(e),s=>{n=t.get(s.id),n&&t.remove(n)});return}return n=e,Et(t.get(n.id))?null:(uk(n)&&t.dispatch("RemoveEditor",{editor:n}),dn.length===0&&window.removeEventListener("beforeunload",mu),n.remove(),ck(dn.length>0),n)},execCommand(e,t,n){var s;const o=this,r=Qe(n)?(s=n.id)!==null&&s!==void 0?s:n.index:n;switch(e){case"mceAddEditor":{if(!o.get(r)){const a=n.options;new fu(r,a,o).render()}return!0}case"mceRemoveEditor":{const a=o.get(r);return a&&a.remove(),!0}case"mceToggleEditor":{const a=o.get(r);return a?(a.isHidden()?a.show():a.hide(),!0):(o.execCommand("mceAddEditor",!1,n),!0)}}return o.activeEditor?o.activeEditor.execCommand(e,t,n):!1},triggerSave:()=>{du(dn,e=>{e.save()})},addI18n:(e,t)=>{as.add(e,t)},translate:e=>as.translate(e),setActive(e){const t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new us(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new us(this.baseURL)}};No.setup();const O4=(()=>{const e=go(),t=r=>({items:r,types:wn(r),getType:a=>st(r,a).getOrUndefined()}),n=r=>{e.set(r)},s=()=>e.get().getOrUndefined(),o=e.clear;return{FakeClipboardItem:t,write:n,read:s,clear:o}})(),fk=Math.min,ma=Math.max,gu=Math.round,dk=(e,t,n)=>{let s=t.x,o=t.y;const r=e.w,a=e.h,i=t.w,l=t.h,c=(n||"").split("");return c[0]==="b"&&(o+=l),c[1]==="r"&&(s+=i),c[0]==="c"&&(o+=gu(l/2)),c[1]==="c"&&(s+=gu(i/2)),c[3]==="b"&&(o-=a),c[4]==="r"&&(s-=r),c[3]==="c"&&(o-=gu(a/2)),c[4]==="c"&&(s-=gu(r/2)),pa(s,o,r,a)},B4=(e,t,n,s)=>{for(let o=0;o<s.length;o++){const r=dk(e,t,s[o]);if(r.x>=n.x&&r.x+r.w<=n.w+n.x&&r.y>=n.y&&r.y+r.h<=n.h+n.y)return s[o]}return null},I4=(e,t,n)=>pa(e.x-t,e.y-n,e.w+t*2,e.h+n*2),F4=(e,t)=>{const n=ma(e.x,t.x),s=ma(e.y,t.y),o=fk(e.x+e.w,t.x+t.w),r=fk(e.y+e.h,t.y+t.h);return o-n<0||r-s<0?null:pa(n,s,o-n,r-s)},L4=(e,t,n)=>{let s=e.x,o=e.y,r=e.x+e.w,a=e.y+e.h;const i=t.x+t.w,l=t.y+t.h,c=ma(0,t.x-s),f=ma(0,t.y-o),u=ma(0,r-i),d=ma(0,a-l);return s+=c,o+=f,n&&(r+=c,a+=f,s-=u,o-=d),r-=u,a-=d,pa(s,o,r-s,a-o)},pa=(e,t,n,s)=>({x:e,y:t,w:n,h:s}),$4={inflate:I4,relativePosition:dk,findBestRelativePosition:B4,intersect:F4,clamp:L4,create:pa,fromClientRect:e=>pa(e.left,e.top,e.width,e.height)},M4=(e,t,n=1e3)=>{let s=!1,o=null;const r=c=>(...f)=>{s||(s=!0,o!==null&&(clearTimeout(o),o=null),c.apply(null,f))},a=r(e),i=r(t);return{start:(...c)=>{!s&&o===null&&(o=setTimeout(()=>i.apply(null,c),n))},resolve:a,reject:i}},U4=(()=>{const e={},t={};return{load:(r,a)=>{const i=`Script at URL "${a}" failed to load`,l=`Script at URL "${a}" did not call \`tinymce.Resource.add('${r}', data)\` within 1 second`;if(e[r]!==void 0)return e[r];{const c=new Promise((f,u)=>{const d=M4(f,u);t[r]=d.resolve,Ys.ScriptLoader.loadScript(a).then(()=>d.start(l),()=>d.reject(i))});return e[r]=c,c}},add:(r,a)=>{t[r]!==void 0&&(t[r](a),delete t[r]),e[r]=Promise.resolve(a)},unload:r=>{delete e[r]}}})(),z4=()=>(()=>{let e={},t=[];const n={getItem:s=>{const o=e[s];return o||null},setItem:(s,o)=>{t.push(s),e[s]=String(o)},key:s=>t[s],removeItem:s=>{t=t.filter(o=>o===s),delete e[s]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),n})();let Wi;try{const e="__storage_test__";Wi=window.localStorage,Wi.setItem(e,e),Wi.removeItem(e)}catch{Wi=z4()}var H4=Wi;const W4={geom:{Rect:$4},util:{Delay:$n,Tools:V,VK:te,URI:us,EventDispatcher:Yp,Observable:Xp,I18n:as,LocalStorage:H4,ImageUploader:cH},dom:{EventUtils:Go,TreeWalker:xt,TextSeeker:Zo,DOMUtils:qe,ScriptLoader:Ys,RangeUtils:ar,Serializer:FS,StyleSheetLoader:sb,ControlSelection:Sy,BookmarkManager:pi,Selection:IS,Event:Go.Event},html:{Styles:xf,Entities:mo,Node:fn,Schema:po,DomParser:na,Writer:aC,Serializer:Co},Env:Fe,AddOnManager:Zt,Annotator:my,Formatter:ZS,UndoManager:JS,EditorCommands:Zx,WindowManager:WS,NotificationManager:HS,EditorObservable:tk,Shortcuts:ak,Editor:fu,FocusManager:qy,EditorManager:No,DOM:qe.DOM,ScriptLoader:Ys.ScriptLoader,PluginManager:oa,ThemeManager:pr,ModelManager:sa,IconManager:_c,Resource:U4,FakeClipboard:O4,trim:V.trim,isArray:V.isArray,is:V.is,toArray:V.toArray,makeMap:V.makeMap,each:V.each,map:V.map,grep:V.grep,inArray:V.inArray,extend:V.extend,walk:V.walk,resolve:V.resolve,explode:V.explode,_addCacheSuffix:V._addCacheSuffix},mk=V.extend(No,W4),V4=e=>{try{g.exports=e}catch{}};(e=>{window.tinymce=e,window.tinyMCE=e})(mk),V4(mk)})()})(Uk);var E7=Uk.exports;const dg=C7(E7);function nl(){[...document.getElementById("influactive_form_fields_container").getElementsByClassName("influactive_form_field")].forEach((b,y)=>{const k=["type","label","name","order","required"],B=[...b.getElementsByClassName("option-field")];k.forEach(L=>{const j=b.querySelector(`.${L}`);j&&(L!=="required"||j.value==="1")&&(j.name=`influactive_form_fields[${y}][${L}]`)}),B.length>0&&B.forEach((L,j)=>{["label","value"].forEach(Z=>{const ue=L.querySelector(`.${Z}`);ue&&(ue.name=`influactive_form_fields[${y}][options][${j}][${Z}]`)})})})}function kk(g,p,b,y,k){const B=document.createElement("label");B.textContent=p;const L=document.createElement("input");L.type=y,L.name=b,L.required=!0,L.className=k,B.appendChild(L),g.appendChild(B)}function S7(){const g=document.createElement("div"),p=document.getElementsByClassName("influactive_form_field").length;g.className="influactive_form_field";const b=document.createElement("p"),y=document.createElement("label");y.textContent="Type ";const k=document.createElement("select");k.required=!0,k.className="field_type",k.name=`influactive_form_fields[${p}][type]`,[["text",influactiveFormsTranslations.Text],["email",influactiveFormsTranslations.Email],["number",influactiveFormsTranslations.Number],["textarea",influactiveFormsTranslations.Textarea],["select",influactiveFormsTranslations.Select],["gdpr",influactiveFormsTranslations.GDPR],["free_text",influactiveFormsTranslations.Freetext]].forEach(([ie,Ce])=>{const Oe=document.createElement("option");Oe.value=ie,Oe.textContent=Ce,k.appendChild(Oe)}),y.appendChild(k),b.appendChild(y),kk(b,"Label ",`influactive_form_fields[${p}][label]`,"text","influactive_form_fields_label"),kk(b,"Name ",`influactive_form_fields[${p}][name]`,"text","influactive_form_fields_name");const L=document.createElement("div");L.className="options_container",b.appendChild(L);const j=document.createElement("label");j.textContent="Required ";const X=document.createElement("input");X.type="checkbox",X.name=`influactive_form_fields[${p}][required]`,X.value="1",X.className="influactive_form_fields_required",j.appendChild(X),b.appendChild(j);const Z=document.createElement("input");Z.type="hidden",Z.name=`influactive_form_fields[${p}][order]`,Z.className="influactive_form_fields_order",Z.value=p,b.appendChild(Z);const ue=document.createElement("a");return ue.href="#",ue.className="remove_field",ue.textContent=influactiveFormsTranslations.removeFieldText,b.appendChild(ue),g.appendChild(b),g}function w7(){const g=document.createElement("p");g.className="option-field";const p=document.createElement("label");p.textContent=`${influactiveFormsTranslations.optionLabelLabelText} `;const b=document.createElement("input");b.type="text",b.className="option-label",b.name="influactive_form_fields[][options][][label]",p.appendChild(b),g.appendChild(p),g.appendChild(document.createTextNode(" "));const y=document.createElement("label");y.textContent=`${influactiveFormsTranslations.optionValueLabelText} `;const k=document.createElement("input");k.type="text",k.className="option-value",k.name="influactive_form_fields[][options][][value]",y.appendChild(k),g.appendChild(y),g.appendChild(document.createTextNode(" "));const B=document.createElement("a");return B.href="#",B.className="remove_option",B.textContent=influactiveFormsTranslations.removeOptionText,g.appendChild(B),g}function zk(g){g.preventDefault(),g.target.closest(".option-field").remove(),nl()}function Cg(g){g.preventDefault();const p=g.target.parentElement.previousElementSibling,b=w7(),y=b.querySelector(".remove_option");y&&y.addEventListener("click",zk),p.appendChild(b);const k=b.closest(".influactive_form_field").querySelector(".influactive_form_fields_order").value;let B=0;document.getElementsByClassName("option-field").length>0&&(B=document.getElementsByClassName("option-field").length),b.querySelector(".option-label").name=`influactive_form_fields[${k}][options][${B}][label]`,b.querySelector(".option-value").name=`influactive_form_fields[${k}][options][${B}][value]`,nl()}function Hk(g){return function(b){nl();const y=b.target.value,k=g.querySelector(".influactive_form_fields_label"),B=g.querySelector(".influactive_form_fields_name"),L=g.querySelector(".influactive_form_fields_required"),j=g.querySelector(".wysiwyg-editor");if(k&&B&&(j&&dg.get(j.id)&&dg.get(j.id).remove(),k.parentElement.remove(),B.parentElement.remove(),L&&L.parentElement.remove(),j&&j.remove()),y==="gdpr"){const ue=document.createElement("label"),ie=document.createTextNode(`${influactiveFormsTranslations.Text} `);ue.appendChild(ie);const Ce=document.createElement("input");Ce.type="text",Ce.name=`influactive_form_fields[${g.querySelector(".influactive_form_fields_order").value}][label]`,Ce.className="influactive_form_fields_label",Ce.dataset.type="gdpr",Ce.required=!0,ue.appendChild(Ce);const Oe=document.createElement("label"),Pe=document.createElement("input");Pe.type="hidden",Pe.name=`influactive_form_fields[${g.querySelector(".influactive_form_fields_order").value}][name]`,Pe.className="influactive_form_fields_name",Pe.value="gdpr",Oe.appendChild(Pe),g.appendChild(ue),g.appendChild(Oe)}if(y==="free_text"){const ue=document.createElement("textarea");ue.name=`influactive_form_fields[${g.querySelector(".influactive_form_fields_order").value}][label]`,ue.className="influactive_form_fields_label wysiwyg-editor",ue.rows=10,g.appendChild(ue),setTimeout(()=>{dg.init({selector:".wysiwyg-editor",height:215,menubar:!1,plugins:["lists link image charmap","fullscreen","paste"],toolbar:"bold italic underline link unlink undo redo formatselect backcolor alignleft aligncenter alignright alignjustify bullist numlist outdent indent removeformat",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"})},0);const ie=document.createElement("label"),Ce=document.createElement("input");Ce.type="hidden",Ce.name=`influactive_form_fields[${g.querySelector(".influactive_form_fields_order").value}][name]`,Ce.className="influactive_form_fields_name",Ce.value="free_text",ie.appendChild(Ce),g.appendChild(ie)}const X=g.querySelector(".influactive_form_fields_label"),Z=g.querySelector(".influactive_form_fields_name");if(!X&&!Z){const ue=document.createElement("label");ue.textContent="Label ";const ie=document.createElement("input");ie.type="text",ie.name=`influactive_form_fields[${g.querySelector(".influactive_form_fields_order").value}][label]`,ie.className="influactive_form_fields_label",ie.required=!0,ue.appendChild(ie);const Ce=document.createElement("label");Ce.textContent="Name ";const Oe=document.createElement("input");Oe.type="text",Oe.name=`influactive_form_fields[${g.querySelector(".influactive_form_fields_order").value}][name]`,Oe.className="influactive_form_fields_name",Oe.required=!0,Ce.appendChild(Oe);const Pe=document.createElement("label");Pe.textContent="Required ";const $e=document.createElement("input");$e.type="checkbox",$e.value="1",$e.name=`influactive_form_fields[${g.querySelector(".influactive_form_fields_order").value}][required]`,$e.className="influactive_form_fields_required",$e.required=!0,Pe.appendChild($e),g.appendChild(ue),g.appendChild(Ce),g.appendChild(Pe)}if(y==="select"){const ue=document.createElement("p"),ie=document.createElement("a");ie.href="#",ie.textContent="Add option",ie.classList.add("add_option"),ue.appendChild(ie),g.appendChild(ue);const Ce=document.createElement("div");Ce.classList.add("options_container"),g.appendChild(Ce),ie.addEventListener("click",Cg)}else{const ue=g.querySelector(".add_option"),ie=g.querySelector(".options_container");ue&&ue.remove(),ie&&ie.remove()}}}function _7(g){g.preventDefault();const p=S7();document.getElementById("influactive_form_fields_container").appendChild(p),p.querySelector(".field_type").addEventListener("change",Hk(p));const k=p.querySelector(".add_option");k&&k.addEventListener("click",Cg),nl()}function x7(g){g.preventDefault(),g.target.closest(".influactive_form_field").remove(),nl()}document.addEventListener("DOMContentLoaded",()=>{const g=document.getElementById("influactive_form_fields_container");new De(g,{animation:150,handle:".influactive_form_field"}),document.getElementById("add_field").addEventListener("click",_7),Array.from(g.getElementsByClassName("influactive_form_field")).forEach(p=>{const b=p.querySelector(".field_type");if(b.addEventListener("change",Hk(p)),b.value==="select"){const y=p.querySelector(".add_option"),k=p.querySelector(".remove_option");y&&y.addEventListener("click",Cg),k&&k.addEventListener("click",zk)}}),g.addEventListener("click",p=>{p.target&&p.target.classList.contains("remove_field")&&x7(p)})});
